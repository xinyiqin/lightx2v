<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LightX2V æ–‡ç”Ÿè§†é¢‘æœåŠ¡</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- ä¸»è¦å›¾æ ‡åº“ -->
    <link href="https://cdn.bootcdn.net/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <!-- å¤‡ç”¨å›¾æ ‡åº“ -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" media="print" onload="this.media='all'">
    <!-- æœ¬åœ°å¤‡ç”¨å›¾æ ‡ï¼ˆå¦‚æœCDNéƒ½å¤±è´¥ï¼‰ -->
    <style>
        /* å¤‡ç”¨å›¾æ ‡æ ·å¼ï¼Œé˜²æ­¢CDNå¤±è´¥æ—¶å›¾æ ‡ä¸æ˜¾ç¤º */
        .icon-fallback {
            display: inline-block;
            width: 1em;
            height: 1em;
            background-color: currentColor;
            border-radius: 50%;
        }
        .icon-fallback.small {
            width: 0.75em;
            height: 0.75em;
        }
        .icon-fallback.large {
            width: 1.5em;
            height: 1.5em;
        }
        .icon-fallback.xl {
            width: 2em;
            height: 2em;
        }

        /* ç™»å½•é¡µé¢æ ·å¼ */
        .login-container {
            min-height: 100%;
            min-width: 100%;
            background: linear-gradient(135deg, #0b0a20 0%, #1b1240 50%, #0f0e22 100%);
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .login-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background:
                radial-gradient(circle at 20% 80%, rgba(154, 114, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(183, 139, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(124, 106, 255, 0.05) 0%, transparent 50%);
            animation: backgroundShift 20s ease-in-out infinite;
        }

        /* ç™»å½•é¡µé¢æ ·å¼ */
        .main-container {
            min-height: 100%;
            min-width: 100%;
            background: linear-gradient(135deg, #0b0a20 0%, #1b1240 50%, #0f0e22 100%);
            overflow: hidden;
            display: flex;
        }

        @keyframes backgroundShift {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }

        .login-card {
            background: rgba(27, 18, 64, 0.8);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(154, 114, 255, 0.2);
            border-radius: 24px;
            box-shadow:
                0 20px 40px rgba(0, 0, 0, 0.3),
                0 0 40px rgba(154, 114, 255, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
            max-width: 500px;
            width: 100%;
        }

        .login-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(154, 114, 255, 0.1), transparent);
            transition: left 0.5s ease;
        }

        .login-card:hover::before {
            left: 100%;
        }

        .login-card:hover {
            transform: translateY(-5px);
            box-shadow:
                0 25px 50px rgba(0, 0, 0, 0.4),
                0 0 60px rgba(154, 114, 255, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.15);
        }

        .login-logo {
            background: linear-gradient(135deg, #9a72ff, #b78bff, #7c6aff);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 1rem;
            animation: logoGlow 3s ease-in-out infinite alternate;
        }

        @keyframes logoGlow {
            0% {
                filter: drop-shadow(0 0 10px rgba(154, 114, 255, 0.5));
            }
            100% {
                filter: drop-shadow(0 0 20px rgba(154, 114, 255, 0.8));
            }
        }

        .login-subtitle {
            color: rgba(255, 255, 255, 0.7);
            font-size: 1.1rem;
            margin-bottom: 2rem;
            font-weight: 300;
        }

        .btn-github {
            background: linear-gradient(135deg, #d2c1ff, #a88bff, #8e88ff);
            border: 1px solid rgba(154, 114, 255, 0.3);
            font-weight: 500;
            font-size: 16px;
            letter-spacing: 0.2px;
            font-family: 'Inter', sans-serif;
            padding: 20px 30px;
            border-radius: 14px;
            position: relative;
            overflow: hidden;
            text-decoration: none;
            box-shadow: 0 10px 30px rgba(140, 110, 255, 0.4);
            transition: transform 0.5s ease, box-shadow 0.15s ease;
        }

        .btn-github::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s ease;
        }

        .btn-github:hover::before {
            left: 100%;
        }

        .btn-github:hover {
            background: linear-gradient(135deg, #c1a5ff, #8b5cf6);
            border-color: rgba(168, 85, 247, 0.5);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(168, 85, 247, 0.3);
        }

        .btn-github:active {
            transform: translateY(0);
            background: linear-gradient(135deg, #c1a5ff, #8b5cf6);
            box-shadow: 0 2px 8px rgba(124, 58, 237, 0.4);
        }

        .btn-github:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .btn-github:disabled:hover {
            transform: none;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .floating-particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            pointer-events: none;
        }

        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: rgba(193, 169, 255, 0.6);
            border-radius: 50%;
            animation: floatParticle 15s linear infinite;
        }

        .particle:nth-child(1) { left: 10%; animation-delay: 0s; }
        .particle:nth-child(2) { left: 20%; animation-delay: 12s; }
        .particle:nth-child(3) { left: 30%; animation-delay: 10s; }
        .particle:nth-child(4) { left: 40%; animation-delay: 6s; }
        .particle:nth-child(5) { left: 50%; animation-delay: 8s; }
        .particle:nth-child(6) { left: 60%; animation-delay: 14s; }
        .particle:nth-child(7) { left: 70%; animation-delay: 16s; }
        .particle:nth-child(8) { left: 80%; animation-delay: 2s; }
        .particle:nth-child(9) { left: 90%; animation-delay: 4s; }

        @keyframes floatParticle {
            0% {
                transform: translateY(100vh) scale(0);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100px) scale(1);
                opacity: 0;
            }
        }

        .login-features {
            margin-top: 2rem;
            padding-top: 2rem;
            padding-left: 10rem;
            border-top: 1px solid rgba(154, 114, 255, 0.2);
        }

        .feature-item {
            display: flex;
            align-items: center;
            margin-bottom: 1rem;
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9rem;
        }

        .feature-icon {
            width: 20px;
            height: 20px;
            background: linear-gradient(135deg, #9a72ff, #b78bff);
            border-radius: 50%;
            margin-right: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            color: white;
        }

        /* ç™»å½•é¡µé¢è¿›å…¥åŠ¨ç”» */
        .login-container {
            animation: fadeInUp 0.8s ease-out;
        }

        .login-card {
            animation: slideInUp 0.6s ease-out 0.2s both;
        }

        .login-logo {
            animation: logoGlow 3s ease-in-out infinite alternate, fadeInScale 0.8s ease-out 0.4s both;
        }

        .login-subtitle {
            animation: fadeIn 0.8s ease-out 0.6s both;
        }

        .btn-github {
            animation: fadeInUp 0.8s ease-out 0.8s both;
        }

        .login-features {
            animation: fadeIn 0.8s ease-out 1s both;
        }

        .feature-item {
            animation: slideInLeft 0.6s ease-out both;
        }

        .feature-item:nth-child(1) { animation-delay: 1.2s; }
        .feature-item:nth-child(2) { animation-delay: 1.4s; }
        .feature-item:nth-child(3) { animation-delay: 1.6s; }
        .feature-item:nth-child(4) { animation-delay: 1.8s; }
        .feature-item:nth-child(5) { animation-delay: 2.0s; }
        .feature-item:nth-child(6) { animation-delay: 2.2s; }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInScale {
            from {
                opacity: 0;
                transform: scale(0.8);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .login-logo {
                font-size: 2.5rem;
            }

            .login-subtitle {
                font-size: 1rem;
            }

            .btn-github {
                padding: 14px 28px;
                font-size: 1rem;
            }

            .login-card {
                margin: 20px;
                border-radius: 20px;
            }
        }

        @media (max-width: 480px) {
            .login-logo {
                font-size: 2rem;
            }

            .login-subtitle {
                font-size: 0.9rem;
            }

            .btn-github {
                padding: 12px 24px;
                font-size: 0.95rem;
            }

            .login-card .card-body {
                padding: 2rem !important;
            }
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#9a72ff', // ä¸»ç´«è‰²
                        secondary: '#1b1240', // æ·±ç´«è‰²èƒŒæ™¯
                        accent: '#b78bff', // äº®ç´«è‰²å¼ºè°ƒ
                        dark: '#0b0a20', // æ·±è‰²èƒŒæ™¯
                        'dark-light': '#0f0e22', // ç¨äº®çš„æ·±è‰²
                        'laser-purple': '#9a72ff', // æ¿€å…‰ç´«è‰²
                        'neon-purple': '#b78bff', // éœ“è™¹ç´«è‰²
                        'electric-purple': '#7c6aff', // ç”µå…‰ç´«è‰²
                    },
                    fontFamily: {
                        inter: ['Inter', 'sans-serif'],
                    },
                    boxShadow: {
                        'neon': '0 0 10px rgba(154, 114, 255, 0.5), 0 0 20px rgba(154, 114, 255, 0.3)',
                        'neon-lg': '0 0 15px rgba(154, 114, 255, 0.7), 0 0 30px rgba(154, 114, 255, 0.5)',
                        'laser': '0 0 20px rgba(154, 114, 255, 0.8), 0 0 40px rgba(154, 114, 255, 0.6), 0 0 60px rgba(154, 114, 255, 0.4), 0 0 80px rgba(154, 114, 255, 0.2)',
                        'laser-intense': '0 0 25px rgba(154, 114, 255, 0.9), 0 0 50px rgba(154, 114, 255, 0.7), 0 0 75px rgba(154, 114, 255, 0.5), 0 0 100px rgba(154, 114, 255, 0.3), 0 0 125px rgba(154, 114, 255, 0.1)',
                        'electric': '0 0 15px rgba(124, 106, 255, 0.8), 0 0 30px rgba(124, 106, 255, 0.6), 0 0 45px rgba(124, 106, 255, 0.4)'
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">

        [v-cloak] { display: none; }
        /* ç¡®ä¿htmlå’Œbodyèƒ½å¤Ÿæ­£ç¡®å¡«å…… */
        html {
            height: 100%;
        }

        /* ç¡®ä¿bodyå’Œappå®¹å™¨èƒ½å¤Ÿæ­£ç¡®å¡«å…… */
        body {
            margin: 0;
            padding: 0;
            width: 125vw;
            height: 125vh;
            overflow-x: hidden;
            overflow-y: auto;
            /* æ•´ä½“ç¼©æ”¾80% */
            transform: scale(0.8);
            transform-origin: top left;
        }


        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .text-gradient {
                background-clip: text;
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
            }
            /* æ–°å¢æ¸å˜å›¾æ ‡é¢œè‰²ç±» */
            .text-gradient-icon {
                background: linear-gradient(135deg, #d2c1ff, #a88bff, #8e88ff);
                -webkit-background-clip: text;
                background-clip: text;
                -webkit-text-fill-color: transparent;
            }
            .bg-grid {
                background-size: 40px 40px;
                background-image:
                    linear-gradient(to right, rgba(210, 193, 255, 0.15) 1px, transparent 1px),
                    linear-gradient(to bottom, rgba(210, 193, 255, 0.15) 1px, transparent 1px);
            }
            .scrollbar-thin {
                scrollbar-width: thin;
            }
            .scrollbar-thin::-webkit-scrollbar {
                width: 4px;
            }
            .scrollbar-thin::-webkit-scrollbar-thumb {
                background-color: rgba(210, 193, 255, 0.6);
                border-radius: 2px;
            }

            /* å†å²ä»»åŠ¡åŒºåŸŸæ»šåŠ¨æ¡æ ·å¼ - ä¸ä¸»å†…å®¹åŒºåŸŸä¿æŒä¸€è‡´ */
            .history-tasks-scroll::-webkit-scrollbar {
                width: 8px !important;
            }

            .history-tasks-scroll::-webkit-scrollbar-track {
                background: rgba(27, 18, 64, 0.3) !important;
                border-radius: 4px;
            }

            .history-tasks-scroll::-webkit-scrollbar-thumb {
                background: linear-gradient(135deg, rgba(210, 193, 255, 0.8), rgba(168, 139, 255, 0.8)) !important;
                border-radius: 4px;
                border: 1px solid rgba(210, 193, 255, 0.3);
            }

            .history-tasks-scroll::-webkit-scrollbar-thumb:hover {
                background: linear-gradient(135deg, rgba(210, 193, 255, 1), rgba(168, 139, 255, 1)) !important;
            }

            /* ç¡®ä¿å†å²ä»»åŠ¡åŒºåŸŸå¯ä»¥æ­£å¸¸æ»šåŠ¨ */
            .history-tasks-scroll {
                scroll-behavior: smooth;
                -webkit-overflow-scrolling: touch;
                /* ç§»é™¤max-heighté™åˆ¶ï¼Œè®©flex-1å æ®æ‰€æœ‰å¯ç”¨ç©ºé—´ */
            }

            /* ä¸»å†…å®¹åŒºåŸŸæ»šåŠ¨æ¡æ ·å¼ */
            .content-area::-webkit-scrollbar {
                width: 8px;
            }

            .content-area::-webkit-scrollbar-track {
                background: rgba(27, 18, 64, 0.3);
                border-radius: 4px;
            }

            .content-area::-webkit-scrollbar-thumb {
                background: linear-gradient(135deg, rgba(210, 193, 255, 0.8), rgba(168, 139, 255, 0.8));
                border-radius: 4px;
                border: 1px solid rgba(210, 193, 255, 0.3);
            }

            .content-area::-webkit-scrollbar-thumb:hover {
                background: linear-gradient(135deg, rgba(210, 193, 255, 1), rgba(168, 139, 255, 1));
            }

            /* ç¡®ä¿å†…å®¹å¯ä»¥æ­£å¸¸æ»šåŠ¨ */
            .content-area {
                scroll-behavior: smooth;
                -webkit-overflow-scrolling: touch;
            }
            .animate-pulse-slow {
                animation: pulse 3s cubic-bezier(0.4, 0, 0.6, 0.5) infinite;
            }
            .animate-float {
                animation: float 6s ease-in-out infinite;
            }
            .animate-laser-glow {
                animation: laserGlow 2s ease-in-out infinite alternate;
            }
            .animate-electric-pulse {
                animation: electricPulse 1.5s ease-in-out infinite;
            }
            .animate-neon-flicker {
                animation: neonFlicker 3s ease-in-out infinite;
            }
            @keyframes float {
                0% { transform: translateY(0px); }
                50% { transform: translateY(-10px); }
                100% { transform: translateY(0px); }
            }
            @keyframes laserGlow {
                0% {
                    box-shadow: 0 0 10px rgba(210, 193, 255, 0.8), 0 0 40px rgba(210, 193, 255, 0.6), 0 0 60px rgba(210, 193, 255, 0.4);
                    filter: brightness(0.8) saturate(0.7);
                }
                100% {
                    box-shadow: 0 0 20px rgba(210, 193, 255, 1), 0 0 60px rgba(210, 193, 255, 0.8), 0 0 90px rgba(210, 193, 255, 0.6);
                    filter: brightness(1) saturate(1);
                }
            }
            @keyframes electricPulse {
                0%, 100% {
                    box-shadow: 0 0 15px rgba(142, 136, 255, 0.8), 0 0 30px rgba(142, 136, 255, 0.6);
                    transform: scale(1);
                }
                50% {
                    box-shadow: 0 0 25px rgba(142, 136, 255, 1), 0 0 50px rgba(142, 136, 255, 0.8), 0 0 75px rgba(142, 136, 255, 0.4);
                    transform: scale(1.02);
                }
            }
            @keyframes neonFlicker {
                0%, 100% {
                    box-shadow: 0 0 20px rgba(183, 139, 255, 0.8), 0 0 40px rgba(183, 139, 255, 0.6);
                    opacity: 1;
                }
                25% {
                    box-shadow: 0 0 15px rgba(183, 139, 255, 0.6), 0 0 30px rgba(183, 139, 255, 0.4);
                    opacity: 0.8;
                }
                75% {
                    box-shadow: 0 0 25px rgba(183, 139, 255, 1), 0 0 50px rgba(183, 139, 255, 0.8);
                    opacity: 1.1;
                }
            }
            .bg-laser-gradient {
                background: linear-gradient(135deg, #d2c1ff 0%, #a88bff 25%, #8e88ff 50%, #d2c1ff 75%, #a88bff 100%);
                background-size: 200% 200%;
                animation: gradientShift 3s ease-in-out infinite;
            }
            @keyframes gradientShift {
                0%, 100% { background-position: 0% 50%; }
                50% { background-position: 100% 50%; }
            }
            .text-laser-glow {
                text-shadow: 0 0 10px rgba(154, 114, 255, 0.8), 0 0 20px rgba(154, 114, 255, 0.6), 0 0 30px rgba(154, 114, 255, 0.4);
            }
            .border-laser {
                border-color: #d2c1ff;
                box-shadow: 0 0 15px rgba(154, 114, 255, 0.6), inset 0 0 15px rgba(154, 114, 255, 0.1);
            }
            .btn-primary{
                padding: 15px 25px;
                border-radius: 14px;
                font-weight: 500;
                font-size: 14px;
                letter-spacing: 0.2px;
                font-family: 'Inter', sans-serif;
                background: linear-gradient(135deg, #d2c1ff, #a88bff, #8e88ff);
                border: 0;
                text-decoration: none;
                box-shadow: 0 10px 30px rgba(140, 110, 255, 0.4);
                transition: transform 0.15s ease, box-shadow 0.15s ease;
            }
            .btn-primary:hover{
                transform: translateY(-1px);
                box-shadow: 0 14px 40px rgba(140, 110, 255, 0.55);
            }

            /* ä¿®å¤å¸ƒå±€é—®é¢˜ */
            .task-type-btn {
                padding: 0.75rem 1rem;
                font-size: 0.875rem;
                font-weight: 500;
                transition-property: color, background-color;
                transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
                transition-duration: 150ms;
            }

            .task-type-btn:hover {
                background-color: rgba(154, 114, 255, 0.1);
            }

            .model-selection {
                display: flex;
                flex-wrap: wrap;
                gap: 0.5rem;
            }

            .upload-section {
                display: grid;
                grid-template-columns: repeat(1, minmax(0, 1fr));
                gap: 1.5rem;
                margin-bottom: 1.5rem;
            }

            @media (min-width: 768px) {
                .upload-section {
                    grid-template-columns: repeat(2, minmax(0, 1fr));
                }
            }

            .upload-area {
                position: relative;
                border: 2px dashed rgba(154, 114, 255, 0.4);
                border-radius: 0.75rem;
                padding: 1.5rem;
                text-align: center;
                transition-property: all;
                transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
                transition-duration: 150ms;
                cursor: pointer;
                background-color: rgba(27, 18, 64, 0.1);
                min-height: 250px; /* ç¡®ä¿ä¸Šä¼ åŒºåŸŸæœ‰æœ€å°é«˜åº¦ï¼Œé˜²æ­¢é¢„è§ˆæ—¶é«˜åº¦æ”¶ç¼© */
            }

            .upload-area:hover {
                border-color: rgba(154, 114, 255, 0.7);
                box-shadow: 0 0 20px rgba(154, 114, 255, 0.8), 0 0 40px rgba(154, 114, 255, 0.6), 0 0 60px rgba(154, 114, 255, 0.4), 0 0 80px rgba(154, 114, 255, 0.2);
            }

            .upload-icon {
                margin: 0 auto;
                width: 4rem;
                height: 4rem;
                background-color: rgba(154, 114, 255, 0.2);
                border-radius: 9999px;
                display: flex;
                align-items: center;
                justify-content: center;
                margin-bottom: 1rem;
                transition-property: all;
                transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
                transition-duration: 150ms;
            }

            .upload-area:hover .upload-icon {
                background-color: rgba(154, 114, 255, 0.3);
            }

            /* å›¾ç‰‡é¢„è§ˆå æ®æ•´ä¸ªä¸Šä¼ åŒºåŸŸ */
            .image-preview {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                overflow: hidden;
                z-index: 10;
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: pointer;
            }

            .image-preview img {
                height: 100%;
                width: auto;
                max-width: 100%;
                display: block;
                margin: 0 auto;
                object-fit: contain;
                transition: all 0.3s ease;
            }

            /* éŸ³é¢‘é¢„è§ˆå æ®æ•´ä¸ªä¸Šä¼ åŒºåŸŸ */
            .audio-preview {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                border-radius: 0.75rem;
                overflow: hidden;
                z-index: 10;
                display: flex;
                align-items: center;
                justify-content: center;
                background-color: rgba(154, 114, 255, 0.1);
                border: 2px solid rgba(154, 114, 255, 0.3);
                cursor: pointer;
            }

            .audio-preview audio {
                width: 90%;
                height: 60px;
                max-height: 80%;
                border-radius: 0.5rem;
                background-color: rgba(27, 18, 64, 0.3);
                display: block;
            }

            /* ç¡®ä¿éŸ³é¢‘æ§ä»¶åœ¨å®¹å™¨ä¸­æ­£ç¡®æ˜¾ç¤º */
            .audio-preview audio::-webkit-media-controls {
                background-color: rgba(27, 18, 64, 0.5);
                border-radius: 0.5rem;
            }

            /* ä¸Šä¼ å†…å®¹æ ·å¼ */
            .upload-content {
                width: 100%;
                height: 100%;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
            }

            .btn-close {
                position: absolute;
                top: 0.5rem;
                right: 0.5rem;
                background-color: #ef4444;
                color: white;
                border-radius: 9999px;
                width: 1.5rem;
                height: 1.5rem;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 0.75rem;
                cursor: pointer;
                z-index: 20;
                box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            }

            /* ç¡®ä¿flexboxå¸ƒå±€æ­£ç¡® */
            #app {
                display: flex;
                width: 100%;
                height: 100%;
            }

            .bg-linear-dark {
                background-color: linear-gradient(135deg, #0b0a20 0%, #1b1240 50%, #0f0e22 100%);
            }

            aside {
                flex-shrink: 0;
                width: 280px; /* é»˜è®¤å±•å¼€å®½åº¦ */
                min-width: 3rem; /* æœ€å°å®½åº¦ */
                max-width: 500px; /* æœ€å¤§å®½åº¦ */
                background-color: linear-gradient(135deg, #0b0a20 0%, #1b1240 50%, #0f0e22 100%);
                border-right: 1px solid rgba(154, 114, 255, 0.4);
                display: flex;
                flex-direction: column;
                transition-property: all;
                transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
                transition-duration: 300ms;
                z-index: 10;
                position: relative;
            }

            /* æ‹–æ‹½è°ƒæ•´å™¨ */
            .resize-handle {
                position: absolute;
                top: 0;
                right: 0;
                width: 4px;
                height: 100%;
                background: transparent;
                cursor: col-resize;
                z-index: 20;
                transition: background-color 0.2s ease;
            }

            .resize-handle:hover {
                background: rgba(154, 114, 255, 0.5);
            }

            .resize-handle:active {
                background: rgba(154, 114, 255, 0.8);
            }

            /* æ‹–æ‹½æ—¶çš„è§†è§‰åé¦ˆ */
            .resizing {
                user-select: none;
                pointer-events: none;
            }

            .resizing * {
                pointer-events: none;
            }

            main {
                flex: 1;
                display: flex;
                flex-direction: column;
                min-width: 0;
                width: calc(100% - 280px); /* ä¸»å†…å®¹åŒºåŸŸå æ®å‰©ä½™å®½åº¦ï¼Œé€‚åº”å±•å¼€çš„ä¾§è¾¹æ  */
                height: 100%;
            }

            /* å†…å®¹åŒºåŸŸå…¨å±æ˜¾ç¤º */
            .content-area {
                flex: 1;
                overflow-y: auto;
                background-color: #0b0a20;
                padding: 2rem;
                width: 100%;
                min-height: 0; /* ç¡®ä¿flexå­å…ƒç´ å¯ä»¥æ”¶ç¼© */
            }

            /* ä»»åŠ¡åˆ›å»ºé¢æ¿å…¨å± */
            #task-creator {
                max-width: none;
                width: 80%;
                padding: 0 1rem;
            }

            /* ä»»åŠ¡è¯¦æƒ…é¢æ¿å…¨å± */
            .task-detail-panel {
                max-width: none;
                width: 80%;
                padding: 0 0rem;
            }

            /* ä¸Šä¼ åŒºåŸŸå…¨å±å¸ƒå±€ */
            .upload-section {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
                gap: 2rem;
                margin-bottom: 2rem;
                width: 100%;
            }

            /* ä»»åŠ¡ç±»å‹é€‰æ‹©å…¨å± */
            .task-type-selection {
                width: 100%;
                margin-bottom: 2rem;
            }

            .task-type-buttons {
                display: flex;
                width: 100%;
                border-bottom: 1px solid rgba(154, 114, 255, 0.3);
            }

            .task-type-btn {
                flex: 1;
                padding: 1rem 1.5rem;
                font-size: 1rem;
                font-weight: 500;
                transition-property: color, background-color;
                transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
                transition-duration: 150ms;
                text-align: center;
            }

            /* æ¨¡å‹é€‰æ‹©å…¨å± */
            .model-selection {
                display: flex;
                flex-wrap: wrap;
                gap: 1rem;
                width: 100%;
                justify-content: flex-start;
            }

            /* æç¤ºè¯è¾“å…¥å…¨å± */
            .prompt-input-section {
                width: 100%;
                margin-bottom: 2rem;
            }

            .prompt-textarea {
                width: 100%;
                min-height: 150px;
                resize: vertical;
            }

            /* ä¾§è¾¹æ æŠ˜å æ ·å¼ */
            .sidebar-collapsed {
                width: 3rem !important;
            }

            /* ä¾§è¾¹æ å±•å¼€æ ·å¼ */
            aside:not(.sidebar-collapsed) {
                width: 280px !important;
            }

            .sidebar-collapsed .sidebar-content {
                display: none !important;
            }

            .sidebar-collapsed .resize-handle {
                display: none !important;
            }

            .sidebar-collapsed .user-info-section {
                display: none !important;
            }

            .sidebar-collapsed .sidebar-header {
                justify-content: center;
                padding: 1rem 0.5rem;
            }

            .sidebar-collapsed .sidebar-header h1 {
                display: none;
            }

            /* å±•å¼€çŠ¶æ€ä¸‹æ˜¾ç¤ºæ‰€æœ‰å†…å®¹ */
            aside:not(.sidebar-collapsed) .sidebar-content {
                display: flex !important;
            }

            aside:not(.sidebar-collapsed) .resize-handle {
                display: block !important;
            }

            aside:not(.sidebar-collapsed) .sidebar-header {
                justify-content: space-between;
                padding: 1rem;
            }

            aside:not(.sidebar-collapsed) .sidebar-header h1 {
                display: flex;
            }

            aside:not(.sidebar-collapsed) .sidebar-header .toggle-btn {
                display: flex !important;
                align-items: center;
                justify-content: center;
            }

            aside:not(.sidebar-collapsed) .user-info-section {
                display: block !important;
            }

            .sidebar-collapsed .sidebar-header .toggle-btn {
                display: flex !important;
                align-items: center;
                justify-content: center;
                width: 2rem;
                height: 2rem;
                border-radius: 0.375rem;
                background-color: rgba(154, 114, 255, 0.1);
                border: 1px solid rgba(154, 114, 255, 0.3);
                margin: 0 auto;
            }

            /* å½“ä¾§è¾¹æ æŠ˜å æ—¶ï¼Œä¸»å†…å®¹åŒºåŸŸè°ƒæ•´ */
            .sidebar-collapsed + main {
                width: calc(100% - 3rem);
            }

            /* å½“ä¾§è¾¹æ å±•å¼€æ—¶ï¼Œä¸»å†…å®¹åŒºåŸŸè°ƒæ•´ */
            aside:not(.sidebar-collapsed) + main {
                width: calc(100% - 280px);
            }

            /* å“åº”å¼è®¾è®¡ */
            @media (max-width: 1200px) {
                aside:not(.sidebar-collapsed) {
                    width: 250px !important;
                }

                .sidebar-collapsed + main {
                    width: calc(100% - 3rem);
                }

                aside:not(.sidebar-collapsed) + main {
                    width: calc(100% - 250px);
                }
            }

            @media (max-width: 768px) {
                aside:not(.sidebar-collapsed) {
                    width: 200px !important;
                }

                .sidebar-collapsed + main {
                    width: calc(100% - 3rem);
                }

                aside:not(.sidebar-collapsed) + main {
                    width: calc(100% - 200px);
                }

                .upload-section {
                    grid-template-columns: 1fr;
                }
            }

            /* ä¿®å¤ä»»åŠ¡é¡¹æ ·å¼ */
            .task-item {
                padding: 0.75rem;
                border-radius: 0.5rem;
                cursor: pointer;
                transition-property: all;
                transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
                transition-duration: 200ms;
            }

            .task-item:hover {
                background-color: rgba(154, 114, 255, 0.15);
                box-shadow: 0 0 20px rgba(154, 114, 255, 0.8), 0 0 40px rgba(154, 114, 255, 0.6), 0 0 60px rgba(154, 114, 255, 0.4), 0 0 80px rgba(154, 114, 255, 0.2);
            }

            /* ä¿®å¤çŠ¶æ€æŒ‡ç¤ºå™¨ */
            .status-indicator {
                width: 0.75rem;
                height: 0.75rem;
                border-radius: 9999px;
                box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            }

            /* ä¿®å¤æŒ‰é’®æ ·å¼ */
            .btn-primary {
                padding: 12px 22px;
                border-radius: 14px;
                font-weight: 700;
                letter-spacing: 0.2px;
                color: #0c0920;
                background: linear-gradient(135deg, #d2c1ff, #a88bff, #8e88ff);
                border: 0;
                text-decoration: none;
                box-shadow: 0 10px 30px rgba(140, 110, 255, 0.4);
                transition: transform 0.15s ease, box-shadow 0.15s ease;
                cursor: pointer;
                display: inline-block;
            }

            .btn-primary:hover {
                transform: translateY(-1px);
                box-shadow: 0 14px 40px rgba(140, 110, 255, 0.55);
            }

            /* ä¿®å¤æ¨¡å‹æŒ‰é’®æ ·å¼ */
            .model-btn {
                padding: 0.5rem 1rem;
                border-radius: 0.5rem;
                font-size: 0.875rem;
                transition-property: all;
                transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
                transition-duration: 150ms;
                cursor: pointer;
                border: 1px solid;
            }

            .model-btn.active {
                background-color: rgba(154, 114, 255, 0.2);
                border-color: rgba(154, 114, 255, 0.4);
                box-shadow: 0 0 20px rgba(154, 114, 255, 0.8), 0 0 40px rgba(154, 114, 255, 0.6), 0 0 60px rgba(154, 114, 255, 0.4), 0 0 80px rgba(154, 114, 255, 0.2);
                animation: electricPulse 1.5s ease-in-out infinite;
            }

            /* ç¡®ä¿å†…å®¹åŒºåŸŸæ­£ç¡®æ»šåŠ¨ */
            .content-scroll {
                flex: 1;
                overflow-y: auto;
            }


            /* ä»»åŠ¡è¿›è¡Œä¸­é¢æ¿æ ·å¼ */
            .task-running-panel .animate-pulse-slow {
                animation: pulse 3s cubic-bezier(0.4, 0, 0.6, 0.5) infinite;
            }

            /* ä»»åŠ¡å¤±è´¥é¢æ¿æ ·å¼ */
            .task-failed-panel .bg-red-500\/10 {
                background-color: rgba(239, 68, 68, 0.1);
            }


            .task-detail-panel video {
                width: 100%;
                height: 100%;
                object-fit: cover;
            }

            /* ç´ æé¢„è§ˆæ ·å¼ */
            .material-preview {
                display: flex;
                flex-wrap: wrap;
                gap: 0.75rem;
            }

            .material-preview img {
                border-radius: 0.5rem;
                transition: all 0.2s ease;
            }

            .material-preview img:hover {
                transform: scale(1.05);
                box-shadow: 0 0 20px rgba(154, 114, 255, 0.6);
            }

            /* ä»»åŠ¡çŠ¶æ€æŒ‡ç¤ºå™¨å¢å¼º */
            .status-indicator {
                position: relative;
            }

            .status-indicator::after {
                content: '';
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                width: 0.25rem;
                height: 0.25rem;
                background-color: currentColor;
                border-radius: 50%;
                opacity: 0.8;
            }

            /* ä»»åŠ¡é¢æ¿åˆ‡æ¢åŠ¨ç”» */
            .task-panel-enter-active,
            .task-panel-leave-active {
                transition: all 0.3s ease;
            }

            .task-panel-enter-from {
                opacity: 0;
                transform: translateY(20px);
            }

            .task-panel-leave-to {
                opacity: 0;
                transform: translateY(-20px);
            }

            /* å“åº”å¼ä»»åŠ¡é¢æ¿ */
            @media (max-width: 768px) {
                .task-detail-panel {
                    padding: 0 0.5rem;
                }
            }

            /* æç¤ºæ¶ˆæ¯åŠ¨ç”» */
            .animate-slide-down {
                animation: slideDown 0.3s ease-out;
            }

            @keyframes slideDown {
                0% {
                    opacity: 0;
                    transform: translate(-50%, -100%);
                }
                100% {
                    opacity: 1;
                    transform: translate(-50%, 0);
                }
            }

            /* æç¤ºæ¶ˆæ¯æ ·å¼ - ç»Ÿä¸€æµ…è‰²é€æ˜èƒŒæ™¯ */
            .alert {
                backdrop-filter: blur(15px);
                background: rgba(255, 255, 255, 0.15);
                border-radius: 0.75rem;
                box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
                color: #333;
            }
        }
    </style>
</head>
<body
    class="bg-dark text-gray-100 font-inter"
>
    <div id="app">
       <!-- ç™»å½•é¡µé¢ -->
       <div v-if="!isLoggedIn" class="login-container">
        <!-- æµ®åŠ¨ç²’å­èƒŒæ™¯ -->
        <div class="floating-particles">
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
        </div>

        <div class="login-card">
                        <div class="card-body text-center p-5">
                            <!-- Logoå’Œæ ‡é¢˜ -->
                            <div class="mb-4">
                                <div class="login-logo">
                                    <i class="fas fa-film me-3"></i>
                                    LightX2V
                                </div>
                                <p class="login-subtitle">ä¸€ä¸ªå¼ºå¤§çš„è§†é¢‘ç”Ÿæˆå¹³å°</p>
                            </div>

                            <!-- ç™»å½•æŒ‰é’® -->
                            <button @click="loginWithGitHub" class="btn btn-github btn-lg w-100 mb-4" :disabled="loading">
                                <i class="fab fa-github me-2"></i>
                                {{ loading ? 'ç™»å½•ä¸­...' : 'ä½¿ç”¨GitHubç™»å½•' }}
                            </button>

                            <!-- åŠŸèƒ½ç‰¹æ€§ -->
                            <div class="login-features">
                                <div class="feature-item">
                                    <div class="feature-icon">ğŸ­</div>
                                    <span>ç”µå½±çº§æ•°å­—äººè§†é¢‘</span>
                                </div>
                                <div class="feature-item">
                                    <div class="feature-icon">âš¡</div>
                                    <span>20å€ç”Ÿæˆæé€Ÿ</span>
                                </div>
                                <div class="feature-item">
                                    <div class="feature-icon">ğŸ’°</div>
                                    <span>è¶…ä½æˆæœ¬ç”Ÿæˆ</span>
                                </div>
                                <div class="feature-item">
                                    <div class="feature-icon">ğŸ¯</div>
                                    <span>ç²¾å‡†å£å‹å¯¹é½</span>
                                </div>
                                <div class="feature-item">
                                    <div class="feature-icon">ğŸ“±</div>
                                    <span>åˆ†é’Ÿçº§è§†é¢‘æ—¶é•¿</span>
                                </div>
                                <div class="feature-item">
                                    <div class="feature-icon">ğŸ¨</div>
                                    <span>å¤šåœºæ™¯åº”ç”¨</span>
                                </div>
                            </div>
                        </div>
        </div>
    </div>

    <!-- ä¸»åº”ç”¨é¡µé¢ -->
    <div v-else class="main-container">
        <!-- æµ®åŠ¨ç²’å­èƒŒæ™¯ -->
        <div class="floating-particles">
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
        </div>

        <!-- ä¾§è¾¹æ  - å†å²ä»»åŠ¡ -->
        <aside class="w-64 bg-linear-dark border-r border-laser-purple/40 flex flex-col transition-all duration-300 ease-in-out z-10" ref="sidebar" :class="{ 'sidebar-collapsed': sidebarCollapsed }">
            <!-- æ‹–æ‹½è°ƒæ•´å™¨ -->
            <div class="resize-handle" @mousedown="startResize"></div>
            <div class="p-4 border-b border-laser-purple/40 sidebar-header">
                <div class="flex items-center justify-between">
                    <h1 class="text-xl font-bold flex items-center">
                        <i class="fas fa-video text-gradient-icon mr-2"></i>
                        <span>LightX2V</span>
                    </h1>
                    <button
                        @click="toggleSidebar"
                        class="text-gray-400 hover:text-gradient-icon transition-colors flex-shrink-0 toggle-btn"
                        title="å±•å¼€/æŠ˜å ä¾§è¾¹æ ">
                        <i class="fas fa-bars"></i>
                    </button>
                </div>
            </div>
            <div class="sidebar-content flex flex-col flex-1 min-h-0">
                <div class="p-3 border-b border-laser-purple/40">
                    <button
                        @click="showTaskCreator"
                        class="w-full btn-primary py-2 rounded-lg flex items-center justify-center transition-all duration-200 font-medium text-sm">
                        <i class="fas fa-plus mr-2"></i>
                        æ–°å»ºä»»åŠ¡
                    </button>
                <div class="relative mt-3">
                    <input
                        v-model="searchQuery"
                        class="w-full bg-dark-light border border-laser-purple/30 rounded-lg py-2 pl-10 pr-4 text-sm focus:outline-none focus:ring-2 focus:ring-laser-purple/50 transition-all focus:border-laser focus:shadow-laser"
                        placeholder="æœç´¢"
                        type="text"
                    />
                    <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                </div>

                <!-- çŠ¶æ€è¿‡æ»¤å’Œåˆ·æ–° -->
                <div class="mt-3">
                    <div class="flex flex-wrap gap-1 justify-between items-center">
                    <div class="flex flex-wrap gap-1">
                        <button
                            @click="statusFilter = 'ALL'"
                            class="px-2 py-1 text-xs rounded transition-all"
                                :class="statusFilter === 'ALL' ? 'bg-dark-light bg-laser-purple/40' : 'bg-dark-light text-gray-400 hover:bg-laser-purple/20'"
                        >
                            å…¨éƒ¨
                        </button>
                        <button
                            @click="statusFilter = 'SUCCEED'"
                            class="px-2 py-1 text-xs rounded transition-all"
                            :class="statusFilter === 'SUCCEED' ? 'bg-green-500/30 text-green-400' : 'bg-dark-light text-gray-400 hover:bg-green-500/20'"
                        >
                            æˆåŠŸ
                        </button>
                        <button
                            @click="statusFilter = 'RUNNING'"
                            class="px-2 py-1 text-xs rounded transition-all"
                            :class="statusFilter === 'RUNNING' ? 'bg-yellow-500/30 text-yellow-400' : 'bg-dark-light text-gray-400 hover:bg-yellow-500/20'"
                        >
                            è¿›è¡Œä¸­
                        </button>
                        <button
                            @click="statusFilter = 'FAILED'"
                            class="px-2 py-1 text-xs rounded transition-all"
                            :class="statusFilter === 'FAILED' ? 'bg-red-500/30 text-red-400' : 'bg-dark-light text-gray-400 hover:bg-red-500/20'"
                        >
                            å¤±è´¥
                        </button>
                    </div>
                        <button
                            @click="refreshTasks"
                            class="text-gray-400 hover:text-gradient-icon transition-colors flex-shrink-0"
                            title="åˆ·æ–°ä»»åŠ¡åˆ—è¡¨"
                        >
                            <i class="fas fa-sync-alt"></i>
                        </button>
                </div>
            </div>
            </div>
            <div class="flex-1 overflow-y-auto history-tasks-scroll p-2 min-h-0">
                <div class="text-xs uppercase text-gray-400 font-semibold mb-2 px-3">
                    å†å²ä»»åŠ¡
                </div>
                <!-- å†å²ä»»åŠ¡åˆ—è¡¨ -->
                <div class="space-y-1" id="history-tasks">
                    <div v-if="filteredTasks.length === 0" class="flex-col items-center justify-center py-12 text-center">
                        <p class="text-gray-400 text-sm">æš‚æ— å†å²ä»»åŠ¡</p>
                        <p class="text-gray-500 text-xs mt-1">å¼€å§‹åˆ›å»ºä½ çš„ç¬¬ä¸€ä¸ªAIè§†é¢‘å§</p>
                    </div>
                    <!-- ä»»åŠ¡é¡¹ -->
                    <div
                        v-for="task in filteredTasks"
                        :key="task.task_id"
                        class="task-item p-2 rounded-lg cursor-pointer hover:bg-laser-purple/15 hover:shadow-laser transition-all duration-200"
                        :class="getTaskItemClass(task.status)"
                        @click="viewTaskDetail(task)"
                    >
                        <div class="flex items-start gap-3 mb-2">
                            <div class="w-16 h-12 bg-dark-light rounded overflow-hidden flex-shrink-0">
                                <template v-for="(thumbnailInfo, index) in [getVideoThumbnailInfo(task.task_id, 'output_video')]" :key="index">
                                    <img
                                        v-if="thumbnailInfo.hasThumbnail"
                                        :src="thumbnailInfo.url"
                                        alt="ä»»åŠ¡é¢„è§ˆ"
                                        class="w-full h-full object-cover"
                                        @error="handleThumbnailError"
                                    />
                                    <div v-else class="w-full h-full bg-laser-purple/20 flex items-center justify-center">
                                        <i class="fas fa-video text-gradient-icon text-xl"></i>
                                    </div>
                                </template>
                            </div>
                            <div class="flex-1 min-w-0">
                                <div class="flex justify-between items-start mb-1 gap-2">
                                    <h3 class="font-medium text-sm truncate max-w-[calc(100%-2rem)]">{{ task.params.prompt || 'æ— æ ‡é¢˜ä»»åŠ¡' }}</h3>
                                    <div
                                        :class="getStatusIndicatorClass(task.status)"
                                        :title="getTaskStatusDisplay(task.status)"
                                        class="flex-shrink-0"
                                    ></div>
                                </div>
                                <p class="text-xs text-gray-400 mb-2 line-clamp-1">
                                     {{ getTaskTypeName(task) }} | {{ getRelativeTime(task.create_t) }}
                                </p>
                                <div class="flex items-center justify-between text-xs gap-2">
                                    <span class="text-gray-500 truncate max-w-[calc(100%-4rem)]">{{ task.model_cls }}</span>
                                    <span :class="getTaskStatusColor(task.status)" class="font-medium flex-shrink-0">
                                        {{ getTaskStatusDisplay(task.status) }}
                                    </span>
                            </div>
                        </div>
                    </div>

                    </div>
                </div>
            </div>
            </div>

            <!-- ç”¨æˆ·ä¿¡æ¯åŒºåŸŸ - ä»»åŠ¡æ åº•éƒ¨åˆ†åŒº -->
            <div class="mt-auto p-3 border-t border-laser-purple/40 user-info-section">
                <div class="flex items-center space-x-3">
                    <!-- ç”¨æˆ·å¤´åƒ -->
                    <div v-if="currentUser.avatar_url" class="w-10 h-10 rounded-full border border-laser-purple/40 overflow-hidden flex-shrink-0">
                        <img
                            :src="currentUser.avatar_url"
                            alt="ç”¨æˆ·å¤´åƒ"
                            class="w-full h-full object-cover"
                        />
                    </div>
                    <!-- é»˜è®¤ç”¨æˆ·å›¾æ ‡ -->
                    <div v-else class="w-10 h-10 rounded-full border border-laser-purple/40 bg-laser-purple/20 flex items-center justify-center flex-shrink-0">
                        <i class="fas fa-user text-gradient-icon"></i>
                    </div>

                    <!-- ç”¨æˆ·ä¿¡æ¯ -->
                    <div class="flex-1 min-w-0">
                        <div class="text-sm font-medium text-gray-100 truncate">
                            {{ currentUser.username }}
                        </div>
                        <div class="text-xs text-gray-400 truncate">
                            {{ currentUser.email }}
                        </div>
                    </div>

                    <!-- é€€å‡ºæŒ‰é’® -->
                    <button @click="logout" class="text-gray-400 hover:text-gradient-icon transition-colors flex-shrink-0" title="é€€å‡ºç™»å½•">
                        <i class="fas fa-sign-out-alt"></i>
                    </button>
                </div>
            </div>

        </aside>

        <!-- ä¸»å†…å®¹åŒº -->
        <main class="flex-1 flex flex-col overflow-hidden">

            <!-- å†…å®¹åŒºåŸŸ -->
            <div class="flex-1 overflow-y-auto bg-dark p-6 content-area">
                <!-- æ¨¡æ¿é€‰æ‹©æµ®çª— -->
                 <div v-cloak>
                    <div v-if="showImageTemplates || showAudioTemplates"
                        class="fixed inset-0 bg-black/50 z-50 flex items-center justify-center"
                        @click="showImageTemplates = false; showAudioTemplates = false">
                        <div class="bg-secondary rounded-xl p-6 max-w-4xl w-full mx-4 max-h-[80vh] overflow-hidden"
                            @click.stop>
                            <!-- æµ®çª—å¤´éƒ¨ -->
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-medium text-white">
                                    <i v-if="showImageTemplates" class="fas fa-image text-gradient-icon mr-2"></i>
                                    <i v-if="showAudioTemplates" class="fas fa-music text-gradient-icon mr-2"></i>
                                    {{ showImageTemplates ? 'é€‰æ‹©å›¾ç‰‡æ¨¡æ¿' : 'é€‰æ‹©éŸ³é¢‘æ¨¡æ¿' }}
                                </h3>
                                <button @click="showImageTemplates = false; showAudioTemplates = false"
                                        class="text-gray-400 hover:text-white transition-colors">
                                    <i class="fas fa-times text-xl"></i>
                                </button>
                            </div>

                            <!-- å›¾ç‰‡æ¨¡æ¿ç½‘æ ¼ -->
                            <div v-if="showImageTemplates" class="overflow-y-auto max-h-[50vh]">
                                <div v-if="imageTemplates.length > 0" class="grid grid-cols-4 gap-4">
                                    <div v-for="template in imageTemplates" :key="template.filename"
                                        @click="selectImageTemplate(template)"
                                        class="relative group cursor-pointer rounded-lg overflow-hidden border border-gray-700 hover:border-laser-purple/50 transition-all">
                                        <img :src="template.url" :alt="template.filename"
                                            class="w-full h-32 object-cover">
                                        <div class="absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center">
                                            <i class="fas fa-check text-white text-2xl"></i>
                                        </div>
                                        <div class="absolute bottom-0 left-0 right-0 bg-black/80 text-white text-xs p-2">
                                            <div class="truncate">{{ template.filename }}</div>
                                        </div>
                                    </div>
                                </div>
                                <div v-else class="flex flex-col items-center justify-center py-12 text-center">
                                    <div class="w-16 h-16 bg-laser-purple/20 rounded-full flex items-center justify-center mb-4">
                                        <i class="fas fa-image text-gradient-icon text-2xl"></i>
                                    </div>
                                    <p class="text-gray-400 text-lg mb-2">ç›®å‰æš‚æ— å›¾ç‰‡æ¨¡æ¿</p>
                                </div>
                            </div>

                            <!-- éŸ³é¢‘æ¨¡æ¿åˆ—è¡¨ -->
                            <div v-if="showAudioTemplates" class="overflow-y-auto max-h-[50vh]">
                                <div v-if="audioTemplates.length > 0" class="space-y-3">
                                    <div v-for="template in audioTemplates" :key="template.filename"
                                        @click="selectAudioTemplate(template)"
                                        class="flex items-center gap-4 p-4 rounded-lg border border-gray-700 hover:border-laser-purple/50 transition-all cursor-pointer bg-dark-light/50">
                                        <div class="w-12 h-12 bg-laser-purple/20 rounded-lg flex items-center justify-center">
                                            <i class="fas fa-music text-gradient-icon text-xl"></i>
                                        </div>
                                        <div class="flex-1">
                                            <div class="text-white font-medium">{{ template.filename }}</div>
                                            <div class="text-gray-400 text-sm">éŸ³é¢‘æ¨¡æ¿</div>
                                        </div>
                                        <button @click.stop="previewAudioTemplate(template)"
                                                class="px-3 py-2 bg-laser-purple/20 hover:bg-laser-purple/30 text-gradient-icon rounded-lg transition-all">
                                            <i class="fas fa-play mr-2"></i>
                                            è¯•å¬
                                        </button>
                                    </div>
                                </div>
                                <div v-else class="flex flex-col items-center justify-center py-12 text-center">
                                    <div class="w-16 h-16 bg-laser-purple/20 rounded-full flex items-center justify-center mb-4">
                                        <i class="fas fa-music text-gradient-icon text-2xl"></i>
                                    </div>
                                    <p class="text-gray-400 text-lg mb-2">ç›®å‰æš‚æ— éŸ³é¢‘æ¨¡æ¿</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ä»»åŠ¡åˆ›å»ºé¢æ¿ -->
                <div v-if="showCreator" class="max-w-4xl mx-auto" id="task-creator">
                    <!-- ä»»åŠ¡ç±»å‹é€‰æ‹© -->
                    <div class="mb-8 task-type-selection">
                        <div class="flex border-b border-laser-purple/30 task-type-buttons">
                            <button
                                v-for="taskType in availableTaskTypes"
                                :key="taskType"
                                @click="selectTask(taskType)"
                                class="task-type-btn"
                                :class="getTaskTypeBtnClass(taskType)"
                            >
                                <i :class="getTaskTypeIcon(taskType)" class="mr-2"></i>
                                {{ getTaskTypeName(taskType) }}
                            </button>
                        </div>
                    </div>

                    <!-- æ¨¡å‹é€‰æ‹© -->
                    <div v-if="selectedTaskId" class="mb-6">
                        <label class="block text-sm text-gray-400 mb-2">é€‰æ‹©æ¨¡å‹</label>
                        <div class="model-selection">
                            <button
                                v-for="model in availableModelClasses"
                                :key="model"
                                @click="selectModel(model)"
                                class="model-btn px-4 py-2 rounded-lg text-sm transition-all"
                                :class="getModelBtnClass(model)"
                            >
                                <i v-if="model === getCurrentForm().model_cls" class="fas fa-star text-yellow-400 mr-1"></i>
                                {{ model }}
                            </button>
                        </div>
                    </div>

                    <!-- ä¸Šä¼ åŒºåŸŸ -->
                    <div v-if="selectedTaskId === 'i2v' || selectedTaskId === 'digital_human'" class="upload-section">
                        <!-- ä¸Šä¼ å›¾ç‰‡ -->
                        <div v-if="selectedTaskId === 'i2v' || selectedTaskId === 'digital_human'" class="upload-area" @click="triggerImageUpload">
                            <!-- é»˜è®¤ä¸Šä¼ ç•Œé¢ -->
                            <div v-if="!getCurrentImagePreview()" class="upload-content">
                            <div class="upload-icon">
                                <i class="fas fa-image text-gradient-icon text-xl"></i>
                            </div>
                            <p class="text-xs text-gray-400 mb-4">æ”¯æŒJPGã€PNGæ ¼å¼ï¼Œå¤§å°ä¸è¶…è¿‡10MB</p>
                            <div class="flex gap-2">
                                <button class="btn-primary px-4 py-1.5 rounded-lg transition-all flex-1">ä¸Šä¼ å›¾ç‰‡</button>
                                <button @click.stop="showImageTemplates = !showImageTemplates"
                                        class="px-4 py-1.5 rounded-lg bg-laser-purple/20 hover:bg-laser-purple/30 text-gradient-icon border border-laser-purple/40 rounded-lg transition-all">
                                    <i class="fas fa-images mr-1"></i>
                                    æ¨¡æ¿
                                </button>
                            </div>
                            </div>

                            <!-- å›¾ç‰‡é¢„è§ˆ -->
                            <div v-if="getCurrentImagePreview()" class="image-preview group">
                                <img :src="getCurrentImagePreview()" alt="é¢„è§ˆå›¾ç‰‡" class="w-full h-full object-cover rounded-lg transition-all duration-300 group-hover:brightness-50">

                                <!-- æ‚¬åœæ—¶æ˜¾ç¤ºçš„æ“ä½œæŒ‰é’®ï¼Œä½ç½®åœ¨ä¸­ä¸‹æ–¹ -->
                                <div class="absolute inset-x-0 bottom-4 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                                    <div class="flex space-x-3">
                                        <button
                                            @click.stop="triggerImageUpload"
                                            class="w-12 h-12 flex items-center justify-center bg-white/15 text-white p-3 rounded-full transition-all duration-200 hover:scale-110 shadow-lg"
                                            title="é‡æ–°ä¸Šä¼ ">
                                            <i class="fas fa-upload text-lg"></i>
                                        </button>
                                        <button
                                            @click.stop="removeImage"
                                            class="w-12 h-12 flex items-center justify-center bg-white/15 text-white p-3 rounded-full transition-all duration-200 hover:scale-110 shadow-lg"
                                            title="åˆ é™¤å›¾ç‰‡">
                                            <i class="fas fa-trash text-lg"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <input
                                type="file"
                                ref="imageInput"
                                @change="handleImageUpload"
                                accept="image/*"
                                style="display: none;">
                        </div>

                        <!-- ä¸Šä¼ éŸ³é¢‘ -->
                        <div v-if="selectedTaskId === 'digital_human'" class="upload-area" @click="triggerAudioUpload">
                            <!-- é»˜è®¤ä¸Šä¼ ç•Œé¢ -->
                            <div v-if="!getCurrentAudioPreview()" class="upload-content">
                            <div class="upload-icon">
                                <i class="fas fa-microphone text-gradient-icon text-xl"></i>
                            </div>
                                <p class="text-xs text-gray-400 mb-4">æ”¯æŒMP4ã€WAVæ ¼å¼ï¼Œæœ€é•¿æ”¯æŒ120s</p>
                            <div class="flex gap-2">
                                <button class="btn-primary px-4 py-1.5 rounded-lg transition-all flex-1">ä¸Šä¼ éŸ³é¢‘</button>
                                <button @click.stop="showAudioTemplates = !showAudioTemplates"
                                        class="px-4 py-1.5 rounded-lg bg-laser-purple/20 hover:bg-laser-purple/30 text-gradient-icon border border-laser-purple/40 rounded-lg transition-all">
                                    <i class="fas fa-music mr-1"></i>
                                    æ¨¡æ¿
                                </button>
                            </div>
                            </div>

                            <!-- éŸ³é¢‘é¢„è§ˆ -->
                            <div v-if="getCurrentAudioPreview()" class="audio-preview group" @click.stop>
                                <audio controls class="w-full h-full">
                                    <source :src="getCurrentAudioPreview()" :type="getAudioMimeType()">
                                </audio>

                                <!-- æ‚¬åœæ—¶æ˜¾ç¤ºçš„æ“ä½œæŒ‰é’®ï¼Œä½ç½®åœ¨ä¸­ä¸‹æ–¹ -->
                                <div class="absolute inset-x-0 bottom-4 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300 bg-black/20">
                                    <div class="flex space-x-3">
                                        <button
                                            @click.stop="triggerAudioUpload"
                                            class="w-12 h-12 flex items-center justify-center bg-white/15 text-white p-3 rounded-full transition-all duration-200 hover:scale-110 shadow-lg"
                                            title="é‡æ–°ä¸Šä¼ ">
                                            <i class="fas fa-upload text-lg"></i>
                                        </button>
                                        <button
                                            @click.stop="removeAudio"
                                            class="w-12 h-12 flex items-center justify-center bg-white/15 text-white p-3 rounded-full transition-all duration-200 hover:scale-110 shadow-lg"
                                            title="åˆ é™¤éŸ³é¢‘">
                                            <i class="fas fa-trash text-lg"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <input
                                type="file"
                                ref="audioInput"
                                @change="handleAudioUpload"
                                accept="audio/*"
                                style="display: none;">
                        </div>
                    </div>

                    <!-- æç¤ºè¯è¾“å…¥ -->
                    <div class="mb-6 prompt-input-section">
                        <div class="flex justify-between items-center mb-2">
                            <label class="block text-sm text-gray-400">æç¤ºè¯</label>
                            <div class="flex space-x-2">
                                <button @click="showPromptTemplates" class="text-xs text-gray-400 hover:text-gradient-icon transition-colors hover:text-gradient-icon" title="æç¤ºè¯æ¨¡æ¿">
                                    <i class="fas fa-magic"></i>
                                </button>
                                <button @click="showPromptHistory" class="text-xs text-gray-400 hover:text-gradient-icon transition-colors hover:text-gradient-icon" title="å†å²è®°å½•">
                                    <i class="fas fa-history"></i>
                                </button>
                            </div>
                        </div>

                        <!-- æç¤ºè¯æ¨¡æ¿é€‰æ‹© -->
                        <div v-if="showTemplates" class="mb-4 p-4 bg-linear-dark/30 rounded-lg">
                            <h4 class="text-sm font-medium mb-3 text-gradient-icon">é€‰æ‹©æç¤ºè¯æ¨¡æ¿</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                <button
                                    v-for="template in getPromptTemplates(selectedTaskId)"
                                    :key="template.id"
                                    @click="selectPromptTemplate(template)"
                                    class="p-3 text-left bg-dark-light rounded-lg hover:bg-laser-purple/20 transition-all border border-transparent hover:border-laser-purple/40"
                                >
                                    <div class="font-medium text-sm mb-1">{{ template.title }}</div>
                                    <div class="text-xs text-gray-400 line-clamp-2">{{ template.prompt }}</div>
                                </button>
                            </div>
                            <button @click="showTemplates = false" class="mt-3 text-xs text-gray-400 hover:text-gradient-icon">
                                <i class="fas fa-times mr-1"></i>å…³é—­æ¨¡æ¿
                            </button>
                        </div>

                        <!-- æç¤ºè¯å†å²è®°å½• -->
                        <div v-if="showHistory" class="mb-4 p-4 bg-secondary/30 rounded-lg">
                            <div class="flex justify-between items-center mb-3">
                                <h4 class="text-sm font-medium text-gradient-icon">æç¤ºè¯å†å²è®°å½•</h4>
                                <button @click="clearPromptHistory" class="text-xs text-red-400 hover:text-red-300 transition-colors" title="æ¸…ç©ºå†å²è®°å½•">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                            <div v-if="getPromptHistory().length === 0" class="text-center py-4 text-gray-400 text-sm">
                                æš‚æ— å†å²è®°å½•
                            </div>
                            <div v-else class="space-y-2 max-h-40 overflow-y-auto">
                                <button
                                    v-for="(history, index) in getPromptHistory()"
                                    :key="index"
                                    @click="selectPromptHistory(history)"
                                    class="w-full p-3 text-left bg-dark-light rounded-lg hover:bg-laser-purple/20 transition-all border border-transparent hover:border-laser-purple/40"
                                >
                                    <div class="text-xs text-gray-300 line-clamp-2">{{ history }}</div>
                                </button>
                            </div>
                            <button @click="showHistory = false" class="mt-3 text-xs text-gray-400 hover:text-gradient-icon">
                                <i class="fas fa-times mr-1"></i>å…³é—­å†å²
                            </button>
                        </div>

                        <div class="relative">
                            <textarea
                                v-model="getCurrentForm().prompt"
                                class="w-full bg-dark-light border border-laser-purple/40 rounded-lg p-4 pr-16 text-sm min-h-[120px] focus:outline-none focus:ring-2 focus:ring-laser-purple/60 transition-all resize-none scrollbar-thin focus:border-laser focus:shadow-laser prompt-textarea"
                                :placeholder="getPromptPlaceholder()"
                                rows="3"
                                required
                            ></textarea>
                        </div>

                        <!-- é«˜çº§é…ç½®é€‰é¡¹ -->
                        <!-- <div class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm text-gray-400 mb-2">ç§å­å€¼</label>
                                <input
                                    v-model="getCurrentForm().seed"
                                    type="number"
                                    class="w-full bg-dark-light border border-laser-purple/40 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-laser-purple/60 transition-all"
                                    placeholder="éšæœºç§å­å€¼"
                                />
                            </div> -->
                            <!-- <div>
                                <label class="block text-sm text-gray-400 mb-2">æ¨ç†é˜¶æ®µ</label>
                                <select
                                    v-model="getCurrentForm().stage"
                                    class="w-full bg-dark-light border border-laser-purple/40 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-laser-purple/60 transition-all"
                                >
                                    <option value="single_stage">å•é˜¶æ®µ</option>
                                    <option value="multi_stage">å¤šé˜¶æ®µ</option>
                                    <option value="original">åŸå§‹é˜¶æ®µ</option>
                                </select>
                            </div> -->
                        </div>

                        <div class="flex justify-between items-center mt-4">
                            <p class="text-xs text-gray-500">æœ€å¤šæ”¯æŒ500ä¸ªå­—ç¬¦</p>
                            <div class="flex space-x-2">
                                <button @click="clearPrompt" class="text-xs px-3 py-1 rounded transition-all">
                                    <i class="fas fa-sync-alt mr-1"></i>
                                    æ¸…ç©º
                                </button>
                                <button @click="submitTask" :disabled="submitting" class="btn-primary px-4 py-1 rounded transition-all">
                                    <i class="fas fa-play mr-1"></i>
                                    {{ submitting ? 'ç”Ÿæˆä¸­...' : 'ç”Ÿæˆè§†é¢‘' }}
                                </button>
                        </div>
                    </div>
                </div>


                <!-- ä»»åŠ¡è¯¦æƒ…æ˜¾ç¤ºé¢æ¿ -->
                <div v-if="selectedTask && !showCreator" class="max-w-4xl mx-auto task-detail-panel">
                    <div class="mb-6">

                        <!-- è¾“å‡ºè§†é¢‘ -->
                        <div v-if="selectedTask.status === 'SUCCEED' && selectedTask.outputs && Object.keys(selectedTask.outputs).length > 0" class="bg-secondary/30 rounded-xl p-4 mb-6 task-completed-panel">
                            <h4 class="text-sm font-medium mb-3 flex items-center">
                                <i class="fas fa-video text-gradient-icon mr-2"></i>
                                è¾“å‡ºç»“æœ
                            </h4>
                            <div class="space-y-3">
                                <div v-for="(output, key) in selectedTask.outputs" :key="key" class="flex items-center justify-between bg-dark-light rounded-lg p-3">
                                    <div class="flex items-center">
                                        <i class="fas fa-file-video text-gradient-icon mr-2"></i>
                                        <span class="text-sm">{{ output }}</span>
                                        <span v-if="selectedTaskFiles.outputs[key] && selectedTaskFiles.outputs[key].error"
                                              class="ml-2 text-xs text-red-400">
                                            <i class="fas fa-exclamation-triangle"></i> åŠ è½½å¤±è´¥
                                        </span>
                                    </div>
                                    <div class="flex space-x-2">
                                        <button v-if="selectedTaskFiles.outputs[key] && selectedTaskFiles.outputs[key].url"
                                                @click="downloadFile(selectedTaskFiles.outputs[key])"
                                                class="text-xs btn-primary px-2 py-1 rounded">
                                            <i class="fas fa-download mr-1"></i>ä¸‹è½½
                                        </button>
                                        <div v-else-if="!selectedTaskFiles.outputs[key]"
                                             class="text-xs text-gray-400 px-2 py-1">
                                            <i class="fas fa-spinner fa-spin mr-1"></i>åŠ è½½ä¸­
                                        </div>
                                    </div>
                                </div>
                            </div>
<!-- è§†é¢‘é¢„è§ˆ -->
<div class="w-full">
    <div class="relative w-full h-[400px] flex items-center justify-center rounded-xl bg-black border border-laser-purple/50 overflow-hidden">
        <div data-test-id="dragable-content" data-is-dragging="false" draggable="true" class="w-full h-full flex items-center justify-center">
            <div class="w-full flexitems-center justify-center">
                <video
                    v-if="selectedTaskFiles.outputs.output_video && selectedTaskFiles.outputs.output_video.url"
                    class="object-contain bg-black"
                    style="object-fit: contain; height: 400px; visibility: visible;"
                    controls
                    preload="metadata"
                    :src="selectedTaskFiles.outputs.output_video.url">
                    æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè§†é¢‘æ’­æ”¾ã€‚
                </video>

                <div v-else-if="selectedTaskFiles.outputs.output_video && selectedTaskFiles.outputs.output_video.error"
                    class="w-full h-full flex items-center justify-center bg-red-900/20">
                    <div class="text-center">
                        <i class="fas fa-exclamation-triangle text-red-400 text-2xl mb-2"></i>
                        <p class="text-red-400 text-sm">è§†é¢‘åŠ è½½å¤±è´¥</p>
                    </div>
                </div>

                <div v-else
                    class="w-full h-full flex items-center justify-center bg-gray-700">
                    <div class="text-center">
                        <i class="fas fa-spinner fa-spin text-gray-400 text-2xl mb-2"></i>
                        <p class="text-gray-400 text-sm">åŠ è½½è§†é¢‘ä¸­...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

                        </div>


                        <!-- ä»»åŠ¡è¿›è¡Œä¸­ä¿¡æ¯ -->
                        <div v-if="['CREATED', 'PENDING', 'RUNNING'].includes(selectedTask.status) && !showCreator" class="max-w-4xl mx-auto task-running-panel">
                            <div class="text-center py-8">
                                <div class="w-24 h-24 mx-auto bg-laser-purple/20 rounded-full flex items-center justify-center mb-6 animate-pulse-slow">
                                    <i class="fas fa-spinner fa-spin text-gradient-icon text-3xl"></i>
                                </div>
                                <h3 class="text-xl font-medium mb-2">è§†é¢‘ç”Ÿæˆä¸­</h3>
                                <p class="text-gray-400 mb-6">AIæ­£åœ¨åŠªåŠ›ç”Ÿæˆæ‚¨çš„è§†é¢‘ï¼Œè¯·ç¨å€™...</p>
                            </div>

                        </div>

                        <!-- ä»»åŠ¡å¤±è´¥ä¿¡æ¯ -->
                        <div v-if="selectedTask && selectedTask.status === 'FAILED' && !showCreator" class="max-w-4xl mx-auto task-failed-panel">
                            <div class="text-center py-8">
                                <div class="w-24 h-24 mx-auto bg-red-500/10 rounded-full flex items-center justify-center mb-6">
                                    <i class="fas fa-exclamation-triangle text-red-500 text-3xl"></i>
                                </div>
                                <h3 class="text-xl font-medium mb-2">è§†é¢‘ç”Ÿæˆå¤±è´¥</h3>
                                <p class="text-gray-400 mb-4 max-w-md mx-auto">
                                    å¾ˆæŠ±æ­‰ï¼Œæ‚¨çš„è§†é¢‘ç”Ÿæˆä»»åŠ¡æœªèƒ½å®Œæˆã€‚è¿™å¯èƒ½æ˜¯ç”±äºèµ„æºé™åˆ¶æˆ–å‚æ•°è®¾ç½®é—®é¢˜å¯¼è‡´çš„ã€‚
                                </p>
                            </div>
                        </div>

                        <!-- ä»»åŠ¡å–æ¶ˆä¿¡æ¯ -->
                        <div v-if="selectedTask && selectedTask.status === 'CANCEL' && !showCreator" class="max-w-4xl mx-auto task-cancelled-panel">
                            <div class="text-center py-8">
                                <div class="w-24 h-24 mx-auto bg-yellow-500/10 rounded-full flex items-center justify-center mb-6">
                                    <i class="fas fa-ban text-yellow-500 text-3xl"></i>
                                </div>
                                <h3 class="text-xl font-medium mb-2">ä»»åŠ¡å·²å–æ¶ˆ</h3>
                                <p class="text-gray-400 mb-4 max-w-md mx-auto">
                                    æ­¤ä»»åŠ¡å·²è¢«å–æ¶ˆï¼Œæ‚¨å¯ä»¥é‡æ–°ç”Ÿæˆæˆ–æŸ¥çœ‹ä¹‹å‰ä¸Šä¼ çš„ç´ æã€‚
                                </p>
                            </div>

                        </div>

                        <!-- ä»»åŠ¡æ“ä½œ -->
                        <div class="flex justify-center space-x-3 p-4">
                            <button v-if="['CREATED', 'PENDING', 'RUNNING'].includes(selectedTask.status)"
                                    @click="cancelTask(selectedTask.task_id)"
                                    class="px-4 py-2 btn-primary rounded-lg text-sm transition-all">
                                <i class="fas fa-times mr-2"></i>
                                å–æ¶ˆä»»åŠ¡
                            </button>
                            <button v-if="['SUCCEED', 'FAILED', 'CANCEL'].includes(selectedTask.status)"
                                    @click="resumeTask(selectedTask.task_id)"
                                    class="px-4 py-2 btn-primary rounded-lg text-sm transition-all">
                                <i class="fas fa-redo mr-2"></i>
                                é‡æ–°ç”Ÿæˆ
                            </button>
                        </div>
                        <!-- ä»»åŠ¡çŠ¶æ€æ˜¾ç¤º -->
                        <div class="bg-secondary/30 rounded-xl p-6 mb-6">
                            <h4 class="text-sm font-medium mb-3 flex items-center">
                                <i class="fas fa-info-circle text-gradient-icon mr-2"></i>
                                ä»»åŠ¡ä¿¡æ¯
                            </h4>
                            <ul class="space-y-2 text-sm">
                                <li class="flex justify-between">
                                    <span class="text-gray-400">ä»»åŠ¡ID</span>
                                    <span>{{ selectedTask.task_id }}</span>
                                </li>
                                <li class="flex justify-between">
                                    <span class="text-gray-400">ä»»åŠ¡ç±»å‹</span>
                                    <span>{{ selectedTask.task_type }}</span>
                                </li>
                                <li class="flex justify-between">
                                    <span class="text-gray-400">æ¨¡å‹åç§°</span>
                                    <span class="text-gradient-icon">{{ selectedTask.model_cls }}</span>
                                </li>
                                <li class="flex justify-between">
                                    <span class="text-gray-400">åˆ›å»ºæ—¶é—´</span>
                                    <span>{{ formatTime(selectedTask.create_t) }}</span>
                                </li>
                                <li class="flex justify-between">
                                    <span class="text-gray-400">çŠ¶æ€</span>
                                    <span :class="getStatusTextClass(selectedTask.status)">{{ selectedTask.status }}</span>
                                </li>
                            </ul>
                        </div>

                        <!-- æç¤ºè¯ -->
                        <div class="bg-secondary/30 rounded-xl p-4 mb-6">
                            <h4 class="text-sm font-medium mb-3 flex items-center">
                                <i class="fas fa-file-alt text-gradient-icon mr-2"></i>
                                æç¤ºè¯
                            </h4>
                            <div class="bg-dark-light rounded-lg p-4 text-sm text-gray-300">
                                <p>{{ selectedTask.params.prompt || 'æ— æç¤ºè¯' }}</p>
                            </div>
                        </div>

                        <div v-if="selectedTask.inputs && Object.keys(selectedTask.inputs).length" class="bg-secondary/30 rounded-xl p-4 mb-6">
                            <h4 class="text-sm font-medium mb-3 flex items-center">
                                <i class="fas fa-upload text-gradient-icon mr-2"></i>
                                ä¸Šä¼ ç´ æ
                                <span v-if="loadingTaskFiles" class="ml-2 text-xs text-gray-400">(åŠ è½½ä¸­...)</span>
                            </h4>
                            <div class="space-y-3">
                                <template v-for="(input, key) in selectedTask.inputs" :key="key">
                                    <div class="flex items-center gap-3">
                                        <template v-if="key.includes('image')">
                                            <i class="fas fa-image text-gradient-icon text-xl"></i>
                                            <div class="flex items-center gap-2">
                                                <span v-if="!selectedTaskFiles.inputs[key] || !selectedTaskFiles.inputs[key].url"
                                                      class="text-gray-400 text-sm">{{ typeof input === 'string' ? input : 'å›¾ç‰‡' }}</span>
                                                <div class="flex items-center gap-2 relative group">
                                                    <img v-if="selectedTaskFiles.inputs[key] && selectedTaskFiles.inputs[key].url"
                                                         :src="selectedTaskFiles.inputs[key].url"
                                                         :alt="input"
                                                         class="w-20 h-20 object-cover rounded bg-dark-light border border-gray-700">
                                                    <div v-else-if="selectedTaskFiles.inputs[key] && selectedTaskFiles.inputs[key].error"
                                                         class="w-20 h-20 rounded bg-red-900/20 border border-red-500/30 flex items-center justify-center">
                                                        <i class="fas fa-exclamation-triangle text-red-400"></i>
                                                    </div>
                                                    <div v-else
                                                         class="w-20 h-20 rounded bg-gray-700 border border-gray-600 flex items-center justify-center">
                                                        <i class="fas fa-spinner fa-spin text-gray-400"></i>
                                                    </div>
                                                    <button v-if="selectedTaskFiles.inputs[key] && selectedTaskFiles.inputs[key].url"
                                                            @click="downloadFile(selectedTaskFiles.inputs[key])"
                                                            class="text-xs px-2 py-1 rounded">
                                                        <i class="fas fa-download mr-1 text-white opacity-30 hover:opacity-100 transition-opacity"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </template>
                                        <template v-else-if="key.includes('audio')">
                                            <i class="fas fa-microphone text-gradient-icon text-xl"></i>
                                            <div class="flex items-center gap-2">
                                                <span v-if="!selectedTaskFiles.inputs[key] || !selectedTaskFiles.inputs[key].url"
                                                      class="text-gray-400 text-sm">{{ typeof input === 'string' ? input : 'éŸ³é¢‘æ–‡ä»¶' }}</span>
                                                <div class="flex items-center gap-2">
                                                    <audio v-if="selectedTaskFiles.inputs[key] && selectedTaskFiles.inputs[key].url"
                                                           :src="selectedTaskFiles.inputs[key].url"
                                                           controls
                                                           class="h-8 text-gradient-icon">
                                                        æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒéŸ³é¢‘æ’­æ”¾
                                                    </audio>
                                                    <div v-else-if="selectedTaskFiles.inputs[key] && selectedTaskFiles.inputs[key].error"
                                                         class="h-8 px-3 rounded bg-red-900/20 border border-red-500/30 flex items-center">
                                                        <i class="fas fa-exclamation-triangle text-red-400 text-xs"></i>
                                                    </div>
                                                    <div v-else
                                                         class="h-8 px-3 rounded bg-gray-700 border border-gray-600 flex items-center">
                                                        <i class="fas fa-spinner fa-spin text-gray-400 text-xs"></i>
                                                    </div>
                                                    <button v-if="selectedTaskFiles.inputs[key] && selectedTaskFiles.inputs[key].url"
                                                            @click="downloadFile(selectedTaskFiles.inputs[key])"
                                                            class="text-xs px-2 py-1 rounded">
                                                        <i class="fas fa-download mr-1 text-white opacity-30 hover:opacity-100 transition-opacity"></i>
                                                    </button>
                                                </div>
                                            </div>
                        </div>
                                        </template>
                            </div>
                                </template>
                            </div>
                        </div>

                        </div>
                    </div>
                </div>


        <!-- åŠ è½½æŒ‡ç¤ºå™¨ -->
        <div v-if="loading" class="loading position-fixed top-50 start-50 translate-middle show">
            <div class="spinner-border text-gradient-icon" role="status">
                <span class="visually-hidden">åŠ è½½ä¸­...</span>
            </div>
        </div>

        <!-- å¢å¼ºçš„æç¤ºæ¶ˆæ¯ç³»ç»Ÿ -->
        <div v-cloak>
            <div v-if="alert.show"
                class="fixed top-3 left-1/2 transform -translate-x-1/2 z-50 max-w-[16rem] w-full px-1"
                :class="getAlertClass(alert.type)">
                <div class="alert flex items-center p-2 rounded-md shadow-md border-l-4 transition-all duration-300 ease-out"
                    :class="getAlertBorderClass(alert.type)">
                    <div class="flex-shrink-0 mr-1">
                        <i :class="getAlertIcon(alert.type)" class="text-base"></i>
                    </div>
                    <div class="flex-1">
                        <p class="text-xs font-medium" :class="getAlertTextClass(alert.type)">
                            {{ alert.message }}
                        </p>
                    </div>
                    <div class="flex-shrink-0 ml-1">
                        <button @click="alert.show = false"
                                class="text-gray-400 hover:text-gray-600 transition-colors">
                            <i class="fas fa-times text-xs"></i>
                        </button>
                    </div>
                </div>
            </div>
    </div>
    </div>


    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

    <script>
        // æ£€æµ‹Font Awesomeå›¾æ ‡æ˜¯å¦åŠ è½½æˆåŠŸ
        function checkFontAwesome() {
            const testIcon = document.createElement('i');
            testIcon.className = 'fas fa-check';
            testIcon.style.position = 'absolute';
            testIcon.style.left = '-9999px';
            document.body.appendChild(testIcon);

            const computedStyle = window.getComputedStyle(testIcon, ':before');
            const content = computedStyle.getPropertyValue('content');

            document.body.removeChild(testIcon);

            // å¦‚æœå›¾æ ‡æ²¡æœ‰æ­£ç¡®æ˜¾ç¤ºï¼Œä½¿ç”¨å¤‡ç”¨æ–¹æ¡ˆ
            if (!content || content === 'none' || content === 'normal') {
                console.warn('Font Awesome å›¾æ ‡åŠ è½½å¤±è´¥ï¼Œä½¿ç”¨å¤‡ç”¨æ–¹æ¡ˆ');
                replaceIconsWithFallback();
            }
        }

        // ä½¿ç”¨å¤‡ç”¨å›¾æ ‡æ›¿æ¢å¤±è´¥çš„å›¾æ ‡
        function replaceIconsWithFallback() {
            const iconMap = {
                'fas fa-video': 'ğŸ¥',
                'fas fa-plus': 'â•',
                'fas fa-search': 'ğŸ”',
                'fas fa-clock': 'â°',
                'fas fa-bars': 'â˜°',
                'fas fa-sign-out-alt': 'ğŸšª',
                'fas fa-star': 'â­',
                'fas fa-cloud-upload-alt': 'â˜ï¸',
                'fas fa-microphone': 'ğŸ¤',
                'fas fa-magic': 'âœ¨',
                'fas fa-history': 'ğŸ“š',
                'fas fa-times': 'âœ–ï¸',
                'fas fa-trash': 'ğŸ—‘ï¸',
                'fas fa-sync-alt': 'ğŸ”„',
                'fas fa-play': 'â–¶ï¸',
                'fas fa-share-alt': 'ğŸ“¤',
                'fas fa-download': 'â¬‡ï¸',
                'fas fa-info-circle': 'â„¹ï¸',
                'fas fa-file-alt': 'ğŸ“„',
                'fas fa-file-video': 'ğŸ¬',
                'fas fa-eye': 'ğŸ‘ï¸',
                'fas fa-exclamation-triangle': 'âš ï¸',
                'fas fa-lightbulb': 'ğŸ’¡',
                'fas fa-check': 'âœ…',
                'fas fa-user': 'ğŸ‘¤',
                'fas fa-image': 'ğŸ–¼ï¸',
                'fas fa-font': 'ğŸ”¤',
                'fas fa-spinner': 'ğŸŒ€',
                'fas fa-check-circle': 'âœ…',
                'fas fa-hourglass-half': 'â³',
                'fas fa-ban': 'ğŸš«',
                'fas fa-question-circle': 'â“',
                'fas fa-times-circle': 'âŒ',
                'fas fa-music': 'ğŸµ',
                'fas fa-tags': 'ğŸ·ï¸',
                'fas fa-chart-bar': 'ğŸ“Š',
                'fas fa-redo': 'ğŸ”„',
                'fas fa-pause': 'â¸ï¸'
            };

            // æ›¿æ¢æ‰€æœ‰å›¾æ ‡
            Object.keys(iconMap).forEach(iconClass => {
                const icons = document.querySelectorAll(`.${iconClass.replace(/\s+/g, '.')}`);
                icons.forEach(icon => {
                    icon.innerHTML = iconMap[iconClass];
                    icon.className = icon.className.replace(/fas fa-[a-z-]+/g, '');
                });
            });
        }

        // é¡µé¢åŠ è½½å®Œæˆåæ£€æŸ¥å›¾æ ‡
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(checkFontAwesome, 1000); // å»¶è¿Ÿ1ç§’æ£€æŸ¥ï¼Œç¡®ä¿CDNåŠ è½½å®Œæˆ
        });
    </script>

    <script>
        const { createApp, ref, computed, onMounted, watch } = Vue;

        createApp({
            setup() {
                // å“åº”å¼æ•°æ®
                const loading = ref(false);
                const alert = ref({ show: false, message: '', type: 'info' });
                const submitting = ref(false);
                const showCreator = ref(true);
                const searchQuery = ref('');
                const generatingThumbnails = ref(false);
                const sidebarCollapsed = ref(false);

                const thumbnailCache = ref(new Map());
                const thumbnailCacheLoaded = ref(false);

                const imageTemplates = ref([]);
                const audioTemplates = ref([]);
                const showImageTemplates = ref(false);
                const showAudioTemplates = ref(false);
                const currentUser = ref({});
                const models = ref([]);
                const tasks = ref([]);
                const isLoggedIn = ref(false);

                const selectedTaskId = ref(null);
                const selectedTask = ref(null);
                const selectedTaskFiles = ref({ inputs: {}, outputs: {} }); // å­˜å‚¨ä»»åŠ¡çš„è¾“å…¥è¾“å‡ºæ–‡ä»¶
                const loadingTaskFiles = ref(false); // åŠ è½½ä»»åŠ¡æ–‡ä»¶çš„çŠ¶æ€
                const statusFilter = ref('ALL');
                const pagination = ref(null);
                const currentPage = ref(1);
                const pageSize = ref(10);

                // ä¸ºä¸‰ä¸ªä»»åŠ¡ç±»å‹åˆ†åˆ«åˆ›å»ºç‹¬ç«‹çš„è¡¨å•
                const t2vForm = ref({
                    task: 't2v',
                    model_cls: '',
                    stage: 'single_stage',
                    prompt: '',
                    seed: 42
                });

                const i2vForm = ref({
                    task: 'i2v',
                    model_cls: '',
                    stage: 'multi_stage',
                    imageFile: null,
                    prompt: '',
                    seed: 42
                });

                const digitalHumanForm = ref({
                    task: 'digital_human',
                    model_cls: '',
                    stage: 'single_stage',
                    imageFile: null,
                    audioFile: null,
                    prompt: '',
                    seed: 42
                });

                // æ ¹æ®å½“å‰é€‰æ‹©çš„ä»»åŠ¡ç±»å‹è·å–å¯¹åº”çš„è¡¨å•
                const getCurrentForm = () => {
                    switch (selectedTaskId.value) {
                        case 't2v':
                            return t2vForm.value;
                        case 'i2v':
                            return i2vForm.value;
                        case 'digital_human':
                            return digitalHumanForm.value;
                        default:
                            return t2vForm.value;
                    }
                };

                // ä¸ºæ¯ä¸ªä»»åŠ¡ç±»å‹åˆ›å»ºç‹¬ç«‹çš„é¢„è§ˆå˜é‡
                const i2vImagePreview = ref(null);
                const digitalHumanImagePreview = ref(null);
                const digitalHumanAudioPreview = ref(null);

                // æ ¹æ®å½“å‰ä»»åŠ¡ç±»å‹è·å–å¯¹åº”çš„é¢„è§ˆå˜é‡
                const getCurrentImagePreview = () => {
                    switch (selectedTaskId.value) {
                        case 't2v':
                            return null;
                        case 'i2v':
                            return i2vImagePreview.value;
                        case 'digital_human':
                            return digitalHumanImagePreview.value;
                        default:
                            return null;
                    }
                };

                const getCurrentAudioPreview = () => {
                    switch (selectedTaskId.value) {
                        case 't2v':
                            return null
                        case 'i2v':
                            return null
                        case 'digital_human':
                            return digitalHumanAudioPreview.value;
                        default:
                            return null;
                    }
                };

                const setCurrentImagePreview = (value) => {
                    switch (selectedTaskId.value) {
                        case 't2v':
                            break;
                        case 'i2v':
                            i2vImagePreview.value = value;
                            break;
                        case 'digital_human':
                            digitalHumanImagePreview.value = value;
                            break;
                    }
                };

                const setCurrentAudioPreview = (value) => {
                    switch (selectedTaskId.value) {
                        case 't2v':
                            break;
                        case 'i2v':
                            break;
                        case 'digital_human':
                            digitalHumanAudioPreview.value = value;
                            break;
                    }
                };

                // æç¤ºè¯æ¨¡æ¿ç›¸å…³
                const showTemplates = ref(false);
                const showHistory = ref(false);

                // è®¡ç®—å±æ€§
                const availableTaskTypes = computed(() => {
                    const types = [...new Set(models.value.map(m => m.task))];
                    // é‡æ–°æ’åºï¼Œç¡®ä¿æ•°å­—äººåœ¨æœ€å·¦è¾¹
                    const orderedTypes = [];

                    // æ£€æŸ¥æ˜¯å¦æœ‰åŒ…å«audioæˆ–sekoçš„i2væ¨¡å‹ï¼Œå¦‚æœæœ‰åˆ™æ·»åŠ digital_humanç±»å‹
                    const hasDigitalHumanModels = models.value.some(m =>
                        m.task === 'i2v' && (m.model_cls.toLowerCase().includes('audio') || m.model_cls.toLowerCase().includes('seko'))
                    );

                    // ä¼˜å…ˆæ·»åŠ æ•°å­—äººï¼ˆå¦‚æœå­˜åœ¨ç›¸å…³æ¨¡å‹ï¼‰
                    if (hasDigitalHumanModels) {
                        orderedTypes.push('digital_human');
                    }

                    // ç„¶åæ·»åŠ å…¶ä»–ç±»å‹
                    types.forEach(type => {
                        if (type !== 'digital_human') {
                            orderedTypes.push(type);
                        }
                    });

                    return orderedTypes;
                });

                const availableModelClasses = computed(() => {
                    if (!selectedTaskId.value) return [];

                    // å¦‚æœæ˜¯æ•°å­—äººä»»åŠ¡ç±»å‹ï¼Œæ˜¾ç¤ºåŒ…å«audioæˆ–sekoçš„i2væ¨¡å‹
                    if (selectedTaskId.value === 'digital_human') {
                        return [...new Set(models.value
                            .filter(m => m.task === 'i2v' && (m.model_cls.toLowerCase().includes('audio') || m.model_cls.toLowerCase().includes('seko')))
                            .map(m => m.model_cls))];
                    }

                    // å¦‚æœæ˜¯i2vä»»åŠ¡ç±»å‹ï¼Œå‰”é™¤åŒ…å«audioæˆ–sekoçš„æ¨¡å‹
                    if (selectedTaskId.value === 'i2v') {
                        return [...new Set(models.value
                            .filter(m => m.task === 'i2v' && !m.model_cls.toLowerCase().includes('audio') && !m.model_cls.toLowerCase().includes('seko'))
                            .map(m => m.model_cls))];
                    }

                    // å…¶ä»–ä»»åŠ¡ç±»å‹æ­£å¸¸å¤„ç†
                    return [...new Set(models.value
                        .filter(m => m.task === selectedTaskId.value)
                        .map(m => m.model_cls))];
                });

                const filteredTasks = computed(() => {
                    let filtered = tasks.value;

                    // çŠ¶æ€è¿‡æ»¤
                    if (statusFilter.value !== 'ALL') {
                        filtered = filtered.filter(task => task.status === statusFilter.value);
                    }

                    // æœç´¢è¿‡æ»¤
                    if (searchQuery.value) {
                        filtered = filtered.filter(task =>
                        task.params.prompt?.toLowerCase().includes(searchQuery.value.toLowerCase()) ||
                        task.task_id.toLowerCase().includes(searchQuery.value.toLowerCase()) ||
                        task.task_type.toLowerCase().includes(searchQuery.value.toLowerCase())
                    );
                    }

                    // æŒ‰æ—¶é—´æ’åºï¼Œæœ€æ–°çš„ä»»åŠ¡åœ¨å‰é¢
                    filtered = filtered.sort((a, b) => {
                        const timeA = parseInt(a.create_t) || 0;
                        const timeB = parseInt(b.create_t) || 0;
                        return timeB - timeA; // é™åºæ’åˆ—ï¼Œæœ€æ–°çš„åœ¨å‰
                    });

                    return filtered;
                });

                // æ–¹æ³•
                const showAlert = (message, type = 'info') => {
                    alert.value = { show: true, message, type };
                    setTimeout(() => {
                        alert.value.show = false;
                    }, 5000);
                };

                const setLoading = (value) => {
                    loading.value = value;
                };

                const apiCall = async (endpoint, options = {}) => {
                    const url = `${endpoint}`;
                    const headers = {
                        'Content-Type': 'application/json',
                        ...options.headers
                    };

                    if (localStorage.getItem('accessToken')) {
                        headers['Authorization'] = `Bearer ${localStorage.getItem('accessToken')}`;
                    }

                    const response = await fetch(url, {
                        ...options,
                        headers
                    });

                    if (response.status === 401) {
                        logout();
                        throw new Error('è®¤è¯å¤±è´¥ï¼Œè¯·é‡æ–°ç™»å½•'); }
                    if (response.status === 400) {
                        const error = await response.json();
                        showAlert(error.message, 'danger');
                        throw new Error(error.message);
                    }

                    // æ·»åŠ 50mså»¶è¿Ÿï¼Œé˜²æ­¢è§¦å‘æœåŠ¡ç«¯é¢‘ç‡é™åˆ¶
                    await new Promise(resolve => setTimeout(resolve, 50));

                    return response;
                };

                const loginWithGitHub = async () => {
                    try {
                        setLoading(true);
                        const response = await fetch('./auth/login/github');
                        const data = await response.json();
                        window.location.href = data.auth_url;
                    } catch (error) {
                        showAlert('è·å–GitHubè®¤è¯URLå¤±è´¥', 'danger');
                    } finally {
                        setLoading(false);
                    }
                };

                const handleGitHubCallback = async (code) => {
                    try {
                        setLoading(true);
                        const response = await fetch(`./auth/callback/github?code=${code}`);
                        if (response.ok) {
                            const data = await response.json();
                            console.log(data);
                            localStorage.setItem('accessToken', data.access_token);
                            localStorage.setItem('currentUser', JSON.stringify(data.user_info));
                            currentUser.value = data.user_info;
                            isLoggedIn.value = true;
                        } else {
                            const error = await response.json();
                            showAlert(`ç™»å½•å¤±è´¥: ${error.detail}`, 'danger');
                        }
                        window.location.href = '/';
                    } catch (error) {
                        showAlert('ç™»å½•è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯', 'danger');
                        console.error(error);
                    } finally {
                        setLoading(false);
                    }
                };



                const logout = () => {
                    localStorage.removeItem('accessToken');
                    localStorage.removeItem('currentUser');
                    currentUser.value = {};
                    isLoggedIn.value = false;
                    models.value = [];
                    tasks.value = [];
                    showAlert('å·²é€€å‡ºç™»å½•', 'info');
                };

                const loadModels = async () => {
                    try {
                        console.log('å¼€å§‹åŠ è½½æ¨¡å‹åˆ—è¡¨...');
                        const response = await apiRequest('./api/v1/model/list');
                        if (response && response.ok) {
                            const data = await response.json();
                            console.log('æ¨¡å‹åˆ—è¡¨æ•°æ®:', data);
                            models.value = data.models || [];
                            console.log('è®¾ç½®åçš„models.value:', models.value);
                        } else if (response) {
                            console.error('æ¨¡å‹åˆ—è¡¨APIå“åº”å¤±è´¥:', response);
                            showAlert('åŠ è½½æ¨¡å‹åˆ—è¡¨å¤±è´¥', 'danger');
                        }
                        // å¦‚æœresponseä¸ºnullï¼Œè¯´æ˜æ˜¯è®¤è¯é”™è¯¯ï¼ŒapiRequestå·²ç»å¤„ç†äº†
                    } catch (error) {
                        console.error('åŠ è½½æ¨¡å‹å¤±è´¥:', error);
                        showAlert(`åŠ è½½æ¨¡å‹å¤±è´¥: ${error.message}`, 'danger');
                    }
                };

                // åŠ è½½æ¨¡æ¿æ–‡ä»¶
                const loadTemplates = async () => {
                    try {
                        const response = await apiCall('./api/v1/template/list');
                        if (response.ok) {
                            const data = await response.json();
                            imageTemplates.value = data.templates.images || [];
                            audioTemplates.value = data.templates.audios || [];
                        } else {
                            console.warn('åŠ è½½æ¨¡æ¿å¤±è´¥');
                        }
                    } catch (error) {
                        console.warn('åŠ è½½æ¨¡æ¿å¤±è´¥:', error);
                    }
                };

                // é€‰æ‹©å›¾ç‰‡æ¨¡æ¿
                const selectImageTemplate = async (template) => {
                    try {
                        const response = await fetch(template.url);
                        if (response.ok) {
                            const blob = await response.blob();
                            const file = new File([blob], template.filename, { type: blob.type });

                            if (selectedTaskId.value === 'i2v') {
                                i2vForm.value.imageFile = file;
                            } else if (selectedTaskId.value === 'digital_human') {
                                digitalHumanForm.value.imageFile = file;
                            }

                            // åˆ›å»ºé¢„è§ˆ
                            const reader = new FileReader();
                            reader.onload = (e) => {
                                setCurrentImagePreview(e.target.result);
                            };
                            reader.readAsDataURL(file);

                            showImageTemplates.value = false;
                            showAlert('å›¾ç‰‡æ¨¡æ¿å·²é€‰æ‹©', 'success');
                        } else {
                            showAlert('åŠ è½½å›¾ç‰‡æ¨¡æ¿å¤±è´¥', 'danger');
                        }
                    } catch (error) {
                        showAlert(`åŠ è½½å›¾ç‰‡æ¨¡æ¿å¤±è´¥: ${error.message}`, 'danger');
                    }
                };

                // é€‰æ‹©éŸ³é¢‘æ¨¡æ¿
                const selectAudioTemplate = async (template) => {
                    try {
                        const response = await fetch(template.url);
                        if (response.ok) {
                            const blob = await response.blob();
                            const file = new File([blob], template.filename, { type: blob.type });

                            digitalHumanForm.value.audioFile = file;

                            // åˆ›å»ºé¢„è§ˆ
                            const reader = new FileReader();
                            reader.onload = (e) => {
                                setCurrentAudioPreview(e.target.result);
                            };
                            reader.readAsDataURL(file);

                            showAudioTemplates.value = false;
                            showAlert('éŸ³é¢‘æ¨¡æ¿å·²é€‰æ‹©', 'success');
                        } else {
                            showAlert('åŠ è½½éŸ³é¢‘æ¨¡æ¿å¤±è´¥', 'danger');
                        }
                    } catch (error) {
                        showAlert(`åŠ è½½éŸ³é¢‘æ¨¡æ¿å¤±è´¥: ${error.message}`, 'danger');
                    }
                };

                // é¢„è§ˆéŸ³é¢‘æ¨¡æ¿
                const previewAudioTemplate = (template) => {
                    const audio = new Audio(template.url);
                    audio.play().catch(error => {
                        console.error('éŸ³é¢‘æ’­æ”¾å¤±è´¥:', error);
                        showAlert('éŸ³é¢‘æ’­æ”¾å¤±è´¥', 'danger');
                    });
                };

                const handleImageUpload = (event) => {
                    const file = event.target.files[0];
                    if (file) {
                        if (selectedTaskId.value === 'i2v') {
                            i2vForm.value.imageFile = file;
                        } else if (selectedTaskId.value === 'digital_human') {
                            digitalHumanForm.value.imageFile = file;
                        }
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            setCurrentImagePreview(e.target.result);
                        };
                        reader.readAsDataURL(file);
                    } else {
                        // ç”¨æˆ·å–æ¶ˆäº†é€‰æ‹©ï¼Œä¿æŒåŸæœ‰å›¾ç‰‡ä¸å˜
                        // ä¸åšä»»ä½•æ“ä½œ
                    }
                };

                const selectTask = (taskType) => {
                    selectedTaskId.value = taskType;

                    // æ ¹æ®ä»»åŠ¡ç±»å‹æ¢å¤å¯¹åº”çš„é¢„è§ˆ
                    if (taskType === 'i2v' && i2vForm.value.imageFile) {
                        // æ¢å¤å›¾ç‰‡é¢„è§ˆ
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            setCurrentImagePreview(e.target.result);
                        };
                        reader.readAsDataURL(i2vForm.value.imageFile);
                    } else if (taskType === 'digital_human') {
                        // æ¢å¤æ•°å­—äººä»»åŠ¡çš„å›¾ç‰‡å’ŒéŸ³é¢‘é¢„è§ˆ
                        if (digitalHumanForm.value.imageFile) {
                            const reader = new FileReader();
                            reader.onload = (e) => {
                                setCurrentImagePreview(e.target.result);
                            };
                            reader.readAsDataURL(digitalHumanForm.value.imageFile);
                        }
                        if (digitalHumanForm.value.audioFile) {
                            const reader = new FileReader();
                            reader.onload = (e) => {
                                setCurrentAudioPreview(e.target.result);
                            };
                            reader.readAsDataURL(digitalHumanForm.value.audioFile);
                        }
                    }

                    // å¦‚æœå½“å‰è¡¨å•æ²¡æœ‰é€‰æ‹©æ¨¡å‹ï¼Œè‡ªåŠ¨é€‰æ‹©ç¬¬ä¸€ä¸ªå¯ç”¨çš„æ¨¡å‹
                    const currentForm = getCurrentForm();
                    if (!currentForm.model_cls) {
                    const availableModels = models.value.filter(m => m.task === taskType);
                    if (availableModels.length > 0) {
                        const firstModel = availableModels[0];
                            currentForm.model_cls = firstModel.model_cls;
                            currentForm.stage = firstModel.stage;
                        }
                    }
                };

                const selectModel = (model) => {
                    getCurrentForm().model_cls = model;
                };

                const triggerImageUpload = () => {
                    document.querySelector('input[type="file"][accept="image/*"]').click();
                };

                const triggerAudioUpload = () => {
                    document.querySelector('input[type="file"][accept="audio/*"]').click();
                };

                const removeImage = () => {
                    setCurrentImagePreview(null);
                    if (selectedTaskId.value === 'i2v') {
                        i2vForm.value.imageFile = null;
                    } else if (selectedTaskId.value === 'digital_human') {
                        digitalHumanForm.value.imageFile = null;
                    }
                    // é‡ç½®æ–‡ä»¶è¾“å…¥æ¡†ï¼Œç¡®ä¿å¯ä»¥é‡æ–°é€‰æ‹©ç›¸åŒæ–‡ä»¶
                    const imageInput = document.querySelector('input[type="file"][accept="image/*"]');
                    if (imageInput) {
                        imageInput.value = '';
                    }
                };

                const removeAudio = () => {
                    setCurrentAudioPreview(null);
                    digitalHumanForm.value.audioFile = null;
                    console.log('éŸ³é¢‘å·²ç§»é™¤');
                    // é‡ç½®éŸ³é¢‘æ–‡ä»¶è¾“å…¥æ¡†ï¼Œç¡®ä¿å¯ä»¥é‡æ–°é€‰æ‹©ç›¸åŒæ–‡ä»¶
                    const audioInput = document.querySelector('input[type="file"][accept="audio/*"]');
                    if (audioInput) {
                        audioInput.value = '';
                    }
                };

                const getAudioMimeType = () => {
                    if (digitalHumanForm.value.audioFile) {
                        console.log('éŸ³é¢‘æ–‡ä»¶ç±»å‹:', digitalHumanForm.value.audioFile.type);
                        return digitalHumanForm.value.audioFile.type;
                    }
                    console.log('ä½¿ç”¨é»˜è®¤éŸ³é¢‘ç±»å‹: audio/mpeg');
                    return 'audio/mpeg'; // é»˜è®¤ç±»å‹
                };

                const handleAudioUpload = (event) => {
                    const file = event.target.files[0];

                    if (file) {
                        digitalHumanForm.value.audioFile = file;
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            setCurrentAudioPreview(e.target.result);
                            console.log('éŸ³é¢‘é¢„è§ˆå·²è®¾ç½®:', e.target.result);
                        };
                        reader.readAsDataURL(file);
                    } else {
                        setCurrentAudioPreview(null);
                    }
                };

                const submitTask = async () => {
                    try {
                        const currentForm = getCurrentForm();

                        // è¡¨å•éªŒè¯
                        if (!selectedTaskId.value) {
                            showAlert('è¯·é€‰æ‹©ä»»åŠ¡ç±»å‹', 'warning');
                            return;
                        }

                        if (!currentForm.model_cls) {
                            showAlert('è¯·é€‰æ‹©æ¨¡å‹', 'warning');
                            return;
                        }

                        if (!currentForm.prompt || currentForm.prompt.trim().length === 0) {
                            showAlert('è¯·è¾“å…¥æç¤ºè¯', 'warning');
                            return;
                        }

                        if (currentForm.prompt.length > 500) {
                            showAlert('æç¤ºè¯é•¿åº¦ä¸èƒ½è¶…è¿‡500ä¸ªå­—ç¬¦', 'warning');
                            return;
                        }

                        if (selectedTaskId.value === 'i2v' && !currentForm.imageFile) {
                            showAlert('å›¾ç”Ÿè§†é¢‘ä»»åŠ¡éœ€è¦ä¸Šä¼ å‚è€ƒå›¾ç‰‡', 'warning');
                            return;
                        }

                        if (selectedTaskId.value === 'digital_human' && !currentForm.imageFile) {
                            showAlert('æ•°å­—äººä»»åŠ¡éœ€è¦ä¸Šä¼ å‚è€ƒå›¾ç‰‡', 'warning');
                            return;
                        }

                        if (selectedTaskId.value === 'digital_human' && !currentForm.audioFile) {
                            showAlert('æ•°å­—äººä»»åŠ¡éœ€è¦ä¸Šä¼ éŸ³é¢‘æ–‡ä»¶', 'warning');
                            return;
                        }

                        setLoading(true);
                        submitting.value = true;

                        // ç¡®å®šå®é™…æäº¤çš„ä»»åŠ¡ç±»å‹
                        let actualTaskType = selectedTaskId.value;
                        if (selectedTaskId.value === 'digital_human') {
                            actualTaskType = 'i2v'; // æ•°å­—äººä»»åŠ¡å®é™…æäº¤ä¸ºi2v
                        }

                        var formData = {
                            task: actualTaskType,
                            model_cls: currentForm.model_cls,
                            stage: currentForm.stage,
                            prompt: currentForm.prompt.trim(),
                            seed: currentForm.seed || Math.floor(Math.random() * 1000000)
                        };

                        if (currentForm.model_cls.startsWith('wan2.1')) {
                            formData.negative_prompt = "é•œå¤´æ™ƒåŠ¨ï¼Œè‰²è°ƒè‰³ä¸½ï¼Œè¿‡æ›ï¼Œé™æ€ï¼Œç»†èŠ‚æ¨¡ç³Šä¸æ¸…ï¼Œå­—å¹•ï¼Œé£æ ¼ï¼Œä½œå“ï¼Œç”»ä½œï¼Œç”»é¢ï¼Œé™æ­¢ï¼Œæ•´ä½“å‘ç°ï¼Œæœ€å·®è´¨é‡ï¼Œä½è´¨é‡ï¼ŒJPEGå‹ç¼©æ®‹ç•™ï¼Œä¸‘é™‹çš„ï¼Œæ®‹ç¼ºçš„ï¼Œå¤šä½™çš„æ‰‹æŒ‡ï¼Œç”»å¾—ä¸å¥½çš„æ‰‹éƒ¨ï¼Œç”»å¾—ä¸å¥½çš„è„¸éƒ¨ï¼Œç•¸å½¢çš„ï¼Œæ¯å®¹çš„ï¼Œå½¢æ€ç•¸å½¢çš„è‚¢ä½“ï¼Œæ‰‹æŒ‡èåˆï¼Œé™æ­¢ä¸åŠ¨çš„ç”»é¢ï¼Œæ‚ä¹±çš„èƒŒæ™¯ï¼Œä¸‰æ¡è…¿ï¼ŒèƒŒæ™¯äººå¾ˆå¤šï¼Œå€’ç€èµ°"
                        }

                        if (selectedTaskId.value === 'i2v' && currentForm.imageFile) {
                            const base64 = await fileToBase64(currentForm.imageFile);
                            formData.input_image = {
                                type: 'base64',
                                data: base64
                            };
                        }

                        if (selectedTaskId.value === 'digital_human') {
                            if (currentForm.imageFile) {
                                const base64 = await fileToBase64(currentForm.imageFile);
                                formData.input_image = {
                                    type: 'base64',
                                    data: base64
                                };
                            }
                            if (currentForm.audioFile) {
                                const base64 = await fileToBase64(currentForm.audioFile);
                                formData.input_audio = {
                                    type: 'base64',
                                    data: base64
                                };
                                formData.negative_prompt = "è‰²è°ƒè‰³ä¸½ï¼Œè¿‡æ›ï¼Œé™æ€ï¼Œç»†èŠ‚æ¨¡ç³Šä¸æ¸…ï¼Œå­—å¹•ï¼Œé£æ ¼ï¼Œä½œå“ï¼Œç”»ä½œï¼Œç”»é¢ï¼Œé™æ­¢ï¼Œæ•´ä½“å‘ç°ï¼Œæœ€å·®è´¨é‡ï¼Œä½è´¨é‡ï¼ŒJPEGå‹ç¼©æ®‹ç•™ï¼Œä¸‘é™‹çš„ï¼Œæ®‹ç¼ºçš„ï¼Œå¤šä½™çš„æ‰‹æŒ‡ï¼Œç”»å¾—ä¸å¥½çš„æ‰‹éƒ¨ï¼Œç”»å¾—ä¸å¥½çš„è„¸éƒ¨ï¼Œç•¸å½¢çš„ï¼Œæ¯å®¹çš„ï¼Œå½¢æ€ç•¸å½¢çš„è‚¢ä½“ï¼Œæ‰‹æŒ‡èåˆï¼Œé™æ­¢ä¸åŠ¨çš„ç”»é¢ï¼Œæ‚ä¹±çš„èƒŒæ™¯ï¼Œä¸‰æ¡è…¿ï¼ŒèƒŒæ™¯äººå¾ˆå¤šï¼Œå€’ç€èµ°"
                            }
                        }

                        const response = await apiRequest('./api/v1/task/submit', {
                            method: 'POST',
                            body: JSON.stringify(formData)
                        });

                        if (response && response.ok) {
                            const result = await response.json();
                            showAlert(`ä»»åŠ¡æäº¤æˆåŠŸï¼ä»»åŠ¡ID: ${result.task_id}`, 'success');

                            // ä¿å­˜æç¤ºè¯åˆ°å†å²è®°å½•
                            addPromptToHistory(currentForm.prompt);

                            await refreshTasks();
                            showCreator.value = true;

                            // é‡æ–°é€‰æ‹©æ•°å­—äººä»»åŠ¡ï¼ˆå¦‚æœå¯ç”¨ï¼‰
                            if (availableTaskTypes.value.includes('digital_human')) {
                                selectTask('digital_human');
                            }

                            // é‡ç½®æ‰€æœ‰è¡¨å•
                            t2vForm.value = {
                                task: 't2v',
                                model_cls: '',
                                stage: 'single_stage',
                                prompt: '',
                                seed: Math.floor(Math.random() * 1000000)
                            };
                            i2vForm.value = {
                                task: 'i2v',
                                model_cls: '',
                                stage: 'multi_stage',
                                imageFile: null,
                                prompt: '',
                                seed: 42
                            };
                            digitalHumanForm.value = {
                                task: 'digital_human',
                                model_cls: '',
                                stage: 'single_stage',
                                imageFile: null,
                                audioFile: null,
                                prompt: '',
                                seed: Math.floor(Math.random() * 1000000)
                            };
                            // é‡ç½®æ‰€æœ‰é¢„è§ˆ
                            i2vImagePreview.value = null;
                            digitalHumanImagePreview.value = null;
                            digitalHumanAudioPreview.value = null;
                        } else {
                            const error = await response.json();
                            showAlert(`ä»»åŠ¡æäº¤å¤±è´¥: ${error.message},${error.detail}`, 'danger');
                        }
                    } catch (error) {
                        showAlert(`æäº¤ä»»åŠ¡å¤±è´¥: ${error.message}`, 'danger');
                    } finally {
                        submitting.value = false;
                        setLoading(false);
                    }
                };

                const fileToBase64 = (file) => {
                    return new Promise((resolve, reject) => {
                        const reader = new FileReader();
                        reader.readAsDataURL(file);
                        reader.onload = () => {
                            const base64 = reader.result.split(',')[1];
                            resolve(base64);
                        };
                        reader.onerror = error => reject(error);
                    });
                };

                const formatTime = (timestamp) => {
                    if (!timestamp) return '';
                    const date = new Date(timestamp * 1000);
                    return date.toLocaleString('zh-CN');
                };

                const preloadInputImages = async (tasks) => {
                    // ä¸ºæ‰€æœ‰ä»»åŠ¡é¢„åŠ è½½è¾“å…¥å›¾ç‰‡
                    for (const task of tasks) {
                        if (task.inputs) {
                            // æŸ¥æ‰¾è¾“å…¥ä¸­çš„å›¾ç‰‡æ–‡ä»¶
                            const imageInputs = Object.keys(task.inputs).filter(key =>
                                key.includes('image') ||
                                task.inputs[key].toString().toLowerCase().match(/\.(jpg|jpeg|png|gif|bmp|webp)$/)
                            );

                            // é¢„åŠ è½½ç¬¬ä¸€ä¸ªè¾“å…¥å›¾ç‰‡
                            if (imageInputs.length > 0) {
                                const firstImageKey = imageInputs[0];
                                try {
                                    const imageUrl = getTaskInputUrl(task.task_id, firstImageKey);
                                    // åˆ›å»ºImageå¯¹è±¡é¢„åŠ è½½è¾“å…¥å›¾ç‰‡
                                    const img = new Image();
                                    img.src = imageUrl;

                                    // ç›‘å¬åŠ è½½å®Œæˆäº‹ä»¶
                                    img.onload = () => {
                                        console.log(`Input image preloaded for task ${task.task_id}: ${firstImageKey}`);
                                    };

                                    img.onerror = () => {
                                        console.warn(`Failed to preload input image for task ${task.task_id}: ${firstImageKey}`);
                                    };
                                } catch (error) {
                                    console.warn(`Failed to preload input image for task ${task.task_id}:`, error);
                                }
                            }
                        }
                    }
                };

                const preloadThumbnailCache = async (tasks) => {
                    setTimeout(async () => {
                        try {
                            const response = await apiRequest('./api/v1/task/thumbnails');
                            if (response && response.ok) {
                                const data = await response.json();
                                const thumbnails = data.thumbnails || {};

                                for (const [taskId, thumbnailUrl] of Object.entries(thumbnails)) {
                                    thumbnailCache.value.set(taskId, thumbnailUrl);
                                }

                                thumbnailCacheLoaded.value = true;
                                console.log(`ç¼©ç•¥å›¾ä¸€æ¬¡æ€§åŠ è½½å®Œæˆï¼Œå…±ç¼“å­˜${Object.keys(thumbnails).length}ä¸ªä»»åŠ¡`);
                            } else {
                                // å¦‚æœAPIè°ƒç”¨å¤±è´¥ï¼Œå›é€€åˆ°åŸæ¥çš„é€ä¸ªåŠ è½½æ–¹å¼
                                await preloadThumbnailsIndividually(tasks.slice(0, 30));
                            }
                        } catch (error) {
                            // å¦‚æœAPIè°ƒç”¨å¼‚å¸¸ï¼Œå›é€€åˆ°åŸæ¥çš„é€ä¸ªåŠ è½½æ–¹å¼
                            await preloadThumbnailsIndividually(tasks.slice(0, 30));
                        }
                    }, 100); // å»¶è¿Ÿ100mså¼€å§‹ï¼Œè®©é¡µé¢å…ˆæ¸²æŸ“
                };

                const preloadThumbnailsIndividually = async (tasksToCache) => {
                    // ä½¿ç”¨ä¸²è¡ŒåŠ è½½é¿å…è¿‡å¿«è®¿é—®
                    for (let i = 0; i < tasksToCache.length; i++) {
                        const task = tasksToCache[i];

                        if (task.inputs) {
                            // æŸ¥æ‰¾è¾“å…¥ä¸­çš„å›¾ç‰‡æ–‡ä»¶
                            const imageInputs = Object.keys(task.inputs).filter(key =>
                                key.includes('image') ||
                                task.inputs[key].toString().toLowerCase().match(/\.(jpg|jpeg|png|gif|bmp|webp)$/)
                            );

                            if (imageInputs.length > 0) {
                                const firstImageKey = imageInputs[0];
                                try {
                                    const imageUrl = getTaskInputUrl(task.task_id, firstImageKey);

                                    // ä½¿ç”¨é‡è¯•æœºåˆ¶åŠ è½½å›¾ç‰‡
                                    const success = await loadImageWithRetry(task.task_id, imageUrl, 3);
                                    if (success) {
                                        thumbnailCache.value.set(task.task_id, imageUrl);
                                    }
                                } catch (error) {
                                    console.warn(`ç¼©ç•¥å›¾ç¼“å­˜é”™è¯¯ ${task.task_id}:`, error);
                                }
                            }
                        }

                        // æ·»åŠ å»¶è¿Ÿé¿å…è¿‡å¿«è®¿é—®
                        if (i < tasksToCache.length - 1) {
                            await new Promise(resolve => setTimeout(resolve, 200)); // 200mså»¶è¿Ÿ
                        }
                    }
                    thumbnailCacheLoaded.value = true;
                };

                const loadImageWithRetry = async (taskId, imageUrl, maxRetries = 3) => {
                    for (let attempt = 1; attempt <= maxRetries; attempt++) {
                        try {
                            const success = await new Promise((resolve) => {
                                const img = new Image();
                                img.onload = () => resolve(true);
                                img.onerror = () => resolve(false);

                                // è®¾ç½®è¶…æ—¶
                                const timeout = setTimeout(() => {
                                    resolve(false);
                                }, 10000); // 10ç§’è¶…æ—¶

                                img.onload = () => {
                                    clearTimeout(timeout);
                                    resolve(true);
                                };

                                img.onerror = () => {
                                    clearTimeout(timeout);
                                    resolve(false);
                                };

                                img.src = imageUrl;
                            });

                            if (success) {
                                return true;
                            } else if (attempt < maxRetries) {
                                await new Promise(resolve => setTimeout(resolve, 3000 * attempt));
                            }
                        } catch (error) {
                            if (attempt < maxRetries) {
                                await new Promise(resolve => setTimeout(resolve, 3000 * attempt));
                            }
                        }
                    }
                    return false;
                };

                const refreshTasks = async () => {
                    try {
                        const params = new URLSearchParams({
                            page: currentPage.value.toString(),
                            page_size: pageSize.value.toString()
                        });

                        if (statusFilter.value !== 'ALL') {
                            params.append('status', statusFilter.value);
                        }

                        const response = await apiRequest(`./api/v1/task/list?${params.toString()}`);
                        if (response && response.ok) {
                            const data = await response.json();
                            tasks.value = data.tasks || [];
                            pagination.value = data.pagination || null;

                            if (!thumbnailCacheLoaded.value) {
                                await preloadThumbnailCache(tasks.value);
                            } else {
                                await preloadInputImages(tasks.value);
                            }
                        } else if (response) {
                            showAlert('åˆ·æ–°ä»»åŠ¡åˆ—è¡¨å¤±è´¥', 'danger');
                        }
                        // å¦‚æœresponseä¸ºnullï¼Œè¯´æ˜æ˜¯è®¤è¯é”™è¯¯ï¼ŒapiRequestå·²ç»å¤„ç†äº†
                    } catch (error) {
                        showAlert(`åˆ·æ–°ä»»åŠ¡åˆ—è¡¨å¤±è´¥: ${error.message}`, 'danger');
                    }
                };

                const getStatusBadgeClass = (status) => {
                    const statusMap = {
                        'SUCCEED': 'bg-success',
                        'FAILED': 'bg-danger',
                        'RUNNING': 'bg-warning',
                        'PENDING': 'bg-secondary',
                        'CREATED': 'bg-secondary'
                    };
                    return statusMap[status] || 'bg-secondary';
                };

                const downloadSingleResult = async (taskId, key, outputPath) => {
                    try {
                        setLoading(true);
                        const response = await apiCall(`./api/v1/task/result?task_id=${taskId}&name=${key}`);
                        if (response.ok) {
                            const blob = await response.blob();
                            const url = window.URL.createObjectURL(blob);
                            const a = document.createElement('a');
                            a.href = url;
                            // ä½¿ç”¨åŸå§‹æ–‡ä»¶åï¼Œå¦‚æœæ²¡æœ‰åˆ™ä½¿ç”¨outputPath
                            const filename = key || outputPath || `result_${taskId}`;
                            a.download = filename;
                            document.body.appendChild(a);
                            a.click();
                            document.body.removeChild(a);
                            window.URL.revokeObjectURL(url);
                            showAlert('æ–‡ä»¶ä¸‹è½½æˆåŠŸ', 'success');
                        } else {
                            showAlert('è·å–ç»“æœå¤±è´¥', 'danger');
                        }
                    } catch (error) {
                        showAlert(`ä¸‹è½½ç»“æœå¤±è´¥: ${error.message}`, 'danger');
                    } finally {
                        setLoading(false);
                    }
                };

                const viewSingleResult = async (taskId, key) => {
                    try {
                        setLoading(true);
                        const response = await apiCall(`./api/v1/task/result?task_id=${taskId}&name=${key}`);
                        if (response.ok) {
                            const blob = await response.blob();
                            const videoBlob = new Blob([blob], { type: 'video/mp4' });
                            const url = window.URL.createObjectURL(videoBlob);
                            window.open(url, '_blank');
                        } else {
                            showAlert('è·å–ç»“æœå¤±è´¥', 'danger');
                        }
                    } catch (error) {
                        showAlert(`æŸ¥çœ‹ç»“æœå¤±è´¥: ${error.message}`, 'danger');
                    } finally {
                        setLoading(false);
                    }
                };

                const getVideoUrl = (taskId, key) => {
                    const token = localStorage.getItem('accessToken');
                    if (token) {
                        return `./api/v1/task/result?task_id=${taskId}&name=${key}&token=${encodeURIComponent(token)}`;
                    }
                    return `./api/v1/task/result?task_id=${taskId}&name=${key}`;
                };

                const cancelTask = async (taskId) => {
                    try {
                        const response = await apiRequest(`./api/v1/task/cancel?task_id=${taskId}`);
                        if (response && response.ok) {
                            showAlert('ä»»åŠ¡å–æ¶ˆæˆåŠŸ', 'success');
                            await refreshTasks();
                        } else if (response) {
                            const error = await response.json();
                            showAlert(`å–æ¶ˆä»»åŠ¡å¤±è´¥: ${error.message}`, 'danger');
                        }
                        // å¦‚æœresponseä¸ºnullï¼Œè¯´æ˜æ˜¯è®¤è¯é”™è¯¯ï¼ŒapiRequestå·²ç»å¤„ç†äº†
                    } catch (error) {
                        showAlert(`å–æ¶ˆä»»åŠ¡å¤±è´¥: ${error.message}`, 'danger');
                    }
                };

                const resumeTask = async (taskId) => {
                    try {
                        const response = await apiRequest(`./api/v1/task/resume?task_id=${taskId}`);
                        if (response && response.ok) {
                            showAlert('ä»»åŠ¡é‡è¯•æˆåŠŸ', 'success');
                            await refreshTasks();
                        } else if (response) {
                            const error = await response.json();
                            showAlert(`é‡è¯•ä»»åŠ¡å¤±è´¥: ${error.message}`, 'danger');
                        }
                        // å¦‚æœresponseä¸ºnullï¼Œè¯´æ˜æ˜¯è®¤è¯é”™è¯¯ï¼ŒapiRequestå·²ç»å¤„ç†äº†
                    } catch (error) {
                        showAlert(`é‡è¯•ä»»åŠ¡å¤±è´¥: ${error.message}`, 'danger');
                    }
                };



                const loadTaskFiles = async (taskId) => {
                    try {
                        loadingTaskFiles.value = true;

                        // é€šè¿‡APIè·å–ä»»åŠ¡è¯¦æƒ…
                        const response = await apiRequest(`./api/v1/task/query?task_id=${taskId}`);
                        if (!response || !response.ok) {
                            showAlert('è·å–ä»»åŠ¡è¯¦æƒ…å¤±è´¥', 'danger');
                            return;
                        }

                        const task = await response.json();
                        if (!task) {
                            showAlert('ä»»åŠ¡ä¸å­˜åœ¨', 'danger');
                            return;
                        }

                        const files = { inputs: {}, outputs: {} };

                        // è·å–è¾“å…¥æ–‡ä»¶ï¼ˆæ‰€æœ‰çŠ¶æ€çš„ä»»åŠ¡éƒ½éœ€è¦ï¼‰
                        if (task.inputs) {
                            for (const [key, inputPath] of Object.entries(task.inputs)) {
                                try {
                                    const response = await apiRequest(`./api/v1/task/input?task_id=${taskId}&name=${key}`);
                                    if (response && response.ok) {
                                        const blob = await response.blob();
                                        files.inputs[key] = {
                                            name: inputPath, // ä½¿ç”¨åŸå§‹æ–‡ä»¶åè€Œä¸æ˜¯key
                                            path: inputPath,
                                            blob: blob,
                                            url: URL.createObjectURL(blob)
                                        };
                                    }
                                } catch (error) {
                                    console.error(`Failed to load input ${key}:`, error);
                                    files.inputs[key] = {
                                        name: inputPath, // ä½¿ç”¨åŸå§‹æ–‡ä»¶åè€Œä¸æ˜¯key
                                        path: inputPath,
                                        error: true
                                    };
                                }
                            }
                        }

                        // åªå¯¹æˆåŠŸå®Œæˆçš„ä»»åŠ¡è·å–è¾“å‡ºæ–‡ä»¶
                        if (task.status === 'SUCCEED' && task.outputs) {
                            for (const [key, outputPath] of Object.entries(task.outputs)) {
                                try {
                                    const response = await apiRequest(`./api/v1/task/result?task_id=${taskId}&name=${key}`);
                                    if (response && response.ok) {
                                        const blob = await response.blob();
                                        files.outputs[key] = {
                                            name: outputPath, // ä½¿ç”¨åŸå§‹æ–‡ä»¶åè€Œä¸æ˜¯key
                                            path: outputPath,
                                            blob: blob,
                                            url: URL.createObjectURL(blob)
                                        };
                                    }
                                } catch (error) {
                                    console.error(`Failed to load output ${key}:`, error);
                                    files.outputs[key] = {
                                        name: outputPath, // ä½¿ç”¨åŸå§‹æ–‡ä»¶åè€Œä¸æ˜¯key
                                        path: outputPath,
                                        error: true
                                    };
                                }
                            }
                        }

                        selectedTaskFiles.value = files;

                    } catch (error) {
                        console.error('Failed to load task files:', error);
                        showAlert('åŠ è½½ä»»åŠ¡æ–‡ä»¶å¤±è´¥', 'danger');
                    } finally {
                        loadingTaskFiles.value = false;
                    }
                };

                const viewTaskDetail = async (task) => {
                    // æ¸…ç†ä¹‹å‰çš„æ–‡ä»¶ç¼“å­˜
                    clearTaskFiles();

                    selectedTask.value = task;
                    selectedTaskId.value = task.task_type;
                    showCreator.value = false;

                    // ä¸€æ¬¡æ€§åŠ è½½æ‰€æœ‰ä»»åŠ¡æ–‡ä»¶
                    await loadTaskFiles(task.task_id);
                };

                const downloadFile = (fileInfo) => {
                    if (!fileInfo || !fileInfo.blob) {
                        showAlert('æ–‡ä»¶ä¸å¯ç”¨', 'danger');
                        return;
                    }

                    try {
                        const url = URL.createObjectURL(fileInfo.blob);
                        const a = document.createElement('a');
                        a.href = url;
                        a.download = fileInfo.name || 'download';
                        document.body.appendChild(a);
                        a.click();
                        document.body.removeChild(a);
                        URL.revokeObjectURL(url);
                    } catch (error) {
                        console.error('Download failed:', error);
                        showAlert('ä¸‹è½½å¤±è´¥', 'danger');
                    }
                };

                const viewFile = (fileInfo) => {
                    if (!fileInfo || !fileInfo.url) {
                        showAlert('æ–‡ä»¶ä¸å¯ç”¨', 'danger');
                        return;
                    }

                    // åœ¨æ–°çª—å£ä¸­æ‰“å¼€æ–‡ä»¶
                    window.open(fileInfo.url, '_blank');
                };

                const clearTaskFiles = () => {
                    // æ¸…ç† URL å¯¹è±¡ï¼Œé‡Šæ”¾å†…å­˜
                    Object.values(selectedTaskFiles.value.inputs).forEach(file => {
                        if (file.url) {
                            URL.revokeObjectURL(file.url);
                        }
                    });
                    Object.values(selectedTaskFiles.value.outputs).forEach(file => {
                        if (file.url) {
                            URL.revokeObjectURL(file.url);
                        }
                    });
                    selectedTaskFiles.value = { inputs: {}, outputs: {} };
                };

                const showTaskCreator = () => {
                    showCreator.value = true;
                    selectedTask.value = null;
                    // clearTaskFiles(); // æ¸…ç©ºæ–‡ä»¶ç¼“å­˜
                    selectedTaskId.value = 'digital_human'; // é»˜è®¤é€‰æ‹©æ•°å­—äººä»»åŠ¡
                };

                const toggleSidebar = () => {
                    sidebarCollapsed.value = !sidebarCollapsed.value;
                };

                const clearPrompt = () => {
                    getCurrentForm().prompt = '';
                };

                const getTaskItemClass = (status) => {
                    if (status === 'SUCCEED') return 'bg-laser-purple/15 border border-laser-purple/30';
                    if (status === 'RUNNING') return 'bg-laser-purple/15 border border-laser-purple/30';
                    if (status === 'FAILED') return 'bg-red-500/15 border border-red-500/30';
                    return 'bg-dark-light border border-gray-700';
                };

                const getStatusIndicatorClass = (status) => {
                const base = 'inline-block w-2 aspect-square rounded-full shrink-0 align-middle';
                    if (status === 'SUCCEED')
                        return `${base} bg-gradient-to-r from-emerald-200 to-green-300 shadow-md shadow-emerald-300/30`;
                    if (status === 'RUNNING')
                        return `${base} bg-gradient-to-r from-amber-200 to-yellow-300 shadow-md shadow-amber-300/30 animate-pulse`;
                    if (status === 'FAILED')
                        return `${base} bg-gradient-to-r from-red-200 to-pink-300 shadow-md shadow-red-300/30`;
                    return `${base} bg-gradient-to-r from-gray-200 to-gray-300 shadow-md shadow-gray-300/30`;
                    };


                const getTaskTypeBtnClass = (taskType) => {
                    if (selectedTaskId.value === taskType) {
                        return 'text-gradient-icon border-b-2 border-laser-purple';
                    }
                    return 'text-gray-400 hover:text-gradient-icon';
                };

                const getModelBtnClass = (model) => {
                    if (getCurrentForm().model_cls === model) {
                        return 'bg-laser-purple/20 border border-laser-purple/40 active shadow-laser animate-electric-pulse';
                    }
                    return 'bg-dark-light border border-gray-700 hover:bg-laser-purple/15 hover:border-laser-purple/40 transition-all hover:shadow-laser';
                };

                const getTaskTypeIcon = (taskType) => {
                    const iconMap = {
                        't2v': 'fas fa-font',
                        'i2v': 'fas fa-image',
                        'digital_human': 'fas fa-user'
                    };
                    return iconMap[taskType] || 'fas fa-video';
                };

                const getTaskTypeName = (task) => {
                    // å¦‚æœä¼ å…¥çš„æ˜¯å­—ç¬¦ä¸²ï¼Œç›´æ¥è¿”å›æ˜ å°„
                    if (typeof task === 'string') {
                        const nameMap = {
                            't2v': 'æ–‡ç”Ÿè§†é¢‘',
                            'i2v': 'å›¾ç”Ÿè§†é¢‘',
                            'digital_human': 'æ•°å­—äºº'
                        };
                        return nameMap[task] || task;
                    }

                    // å¦‚æœä¼ å…¥çš„æ˜¯ä»»åŠ¡å¯¹è±¡ï¼Œæ ¹æ®æ¨¡å‹ç±»å‹åˆ¤æ–­
                    if (task && task.model_cls) {
                        const modelCls = task.model_cls.toLowerCase();

                        // æ£€æŸ¥æ˜¯å¦æ˜¯æ•°å­—äººæ¨¡å‹ï¼ˆåŒ…å«audioæˆ–sekoï¼‰
                        if (modelCls.includes('audio') || modelCls.includes('seko')) {
                            return 'æ•°å­—äºº';
                        }

                        // æ ¹æ®task_typeåˆ¤æ–­
                        const nameMap = {
                            't2v': 'æ–‡ç”Ÿè§†é¢‘',
                            'i2v': 'å›¾ç”Ÿè§†é¢‘',
                            'digital_human': 'æ•°å­—äºº'
                        };
                        return nameMap[task.task_type] || task.task_type;
                    }

                    // é»˜è®¤è¿”å›task_type
                    return task.task_type || 'æœªçŸ¥';
                };

                const getPromptPlaceholder = () => {
                    if (selectedTaskId.value === 't2v') {
                        return 'è¯·è¾“å…¥è§†é¢‘ç”Ÿæˆæç¤ºè¯ï¼Œæè¿°è§†é¢‘å†…å®¹ã€é£æ ¼ã€åœºæ™¯ç­‰...';
                    } else if (selectedTaskId.value === 'i2v') {
                        return 'è¯·è¾“å…¥è§†é¢‘ç”Ÿæˆæç¤ºè¯ï¼Œæè¿°åŸºäºå›¾ç‰‡çš„è§†é¢‘å†…å®¹ã€åŠ¨ä½œè¦æ±‚ç­‰...';
                    } else if (selectedTaskId.value === 'digital_human') {
                        return 'è¯·è¾“å…¥è§†é¢‘ç”Ÿæˆæç¤ºè¯ï¼Œæè¿°æ•°å­—äººå½¢è±¡ã€èƒŒæ™¯é£æ ¼ã€åŠ¨ä½œè¦æ±‚ç­‰...';
                    }
                    return 'è¯·è¾“å…¥è§†é¢‘ç”Ÿæˆæç¤ºè¯...';
                };

                const getStatusTextClass = (status) => {
                    if (status === 'SUCCEED') return 'text-emerald-400';
                    if (status === 'RUNNING') return 'text-amber-400';
                    if (status === 'FAILED') return 'text-red-400';
                    return 'text-gray-400';
                };



                const getImagePreview = (base64Data) => {
                    if (!base64Data) return '';
                    return `data:image/jpeg;base64,${base64Data}`;
                };

                const getTaskInputUrl = (taskId, key) => {
                    const token = localStorage.getItem('accessToken');
                    if (token) {
                        return `./api/v1/task/input?task_id=${taskId}&name=${key}&token=${encodeURIComponent(token)}`;
                    }
                    return `./api/v1/task/input?task_id=${taskId}&name=${key}`;
                };

                const getTaskInputImage = (task) => {
                    if (!task || !task.inputs) return null;
                    const imageInputs = Object.keys(task.inputs).filter(key =>
                        key.includes('image') ||
                        task.inputs[key].toString().toLowerCase().match(/\.(jpg|jpeg|png|gif|bmp|webp)$/)
                    );

                    if (imageInputs.length > 0) {
                        const firstImageKey = imageInputs[0];
                        return getTaskInputUrl(task.task_id, firstImageKey);
                    }

                    return null;
                };

                const getVideoThumbnail = (taskId, name) => {
                    if (thumbnailCache.value.has(taskId)) {
                        return thumbnailCache.value.get(taskId);
                    }

                    const task = tasks.value.find(t => t.task_id === taskId);
                    if (task) {
                        const inputImageUrl = getTaskInputImage(task);
                        if (inputImageUrl) {
                            return inputImageUrl;
                        } else {
                            console.log(`ä»»åŠ¡ ${taskId} æ²¡æœ‰è¾“å…¥å›¾ç‰‡`);
                        }
                    } else {
                        console.log(`æœªæ‰¾åˆ°ä»»åŠ¡: ${taskId}`);
                    }

                    // å¦‚æœæ²¡æœ‰è¾“å…¥å›¾ç‰‡ï¼Œè¿”å›ç©ºå­—ç¬¦ä¸²ï¼Œè®©handleThumbnailErrorå¤„ç†
                    return '';
                };

                const getVideoThumbnailInfo = (taskId, name) => {
                    // é¦–å…ˆæ£€æŸ¥ç¼“å­˜
                    if (thumbnailCache.value.has(taskId)) {
                        return {
                            url: thumbnailCache.value.get(taskId),
                            hasThumbnail: true
                        };
                    }

                    // å¦‚æœç¼“å­˜ä¸­æ²¡æœ‰ï¼Œå¼‚æ­¥åŠ è½½å¹¶æ›´æ–°ç¼“å­˜
                    loadThumbnailAsync(taskId, name);

                    // è¿”å›ç©ºï¼Œè®©æ¨¡æ¿æ˜¾ç¤ºé»˜è®¤å›¾æ ‡
                    return {
                        url: '',
                        hasThumbnail: false
                    };
                };

                const loadThumbnailAsync = async (taskId, name) => {
                    const task = tasks.value.find(t => t.task_id === taskId);
                    if (!task || !task.inputs) return;

                    // æŸ¥æ‰¾è¾“å…¥ä¸­çš„å›¾ç‰‡æ–‡ä»¶
                    const imageInputs = Object.keys(task.inputs).filter(key =>
                        key.includes('image') ||
                        task.inputs[key].toString().toLowerCase().match(/\.(jpg|jpeg|png|gif|bmp|webp)$/)
                    );

                    if (imageInputs.length > 0) {
                        const firstImageKey = imageInputs[0];
                        try {
                            const imageUrl = getTaskInputUrl(taskId, firstImageKey);

                            // ä½¿ç”¨é‡è¯•æœºåˆ¶åŠ è½½å›¾ç‰‡
                            const success = await loadImageWithRetry(taskId, imageUrl, 3);
                            if (success) {
                                thumbnailCache.value.set(taskId, imageUrl);
                            }
                        } catch (error) {
                            console.warn(`ç¼©ç•¥å›¾å¼‚æ­¥åŠ è½½é”™è¯¯ ${taskId}:`, error);
                        }
                    }
                };

                const handleThumbnailError = (event) => {
                    // å½“è¾“å…¥å›¾ç‰‡åŠ è½½å¤±è´¥æ—¶ï¼Œæ˜¾ç¤ºé»˜è®¤å›¾æ ‡
                    const img = event.target;
                    const parent = img.parentElement;
                    parent.innerHTML = '<div class="w-full h-full bg-laser-purple/20 flex items-center justify-center"><i class="fas fa-video text-gradient-icon text-xl"></i></div>';
                };

                const handleImageError = (event) => {
                    // å½“å›¾ç‰‡åŠ è½½å¤±è´¥æ—¶ï¼Œéšè—å›¾ç‰‡ï¼Œæ˜¾ç¤ºæ–‡ä»¶å
                    const img = event.target;
                    img.style.display = 'none';
                    // æ–‡ä»¶åå·²ç»æ˜¾ç¤ºï¼Œä¸éœ€è¦é¢å¤–å¤„ç†
                };

                const handleImageLoad = (event) => {
                    // å½“å›¾ç‰‡åŠ è½½æˆåŠŸæ—¶ï¼Œæ˜¾ç¤ºå›¾ç‰‡å’Œä¸‹è½½æŒ‰é’®ï¼Œéšè—æ–‡ä»¶å
                    const img = event.target;
                    img.style.display = 'block';
                    // æ˜¾ç¤ºä¸‹è½½æŒ‰é’®
                    const downloadBtn = img.parentElement.querySelector('button');
                    if (downloadBtn) {
                        downloadBtn.style.display = 'block';
                    }
                    // éšè—æ–‡ä»¶åspan
                    const span = img.parentElement.parentElement.querySelector('span');
                    if (span) {
                        span.style.display = 'none';
                    }
                };

                const handleAudioError = (event) => {
                    // å½“éŸ³é¢‘åŠ è½½å¤±è´¥æ—¶ï¼Œéšè—éŸ³é¢‘æ§ä»¶å’Œä¸‹è½½æŒ‰é’®ï¼Œæ˜¾ç¤ºæ–‡ä»¶å
                    const audio = event.target;
                    audio.style.display = 'none';
                    // éšè—ä¸‹è½½æŒ‰é’®
                    const downloadBtn = audio.parentElement.querySelector('button');
                    if (downloadBtn) {
                        downloadBtn.style.display = 'none';
                    }
                    // æ–‡ä»¶åå·²ç»æ˜¾ç¤ºï¼Œä¸éœ€è¦é¢å¤–å¤„ç†
                };

                const handleAudioLoad = (event) => {
                    // å½“éŸ³é¢‘åŠ è½½æˆåŠŸæ—¶ï¼Œæ˜¾ç¤ºéŸ³é¢‘æ§ä»¶å’Œä¸‹è½½æŒ‰é’®ï¼Œéšè—æ–‡ä»¶å
                    const audio = event.target;
                    audio.style.display = 'block';
                    // æ˜¾ç¤ºä¸‹è½½æŒ‰é’®
                    const downloadBtn = audio.parentElement.querySelector('button');
                    if (downloadBtn) {
                        downloadBtn.style.display = 'block';
                    }
                    // éšè—æ–‡ä»¶åspan
                    const span = audio.parentElement.parentElement.querySelector('span');
                    if (span) {
                        span.style.display = 'none';
                    }
                };


                const downloadTaskInput = async (taskId, inputName, fileName) => {
                    try {
                        const url = getTaskInputUrl(taskId, inputName);
                        const response = await apiRequest(url);

                        if (!response || !response.ok) {
                            throw new Error(`ä¸‹è½½å¤±è´¥: ${response ? response.status : 'è®¤è¯å¤±è´¥'}`);
                        }

                        const blob = await response.blob();
                        const downloadUrl = window.URL.createObjectURL(blob);

                        // åˆ›å»ºä¸‹è½½é“¾æ¥
                        const link = document.createElement('a');
                        link.href = downloadUrl;
                        // ä½¿ç”¨åŸå§‹æ–‡ä»¶åï¼Œå¦‚æœæ²¡æœ‰åˆ™ä½¿ç”¨inputName
                        const filename = inputName || fileName || `input_${taskId}`;
                        link.download = filename;
                        document.body.appendChild(link);
                        link.click();

                        // æ¸…ç†
                        document.body.removeChild(link);
                        window.URL.revokeObjectURL(downloadUrl);

                        showAlert('æ–‡ä»¶ä¸‹è½½æˆåŠŸ', 'success');
                    } catch (error) {
                        console.error('ä¸‹è½½å¤±è´¥:', error);
                        showAlert(`ä¸‹è½½å¤±è´¥: ${error.message}`, 'danger');
                    }
                };

                const initModelAndTasks = async () => {
                    await loadModels();
                    await refreshTasks();
                };

                // ä»»åŠ¡çŠ¶æ€ç®¡ç†
                const getTaskStatusDisplay = (status) => {
                    const statusMap = {
                        'CREATED': 'åˆ›å»º',
                        'PENDING': 'ç­‰å¾…',
                        'RUNNING': 'è¿›è¡Œ',
                        'SUCCEED': 'å®Œæˆ',
                        'FAILED': 'å¤±è´¥',
                        'CANCEL': 'å–æ¶ˆ'
                    };
                    return statusMap[status] || status;
                };

                const getTaskStatusColor = (status) => {
                    const colorMap = {
                        'CREATED': 'text-blue-400',
                        'PENDING': 'text-yellow-400',
                        'RUNNING': 'text-amber-400',
                        'SUCCEED': 'text-emerald-400',
                        'FAILED': 'text-red-400',
                        'CANCEL': 'text-gray-400'
                    };
                    return colorMap[status] || 'text-gray-400';
                };

                const getTaskStatusIcon = (status) => {
                    const iconMap = {
                        'CREATED': 'fas fa-clock',
                        'PENDING': 'fas fa-hourglass-half',
                        'RUNNING': 'fas fa-spinner fa-spin',
                        'SUCCEED': 'fas fa-check-circle',
                        'FAILED': 'fas fa-exclamation-triangle',
                        'CANCEL': 'fas fa-ban'
                    };
                    return iconMap[status] || 'fas fa-question-circle';
                };


                // ä»»åŠ¡æ—¶é—´æ ¼å¼åŒ–
                const getTaskDuration = (startTime, endTime) => {
                    if (!startTime || !endTime) return 'æœªçŸ¥';
                    const start = new Date(startTime * 1000);
                    const end = new Date(endTime * 1000);
                    const diff = end - start;
                    const minutes = Math.floor(diff / 60000);
                    const seconds = Math.floor((diff % 60000) / 1000);
                    return `${minutes}åˆ†${seconds}ç§’`;
                };

                // ç›¸å¯¹æ—¶é—´æ ¼å¼åŒ–
                const getRelativeTime = (timestamp) => {
                    if (!timestamp) return 'æœªçŸ¥';
                    const now = new Date();
                    const time = new Date(timestamp * 1000);
                    const diff = now - time;

                    const minutes = Math.floor(diff / 60000);
                    const hours = Math.floor(diff / 3600000);
                    const days = Math.floor(diff / 86400000);
                    const months = Math.floor(diff / 2592000000); // 30å¤©
                    const years = Math.floor(diff / 31536000000);

                    if (years > 0) {
                        return years === 1 ? 'ä¸€å¹´å‰' : `${years}å¹´å‰`;
                    } else if (months > 0) {
                        return months === 1 ? 'ä¸€ä¸ªæœˆå‰' : `${months}ä¸ªæœˆå‰`;
                    } else if (days > 0) {
                        return days === 1 ? 'ä¸€å¤©å‰' : `${days}å¤©å‰`;
                    } else if (hours > 0) {
                        return hours === 1 ? 'ä¸€å°æ—¶å‰' : `${hours}å°æ—¶å‰`;
                    } else if (minutes > 0) {
                        return minutes === 1 ? 'ä¸€åˆ†é’Ÿå‰' : `${minutes}åˆ†é’Ÿå‰`;
                    } else {
                        return 'åˆšåˆš';
                    }
                };

                // ä»»åŠ¡å†å²è®°å½•ç®¡ç†
                const getTaskHistory = () => {
                    return tasks.value.filter(task =>
                        ['SUCCEED', 'FAILED', 'CANCEL'].includes(task.status)
                    );
                };

                const getActiveTasks = () => {
                    return tasks.value.filter(task =>
                        ['CREATED', 'PENDING', 'RUNNING'].includes(task.status)
                    );
                };

                // ä»»åŠ¡æœç´¢å’Œè¿‡æ»¤å¢å¼º
                const searchTasks = (query) => {
                    if (!query) return tasks.value;
                    return tasks.value.filter(task => {
                        const searchText = [
                            task.task_id,
                            task.task_type,
                            task.model_cls,
                            task.params?.prompt || '',
                            getTaskStatusDisplay(task.status)
                        ].join(' ').toLowerCase();
                        return searchText.includes(query.toLowerCase());
                    });
                };

                const filterTasksByStatus = (status) => {
                    if (status === 'ALL') return tasks.value;
                    return tasks.value.filter(task => task.status === status);
                };

                const filterTasksByType = (type) => {
                    if (!type) return tasks.value;
                    return tasks.value.filter(task => task.task_type === type);
                };

                // æç¤ºæ¶ˆæ¯æ ·å¼ç®¡ç†
                const getAlertClass = (type) => {
                    const classMap = {
                        'success': 'animate-slide-down',
                        'warning': 'animate-slide-down',
                        'danger': 'animate-slide-down',
                        'info': 'animate-slide-down'
                    };
                    return classMap[type] || 'animate-slide-down';
                };

                const getAlertBorderClass = (type) => {
                    const borderMap = {
                        'success': 'border-green-500',
                        'warning': 'border-yellow-500',
                        'danger': 'border-red-500',
                        'info': 'border-blue-500'
                    };
                    return borderMap[type] || 'border-gray-500';
                };

                const getAlertTextClass = (type) => {
                    // å­—ä½“ä¸ºç°è‰²åç™½è‰²
                    const textMap = {
                        'success': 'text-gray-100 bg-white-500',
                        'warning': 'text-gray-100 bg-white-500',
                        'danger': 'text-gray-100 bg-white-500',
                        'info': 'text-gray-100 bg-white-500'
                    };
                    return textMap[type] || 'text-gray-100 bg-white-500';
                };

                const getAlertIcon = (type) => {
                    const iconMap = {
                        'success': 'fas fa-check-circle text-green-400',
                        'warning': 'fas fa-exclamation-triangle text-yellow-400',
                        'danger': 'fas fa-times-circle text-red-400',
                        'info': 'fas fa-info-circle text-blue-400'
                    };
                    return iconMap[type] || 'fas fa-info-circle text-gray-400';
                };

                // ç›‘å¬å™¨ - ç›‘å¬ä»»åŠ¡ç±»å‹å˜åŒ–
                watch(() => selectedTaskId.value, () => {
                    const currentForm = getCurrentForm();

                    // åªæœ‰å½“å½“å‰è¡¨å•æ²¡æœ‰é€‰æ‹©æ¨¡å‹æ—¶ï¼Œæ‰è‡ªåŠ¨é€‰æ‹©ç¬¬ä¸€ä¸ªå¯ç”¨çš„æ¨¡å‹
                    if (!currentForm.model_cls) {
                        let availableModels;

                        // å¦‚æœæ˜¯æ•°å­—äººä»»åŠ¡ï¼Œä»i2væ¨¡å‹ä¸­ç­›é€‰åŒ…å«audioæˆ–sekoçš„æ¨¡å‹
                        if (selectedTaskId.value === 'digital_human') {
                            availableModels = models.value.filter(m =>
                                m.task === 'i2v' && (m.model_cls.toLowerCase().includes('audio') || m.model_cls.toLowerCase().includes('seko'))
                            );
                        } else if (selectedTaskId.value === 'i2v') {
                            // å¦‚æœæ˜¯i2vä»»åŠ¡ï¼Œæ’é™¤åŒ…å«audioæˆ–sekoçš„æ¨¡å‹
                            availableModels = models.value.filter(m =>
                                m.task === 'i2v' && !m.model_cls.toLowerCase().includes('audio') && !m.model_cls.toLowerCase().includes('seko')
                            );
                        } else {
                            availableModels = models.value.filter(m => m.task === selectedTaskId.value);
                        }

                        if (availableModels.length > 0) {
                            const firstModel = availableModels[0];
                            currentForm.model_cls = firstModel.model_cls;
                            currentForm.stage = firstModel.stage;
                        }
                    }

                    // æ³¨æ„ï¼šè¿™é‡Œä¸éœ€è¦é‡ç½®é¢„è§ˆï¼Œå› ä¸ºæˆ‘ä»¬è¦ä¿æŒæ¯ä¸ªä»»åŠ¡çš„ç‹¬ç«‹æ€§
                    // é¢„è§ˆä¼šåœ¨ selectTask å‡½æ•°ä¸­æ ¹æ®æ–‡ä»¶çŠ¶æ€æ¢å¤
                });

                watch(() => getCurrentForm().model_cls, () => {
                    const currentForm = getCurrentForm();

                    // åªæœ‰å½“å½“å‰è¡¨å•æ²¡æœ‰é€‰æ‹©é˜¶æ®µæ—¶ï¼Œæ‰è‡ªåŠ¨é€‰æ‹©ç¬¬ä¸€ä¸ªå¯ç”¨çš„é˜¶æ®µ
                    if (!currentForm.stage) {
                        let availableStages;

                        // å¦‚æœæ˜¯æ•°å­—äººä»»åŠ¡ï¼Œä»i2væ¨¡å‹ä¸­ç­›é€‰
                        if (selectedTaskId.value === 'digital_human') {
                            availableStages = models.value
                                .filter(m => m.task === 'i2v' && m.model_cls === currentForm.model_cls)
                                .map(m => m.stage);
                        } else if (selectedTaskId.value === 'i2v') {
                            // å¦‚æœæ˜¯i2vä»»åŠ¡ï¼Œæ’é™¤åŒ…å«audioæˆ–sekoçš„æ¨¡å‹
                            availableStages = models.value
                                .filter(m => m.task === 'i2v' && m.model_cls === currentForm.model_cls && !m.model_cls.toLowerCase().includes('audio') && !m.model_cls.toLowerCase().includes('seko'))
                                .map(m => m.stage);
                        } else {
                            availableStages = models.value
                                .filter(m => m.task === selectedTaskId.value && m.model_cls === currentForm.model_cls)
                                .map(m => m.stage);
                        }

                        if (availableStages.length > 0) {
                            currentForm.stage = availableStages[0];
                        }
                    }
                });

                // ç”Ÿå‘½å‘¨æœŸ
                onMounted(async () => {

                    // æ£€æŸ¥æ˜¯å¦å·²ç™»å½•
                    const savedToken = localStorage.getItem('accessToken');
                    const savedUser = localStorage.getItem('currentUser');

                    if (savedToken && savedUser) {
                        // éªŒè¯tokenæ˜¯å¦ä»ç„¶æœ‰æ•ˆ
                        const isValid = await validateToken(savedToken);
                        if (isValid) {
                            currentUser.value = JSON.parse(savedUser);
                            isLoggedIn.value = true;
                        } else {
                            // Tokenæ— æ•ˆï¼Œæ¸…é™¤æœ¬åœ°å­˜å‚¨
                            logout();
                            showAlert('ç™»å½•å·²è¿‡æœŸï¼Œè¯·é‡æ–°ç™»å½•', 'warning');
                        }
                    } else {
                        // æ£€æŸ¥æ˜¯å¦æ˜¯GitHubå›è°ƒ
                        const urlParams = new URLSearchParams(window.location.search);
                        const code = urlParams.get('code');
                        if (code) {
                            handleGitHubCallback(code);
                        }
                    }

                    // æ— è®ºæ˜¯å¦ç™»å½•éƒ½è¦åŠ è½½æ¨¡å‹æ•°æ®
                    await initModelAndTasks();
                    loadPromptHistory();
                    loadTemplates();

                    // ç­‰å¾…æ¨¡å‹æ•°æ®åŠ è½½å®Œæˆåå†æ£€æŸ¥ä»»åŠ¡ç±»å‹
                    if (availableTaskTypes.value.includes('digital_human')) {
                        selectTask('digital_human');
                    }
                    console.log('å½“å‰ç”¨æˆ·:', currentUser.value);
                    console.log('å¯ç”¨æ¨¡å‹:', models.value);
                    console.log('ä»»åŠ¡åˆ—è¡¨:', tasks.value);
                });

                // æç¤ºè¯æ¨¡æ¿ç®¡ç†
                const promptTemplates = {
                    'digital_human': [
                        {
                            id: 'dh_1',
                            title: 'å•†åŠ¡æ¼”è®²',
                            prompt: 'æ•°å­—äººè¿›è¡Œå•†åŠ¡æ¼”è®²ï¼Œè¡¨æƒ…è‡ªç„¶ï¼Œæ‰‹åŠ¿å¾—ä½“ï¼ŒèƒŒæ™¯ä¸ºç°ä»£åŒ–çš„ä¼šè®®å®¤ï¼Œæ•´ä½“é£æ ¼ä¸“ä¸šå•†åŠ¡ã€‚'
                        },
                        {
                            id: 'dh_2',
                            title: 'äº§å“ä»‹ç»',
                            prompt: 'æ•°å­—äººä»‹ç»äº§å“ç‰¹ç‚¹ï¼Œè¯­æ°”äº²åˆ‡ï¼ŒåŠ¨ä½œè‡ªç„¶ï¼ŒèƒŒæ™¯ä¸ºäº§å“å±•ç¤ºåŒºï¼Œçªå‡ºäº§å“çš„ç§‘æŠ€æ„Ÿå’Œå®ç”¨æ€§ã€‚'
                        }
                    ],
                    't2v': [
                        {
                            id: 't2v_1',
                            title: 'è‡ªç„¶é£æ™¯',
                            prompt: 'ä¸€ä¸ªå®é™çš„å±±è°·ï¼Œé˜³å…‰é€è¿‡äº‘å±‚æ´’åœ¨ç»¿è‰²çš„è‰åœ°ä¸Šï¼Œè¿œå¤„æœ‰é›ªå±±ï¼Œè¿‘å¤„æœ‰æ¸…æ¾ˆçš„æºªæµï¼Œç”»é¢æ¸©æš–è‡ªç„¶ï¼Œå……æ»¡ç”Ÿæœºã€‚'
                        },
                        {
                            id: 't2v_2',
                            title: 'åŸå¸‚å¤œæ™¯',
                            prompt: 'ç¹åçš„åŸå¸‚å¤œæ™¯ï¼Œéœ“è™¹ç¯é—ªçƒï¼Œé«˜æ¥¼å¤§å¦æ—ç«‹ï¼Œè½¦æµå¦‚ç»‡ï¼Œå¤©ç©ºä¸­æœ‰æ˜Ÿæ˜Ÿç‚¹ç¼€ï¼Œè¥é€ å‡ºéƒ½å¸‚çš„ç¹åæ°›å›´ã€‚'
                        },
                        {
                            id: 't2v_3',
                            title: 'ç§‘æŠ€æœªæ¥',
                            prompt: 'æœªæ¥ç§‘æŠ€åŸå¸‚ï¼Œé£è¡Œæ±½è½¦ç©¿æ¢­ï¼Œå…¨æ¯æŠ•å½±éšå¤„å¯è§ï¼Œå»ºç­‘å…·æœ‰æµçº¿å‹è®¾è®¡ï¼Œå……æ»¡ç§‘æŠ€æ„Ÿå’Œæœªæ¥æ„Ÿã€‚'
                        }
                    ],
                    'i2v': [
                        {
                            id: 'i2v_1',
                            title: 'äººç‰©åŠ¨ä½œ',
                            prompt: 'åŸºäºå‚è€ƒå›¾ç‰‡ï¼Œè®©è§’è‰²åšå‡ºè‡ªç„¶çš„è¡Œèµ°åŠ¨ä½œï¼Œä¿æŒåŸæœ‰çš„æœè£…å’Œé£æ ¼ï¼ŒèƒŒæ™¯å¯ä»¥é€‚å½“å˜åŒ–ã€‚'
                        },
                        {
                            id: 'i2v_2',
                            title: 'åœºæ™¯è½¬æ¢',
                            prompt: 'ä¿æŒå‚è€ƒå›¾ç‰‡ä¸­çš„äººç‰©å½¢è±¡ï¼Œå°†èƒŒæ™¯è½¬æ¢ä¸ºä¸åŒçš„å­£èŠ‚æˆ–ç¯å¢ƒï¼Œå¦‚ä»å®¤å†…åˆ°æˆ·å¤–ï¼Œä»ç™½å¤©åˆ°å¤œæ™šã€‚'
                        }
                    ]
                };

                const getPromptTemplates = (taskType) => {
                    return promptTemplates[taskType] || [];
                };

                const showPromptTemplates = () => {
                    if (!selectedTaskId.value) {
                        showAlert('è¯·å…ˆé€‰æ‹©ä»»åŠ¡ç±»å‹', 'warning');
                        return;
                    }
                    showTemplates.value = !showTemplates.value;
                };

                const showPromptHistory = () => {
                    showHistory.value = !showHistory.value;
                };

                const selectPromptTemplate = (template) => {
                    getCurrentForm().prompt = template.prompt;
                    showTemplates.value = false;
                    showAlert(`å·²åº”ç”¨æ¨¡æ¿: ${template.title}`, 'success');
                };

                // æç¤ºè¯å†å²è®°å½•ç®¡ç†
                const promptHistory = ref([]);

                const getPromptHistory = () => {
                    return promptHistory.value.slice(-10); // åªæ˜¾ç¤ºæœ€è¿‘10æ¡
                };

                const addPromptToHistory = (prompt) => {
                    if (!prompt || prompt.trim().length === 0) return;

                    // é¿å…é‡å¤æ·»åŠ 
                    const trimmedPrompt = prompt.trim();
                    if (promptHistory.value.includes(trimmedPrompt)) {
                        // å°†å·²å­˜åœ¨çš„æç¤ºè¯ç§»åˆ°æœ€å‰é¢
                        promptHistory.value = promptHistory.value.filter(p => p !== trimmedPrompt);
                    }

                    promptHistory.value.push(trimmedPrompt);

                    // é™åˆ¶å†å²è®°å½•æ•°é‡
                    if (promptHistory.value.length > 50) {
                        promptHistory.value = promptHistory.value.slice(-50);
                    }

                    // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
                    localStorage.setItem('promptHistory', JSON.stringify(promptHistory.value));
                };

                const selectPromptHistory = (prompt) => {
                    getCurrentForm().prompt = prompt;
                    showHistory.value = false;
                    showAlert('å·²åº”ç”¨å†å²æç¤ºè¯', 'success');
                };

                const clearPromptHistory = () => {
                    promptHistory.value = [];
                    localStorage.removeItem('promptHistory');
                    showAlert('æç¤ºè¯å†å²å·²æ¸…ç©º', 'info');
                };

                // åŠ è½½æç¤ºè¯å†å²è®°å½•
                const loadPromptHistory = () => {
                    try {
                        const saved = localStorage.getItem('promptHistory');
                        if (saved) {
                            promptHistory.value = JSON.parse(saved);
                        }
                    } catch (error) {
                        console.warn('åŠ è½½æç¤ºè¯å†å²è®°å½•å¤±è´¥:', error);
                    }
                };

                const getAuthHeaders = () => {
                    const headers = {
                        'Content-Type': 'application/json'
                    };

                    const token = localStorage.getItem('accessToken');
                    if (token) {
                        headers['Authorization'] = `Bearer ${token}`;
                        console.log('ä½¿ç”¨Tokenè¿›è¡Œè®¤è¯:', token.substring(0, 20) + '...');
                    } else {
                        console.warn('æ²¡æœ‰æ‰¾åˆ°accessToken');
                    }
                    return headers;
                };

                // éªŒè¯tokenæ˜¯å¦æœ‰æ•ˆ
                const validateToken = async (token) => {
                    try {
                        const response = await fetch('./api/v1/model/list', {
                            method: 'GET',
                            headers: {
                                'Authorization': `Bearer ${token}`,
                                'Content-Type': 'application/json'
                            }
                        });
                        return response.ok;
                    } catch (error) {
                        console.error('Token validation failed:', error);
                        return false;
                    }
                };

                // å¢å¼ºçš„APIè¯·æ±‚å‡½æ•°ï¼Œè‡ªåŠ¨å¤„ç†è®¤è¯é”™è¯¯
                const apiRequest = async (url, options = {}) => {
                    const headers = getAuthHeaders();

                    try {
                        const response = await fetch(url, {
                            ...options,
                            headers: {
                                ...headers,
                                ...options.headers
                            }
                        });

                        // æ£€æŸ¥æ˜¯å¦æ˜¯è®¤è¯é”™è¯¯
                        if (response.status === 401 || response.status === 403) {
                            // Tokenæ— æ•ˆï¼Œæ¸…é™¤æœ¬åœ°å­˜å‚¨å¹¶è·³è½¬åˆ°ç™»å½•é¡µ
                            logout();
                            showAlert('ç™»å½•å·²è¿‡æœŸï¼Œè¯·é‡æ–°ç™»å½•', 'warning');
                            return null;
                        }

                        return response;
                    } catch (error) {
                        console.error('API request failed:', error);
                        showAlert('ç½‘ç»œè¯·æ±‚å¤±è´¥', 'danger');
                        return null;
                    }
                };

                // ä¾§è¾¹æ æ‹–æ‹½è°ƒæ•´åŠŸèƒ½
                const sidebar = ref(null);
                let isResizing = false;
                let startX = 0;
                let startWidth = 0;

                const startResize = (e) => {
                    e.preventDefault();

                    // åœ¨å°å±å¹•æ—¶ç¦ç”¨æ‹–æ‹½è°ƒæ•´
                    const windowWidth = window.innerWidth;
                    if (windowWidth <= 1200) {
                        return;
                    }

                    isResizing = true;
                    startX = e.clientX;
                    startWidth = sidebar.value.offsetWidth;

                    document.body.classList.add('resizing');
                    document.addEventListener('mousemove', handleResize);
                    document.addEventListener('mouseup', stopResize);
                };

                const handleResize = (e) => {
                    if (!isResizing) return;

                    // åœ¨å°å±å¹•æ—¶åœæ­¢æ‹–æ‹½è°ƒæ•´
                    const windowWidth = window.innerWidth;
                    if (windowWidth <= 1200) {
                        stopResize();
                        return;
                    }

                    const deltaX = e.clientX - startX;
                    const newWidth = startWidth + deltaX;
                    const minWidth = 200;
                    const maxWidth = 500;

                    if (newWidth >= minWidth && newWidth <= maxWidth) {
                        sidebar.value.style.width = newWidth + 'px';
                        // åŒæ—¶è°ƒæ•´ä¸»å†…å®¹åŒºåŸŸå®½åº¦
                        const mainContent = document.querySelector('main');
                        if (mainContent) {
                            mainContent.style.width = `calc(100% - ${newWidth}px)`;
                        }
                    }
                };

                const stopResize = () => {
                    isResizing = false;
                    document.body.classList.remove('resizing');
                    document.removeEventListener('mousemove', handleResize);
                    document.removeEventListener('mouseup', stopResize);

                    // ä¿å­˜å½“å‰å®½åº¦åˆ°localStorage
                    if (sidebar.value) {
                        localStorage.setItem('sidebarWidth', sidebar.value.offsetWidth);
                    }
                };

                // åº”ç”¨å“åº”å¼ä¾§è¾¹æ å®½åº¦
                const applyResponsiveWidth = () => {
                    if (!sidebar.value) return;

                    const windowWidth = window.innerWidth;
                    let sidebarWidth;

                    if (windowWidth <= 768) {
                        sidebarWidth = '200px';
                    } else if (windowWidth <= 1200) {
                        sidebarWidth = '250px';
                    } else {
                        // å¤§å±å¹•æ—¶ä½¿ç”¨ä¿å­˜çš„å®½åº¦æˆ–é»˜è®¤å®½åº¦
                        const savedWidth = localStorage.getItem('sidebarWidth');
                        if (savedWidth) {
                            const width = parseInt(savedWidth);
                            if (width >= 200 && width <= 500) {
                                sidebarWidth = width + 'px';
                            } else {
                                sidebarWidth = '256px'; // é»˜è®¤ w-64
                            }
                        } else {
                            sidebarWidth = '256px'; // é»˜è®¤ w-64
                        }
                    }

                    sidebar.value.style.width = sidebarWidth;
                    const mainContent = document.querySelector('main');
                    if (mainContent) {
                        mainContent.style.width = `calc(100% - ${sidebarWidth})`;
                    }
                };

                // æ¢å¤ä¿å­˜çš„ä¾§è¾¹æ å®½åº¦
                onMounted(() => {
                    applyResponsiveWidth();

                    // ç›‘å¬çª—å£å¤§å°å˜åŒ–
                    window.addEventListener('resize', applyResponsiveWidth);
                });

                return {
                    isLoggedIn,
                    loading,
                    loginWithGitHub,
                    submitting,
                    showCreator,
                    searchQuery,
                    currentUser,
                    models,
                    tasks,
                    alert,
                    t2vForm,
                    i2vForm,
                    digitalHumanForm,
                    getCurrentForm,
                    i2vImagePreview,
                    digitalHumanImagePreview,
                    digitalHumanAudioPreview,
                    getCurrentImagePreview,
                    getCurrentAudioPreview,
                    availableTaskTypes,
                    availableModelClasses,
                    filteredTasks,
                    selectedTaskId,
                    selectedTask,
                    selectedTaskFiles,
                    loadingTaskFiles,
                    statusFilter,
                    pagination,
                    currentPage,
                    pageSize,
                    showAlert,
                    setLoading,
                    apiCall,
                    logout,
                    loadModels,
                    generatingThumbnails,
                    sidebarCollapsed,
                    thumbnailCache,
                    thumbnailCacheLoaded,
                    loadTaskFiles,
                    downloadFile,
                    viewFile,
                    handleImageUpload,
                    selectTask,
                    selectModel,
                    triggerImageUpload,
                    triggerAudioUpload,
                    removeImage,
                    removeAudio,
                    handleAudioUpload,
                    loadTemplates,
                    selectImageTemplate,
                    selectAudioTemplate,
                    previewAudioTemplate,
                    imageTemplates,
                    audioTemplates,
                    showImageTemplates,
                    showAudioTemplates,
                    showTemplates,
                    showHistory,
                    submitTask,
                    fileToBase64,
                    formatTime,
                    refreshTasks,
                    preloadThumbnailCache,
                    preloadThumbnailsIndividually,
                    loadImageWithRetry,
                    getStatusBadgeClass,
                    downloadSingleResult,
                    viewSingleResult,
                    cancelTask,
                    resumeTask,
                    viewTaskDetail,
                    showTaskCreator,
                    toggleSidebar,
                    clearPrompt,
                    getTaskItemClass,
                    getStatusIndicatorClass,
                    getTaskTypeBtnClass,
                    getModelBtnClass,
                    getTaskTypeIcon,
                    getTaskTypeName,
                    getPromptPlaceholder,
                    getStatusTextClass,
                    getImagePreview,
                    getTaskInputUrl,
                    getVideoThumbnail,
                    getVideoThumbnailInfo,
                    loadThumbnailAsync,
                    handleThumbnailError,
                    handleImageError,
                    handleImageLoad,
                    handleAudioError,
                    handleAudioLoad,
                    downloadTaskInput,
                    getVideoUrl,
                    getTaskStatusDisplay,
                    getTaskStatusColor,
                    getTaskStatusIcon,
                    getTaskDuration,
                    getRelativeTime,
                    getTaskHistory,
                    getActiveTasks,
                    searchTasks,
                    filterTasksByStatus,
                    filterTasksByType,
                    getAlertClass,
                    getAlertBorderClass,
                    getAlertTextClass,
                    getAlertIcon,
                    getPromptTemplates,
                    showPromptTemplates,
                    showPromptHistory,
                    selectPromptTemplate,
                    promptHistory,
                    getPromptHistory,
                    addPromptToHistory,
                    selectPromptHistory,
                    clearPromptHistory,
                    loadPromptHistory,
                    getAudioMimeType,
                    getAuthHeaders,
                    sidebar,
                    startResize
                };
            }
        }).mount('#app');
    </script>
</body>
</html>
