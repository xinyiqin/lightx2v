<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ t('title') }}</title>
    <link rel="icon" type="image/png" href="/icon/logoblack.png">
    <link rel="shortcut icon" type="image/png" href="/icon/logoblack.png">
    <link rel="apple-touch-icon" href="/icon/logoblack.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- ‰∏ªË¶ÅÂõæÊ†áÂ∫ì -->
    <link href="https://cdn.bootcdn.net/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <!-- Â§áÁî®ÂõæÊ†áÂ∫ì -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"
        media="print" onload="this.media='all'">
    <!-- Êú¨Âú∞Â§áÁî®ÂõæÊ†áÔºàÂ¶ÇÊûúCDNÈÉΩÂ§±Ë¥•Ôºâ -->
    <link rel="stylesheet" href="/static/styles.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#9a72ff', // ‰∏ªÁ¥´Ëâ≤
                        secondary: '#1b1240', // Ê∑±Á¥´Ëâ≤ËÉåÊôØ
                        accent: '#b78bff', // ‰∫ÆÁ¥´Ëâ≤Âº∫Ë∞É
                        dark: '#0b0a20', // Ê∑±Ëâ≤ËÉåÊôØ
                        'dark-light': '#0f0e22', // Á®ç‰∫ÆÁöÑÊ∑±Ëâ≤
                        'laser-purple': '#9a72ff', // ÊøÄÂÖâÁ¥´Ëâ≤
                        'neon-purple': '#b78bff', // ÈúìËôπÁ¥´Ëâ≤
                        'electric-purple': '#7c6aff', // ÁîµÂÖâÁ¥´Ëâ≤
                    },
                    fontFamily: {
                        inter: ['Inter', 'sans-serif'],
                    },
                    boxShadow: {
                        'neon': '0 0 10px rgba(154, 114, 255, 0.5), 0 0 20px rgba(154, 114, 255, 0.3)',
                        'neon-lg': '0 0 15px rgba(154, 114, 255, 0.7), 0 0 30px rgba(154, 114, 255, 0.5)',
                        'laser': '0 0 20px rgba(154, 114, 255, 0.8), 0 0 40px rgba(154, 114, 255, 0.6), 0 0 60px rgba(154, 114, 255, 0.4), 0 0 80px rgba(154, 114, 255, 0.2)',
                        'laser-intense': '0 0 25px rgba(154, 114, 255, 0.9), 0 0 50px rgba(154, 114, 255, 0.7), 0 0 75px rgba(154, 114, 255, 0.5), 0 0 100px rgba(154, 114, 255, 0.3), 0 0 125px rgba(154, 114, 255, 0.1)',
                        'electric': '0 0 15px rgba(124, 106, 255, 0.8), 0 0 30px rgba(124, 106, 255, 0.6), 0 0 45px rgba(124, 106, 255, 0.4)'
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">

        [v-cloak] { display: none; }
        
        /* ÂáèÂ∞ëÁôªÂΩïÈ°µÈù¢Èó™ÁÉÅ */
        .login-container {
            transition: opacity 0.3s ease-in-out;
        }
        
        .main-container {
            transition: opacity 0.3s ease-in-out;
        }
        
        /* Èò≤Ê≠¢ÁøªËØëÈó™ÁÉÅ */
        .app-loading {
            opacity: 0;
            transition: opacity 0.2s ease-in-out;
        }
        
        .app-loaded {
            opacity: 1;
        }
        /* Á°Æ‰øùhtmlÂíåbodyËÉΩÂ§üÊ≠£Á°ÆÂ°´ÂÖÖ */
        html {
            height: 100%;
        }

        /* Á°Æ‰øùbodyÂíåappÂÆπÂô®ËÉΩÂ§üÊ≠£Á°ÆÂ°´ÂÖÖ */
        body {
            margin: 0;
            padding: 0;
            width: 125vw;
            height: 125vh;
            overflow-x: hidden;
            overflow-y: auto;
            /* Êï¥‰ΩìÁº©Êîæ80% */
            transform: scale(0.8);
            transform-origin: top left;
        }


        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .text-gradient {
                background-clip: text;
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
            }
            /* Êñ∞Â¢ûÊ∏êÂèòÂõæÊ†áÈ¢úËâ≤Á±ª */
            .text-gradient-icon {
                background: linear-gradient(135deg, #d2c1ff, #a88bff, #8e88ff);
                -webkit-background-clip: text;
                background-clip: text;
                -webkit-text-fill-color: transparent;
            }
            .scrollbar-thin {
                scrollbar-width: thin;
            }
            .scrollbar-thin::-webkit-scrollbar {
                width: 6px;
                height: 6px;
            }
            .scrollbar-thin::-webkit-scrollbar-thumb {
                background-color: rgba(210, 193, 255, 0.6);
                border-radius: 3px;
            }
            .scrollbar-thin::-webkit-scrollbar-track {
                background-color: rgba(31, 41, 55, 0.3);
                border-radius: 3px;
            }
            .scrollbar-thin::-webkit-scrollbar-thumb:hover {
                background-color: rgba(210, 193, 255, 0.8);
            }

            /* Ëá™ÂÆö‰πâÊªöÂä®Êù°È¢úËâ≤ */
            .scrollbar-thumb-laser-purple\/30::-webkit-scrollbar-thumb {
                background-color: rgba(168, 85, 247, 0.3);
            }
            .scrollbar-track-gray-800\/30::-webkit-scrollbar-track {
                background-color: rgba(31, 41, 55, 0.3);
            }

            /* ÂéÜÂè≤‰ªªÂä°Âå∫ÂüüÊªöÂä®Êù°Ê†∑Âºè - ‰∏é‰∏ªÂÜÖÂÆπÂå∫Âüü‰øùÊåÅ‰∏ÄËá¥ */
            .history-tasks-scroll::-webkit-scrollbar {
                width: 8px !important;
            }

            .history-tasks-scroll::-webkit-scrollbar-track {
                background: rgba(27, 18, 64, 0.3) !important;
                border-radius: 4px;
            }

            .history-tasks-scroll::-webkit-scrollbar-thumb {
                background: linear-gradient(135deg, rgba(210, 193, 255, 0.8), rgba(168, 139, 255, 0.8)) !important;
                border-radius: 4px;
                border: 1px solid rgba(210, 193, 255, 0.3);
            }

            .history-tasks-scroll::-webkit-scrollbar-thumb:hover {
                background: linear-gradient(135deg, rgba(210, 193, 255, 1), rgba(168, 139, 255, 1)) !important;
            }

            /* Á°Æ‰øùÂéÜÂè≤‰ªªÂä°Âå∫ÂüüÂèØ‰ª•Ê≠£Â∏∏ÊªöÂä® */
            .history-tasks-scroll {
                scroll-behavior: smooth;
                -webkit-overflow-scrolling: touch;
                /* ÁßªÈô§max-heightÈôêÂà∂ÔºåËÆ©flex-1Âç†ÊçÆÊâÄÊúâÂèØÁî®Á©∫Èó¥ */
            }

            /* ‰∏ªÂÜÖÂÆπÂå∫ÂüüÊªöÂä®Êù°Ê†∑Âºè */
            .content-area::-webkit-scrollbar {
                width: 8px;
            }

            .content-area::-webkit-scrollbar-track {
                /* background: rgba(27, 18, 64, 0.3); */
                border-radius: 4px;
            }

            .content-area::-webkit-scrollbar-thumb {
                background: linear-gradient(135deg, rgba(210, 193, 255, 0.8), rgba(168, 139, 255, 0.8));
                border-radius: 4px;
                border: 1px solid rgba(210, 193, 255, 0.3);
            }

            .content-area::-webkit-scrollbar-thumb:hover {
                background: linear-gradient(135deg, rgba(210, 193, 255, 1), rgba(168, 139, 255, 1));
            }

            /* Á°Æ‰øùÂÜÖÂÆπÂèØ‰ª•Ê≠£Â∏∏ÊªöÂä® */
            .content-area {
                scroll-behavior: smooth;
                -webkit-overflow-scrolling: touch;
            }
            .animate-pulse-slow {
                animation: pulse 3s cubic-bezier(0.4, 0, 0.6, 0.5) infinite;
            }
            .animate-electric-pulse {
                animation: electricPulse 1.5s ease-in-out infinite;
            }
            @keyframes electricPulse {
                0%, 100% {
                    box-shadow: 0 0 15px rgba(142, 136, 255, 0.8), 0 0 30px rgba(142, 136, 255, 0.6);
                    transform: scale(1);
                }
                50% {
                    box-shadow: 0 0 25px rgba(142, 136, 255, 1), 0 0 50px rgba(142, 136, 255, 0.8), 0 0 75px rgba(142, 136, 255, 0.4);
                    transform: scale(1.02);
                }
            }
            .bg-laser-gradient {
                background: linear-gradient(135deg, #d2c1ff 0%, #a88bff 25%, #8e88ff 50%, #d2c1ff 75%, #a88bff 100%);
                background-size: 200% 200%;
                animation: gradientShift 3s ease-in-out infinite;
            }
            @keyframes gradientShift {
                0%, 100% { background-position: 0% 50%; }
                50% { background-position: 100% 50%; }
            }
            .text-laser-glow {
                text-shadow: 0 0 10px rgba(154, 114, 255, 0.8), 0 0 20px rgba(154, 114, 255, 0.6), 0 0 30px rgba(154, 114, 255, 0.4);
            }
            .border-laser {
                border-color: #d2c1ff;
                box-shadow: 0 0 15px rgba(154, 114, 255, 0.6), inset 0 0 15px rgba(154, 114, 255, 0.1);
            }
            .btn-primary{
                padding: 15px 25px;
                border-radius: 14px;
                font-weight: 500;
                font-size: 14px;
                letter-spacing: 0.2px;
                font-family: 'Inter', sans-serif;
                background: linear-gradient(135deg, #d2c1ff, #a88bff, #8e88ff);
                border: 0;
                text-decoration: none;
                box-shadow: 0 10px 30px rgba(140, 110, 255, 0.4);
                transition: transform 0.15s ease, box-shadow 0.15s ease;
            }
            .btn-primary:hover{
                transform: translateY(-1px);
                box-shadow: 0 14px 40px rgba(140, 110, 255, 0.55);
            }

            /* ‰øÆÂ§çÂ∏ÉÂ±ÄÈóÆÈ¢ò */
            .task-type-btn {
                padding: 0.75rem 1rem;
                font-size: 0.875rem;
                font-weight: 500;
                transition-property: color, background-color;
                transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
                transition-duration: 150ms;
            }

            .task-type-btn:hover {
                background-color: rgba(154, 114, 255, 0.1);
            }

            .model-selection {
                display: flex;
                flex-wrap: wrap;
                gap: 0.5rem;
            }

            .upload-section {
                display: grid;
                grid-template-columns: repeat(1, minmax(0, 1fr));
                gap: 1.5rem;
                margin-bottom: 1.5rem;
            }

            @media (min-width: 768px) {
                .upload-section {
                    grid-template-columns: repeat(2, minmax(0, 1fr));
                }
            }

            .upload-area {
                position: relative;
                border: 2px dashed rgba(154, 114, 255, 0.4);
                border-radius: 0.75rem;
                padding: 1.5rem;
                text-align: center;
                justify-content: center;
                align-items: center;
                transition-property: all;
                transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
                transition-duration: 150ms;
                cursor: pointer;
                height: 30vh;
                background-color: rgba(27, 18, 64, 0.1);
            }

            /* ÂÖâÁêÉÊåâÈíÆÊ†∑Âºè */
            .floating-orb-btn {
                position: relative;
                width: 100px;
                height: 100px;
                border-radius: 50%;
                background: linear-gradient(135deg, #9a72ff, #a855f7, #ec4899);
                border: none;
                cursor: pointer;
                transition: all 0.3s ease;
                overflow: hidden;
                box-shadow: 0 4px 20px rgba(154, 114, 255, 0.4);
            }

            .floating-orb-btn:hover {
                transform: scale(1.1);
                box-shadow: 0 0 40px rgba(154, 114, 255, 0.8), 0 0 80px rgba(154, 114, 255, 0.6);
            }

            .orb-glow {
                position: absolute;
                inset: -15px;
                border-radius: 50%;
                background: radial-gradient(circle, rgba(154, 114, 255, 0.3) 0%, transparent 70%);
                animation: pulse 2s infinite;
            }

            .orb-content {
                position: relative;
                z-index: 2;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                height: 100%;
                color: white;
            }

            @keyframes pulse {
                0%, 100% { opacity: 0.5; transform: scale(1); }
                50% { opacity: 0.8; transform: scale(1.05); }
            }

            /* Âàõ‰ΩúÂå∫ÂüüÊ†∑Âºè */
            .creation-area {
                opacity: 0;
                transform: scale(0.8) translateY(20px);
                pointer-events: none;
                transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
                transform-origin: center center;
            }

            .creation-area.show {
                opacity: 1;
                transform: scale(1) translateY(0);
                pointer-events: auto;
            }

            .creation-area.hide {
                opacity: 0;
                transform: scale(0.8) translateY(20px);
                pointer-events: none;
            }

            /* ÊèêÁ§∫ÊñáÂ≠óÊ∑°ÂÖ•Âä®Áîª */
            .animate-fade-in {
                animation: fadeIn 0.5s ease-in-out;
            }

            @keyframes fadeIn {
                from {
                    opacity: 0;
                    transform: translateY(10px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }

            /* ÊèêÁ§∫ÊñáÂ≠óÊªöÂä®Âä®Áîª */
            .hint-fade-enter-active, .hint-fade-leave-active {
                transition: all 0.5s ease-in-out;
            }
            .hint-fade-enter-from {
                opacity: 0;
                transform: translateY(20px);
            }
            .hint-fade-leave-to {
                opacity: 0;
                transform: translateY(-20px);
            }

            .upload-area:hover {
                border-color: rgba(154, 114, 255, 0.7);
                box-shadow: 0 0 20px rgba(154, 114, 255, 0.8), 0 0 40px rgba(154, 114, 255, 0.6), 0 0 60px rgba(154, 114, 255, 0.4), 0 0 80px rgba(154, 114, 255, 0.2);
            }

            .upload-icon {
                margin: 0 auto;
                width: 4rem;
                height: 4rem;
                background-color: rgba(154, 114, 255, 0.2);
                border-radius: 9999px;
                display: flex;
                align-items: center;
                justify-content: center;
                margin-bottom: 1rem;
                transition-property: all;
                transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
                transition-duration: 150ms;
            }

            .upload-icon {
                background-color: rgba(154, 114, 255, 0.3);
            }

            /* ÂõæÁâáÈ¢ÑËßàÂç†ÊçÆÊï¥‰∏™‰∏ä‰º†Âå∫Âüü */
            .image-preview {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                overflow: hidden;
                z-index: 10;
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: pointer;
            }

            .image-preview img {
                height: 100%;
                width: auto;
                max-width: 100%;
                display: block;
                margin: 0 auto;
                object-fit: contain;
                transition: all 0.3s ease;
            }

            /* Èü≥È¢ëÈ¢ÑËßàÂç†ÊçÆÊï¥‰∏™‰∏ä‰º†Âå∫Âüü */
            .audio-preview {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                border-radius: 0.75rem;
                overflow: hidden;
                z-index: 10;
                display: flex;
                align-items: center;
                justify-content: center;
                background-color: rgba(154, 114, 255, 0.1);
                border: 2px solid rgba(154, 114, 255, 0.3);
                cursor: pointer;
            }

            .audio-preview audio {
                width: 90%;
                height: 60px;
                max-height: 80%;
                border-radius: 0.5rem;
                background-color: rgba(27, 18, 64, 0.3);
                display: block;
            }

            /* Á°Æ‰øùÈü≥È¢ëÊéß‰ª∂Âú®ÂÆπÂô®‰∏≠Ê≠£Á°ÆÊòæÁ§∫ */
            .audio-preview audio::-webkit-media-controls {
                background-color: rgba(27, 18, 64, 0.5);
                border-radius: 0.5rem;
            }

            /* ‰∏ä‰º†ÂÜÖÂÆπÊ†∑Âºè */
            .upload-content {
                width: 100%;
                height: 100%;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
            }

            .btn-close {
                position: absolute;
                top: 0.5rem;
                right: 0.5rem;
                background-color: #ef4444;
                color: white;
                border-radius: 9999px;
                width: 1.5rem;
                height: 1.5rem;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 0.75rem;
                cursor: pointer;
                z-index: 20;
                box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            }

            /* Á°Æ‰øùflexboxÂ∏ÉÂ±ÄÊ≠£Á°Æ */
            #app {
                display: flex;
                width: 100%;
                height: 100%;
            }

            .bg-linear-dark {
                background-color: linear-gradient(135deg, #0b0a20 0%, #1b1240 50%, #0f0e22 100%);
            }

            aside {
                flex-shrink: 0;
                width: 280px; /* ÈªòËÆ§Â±ïÂºÄÂÆΩÂ∫¶ */
                min-width: 3rem; /* ÊúÄÂ∞èÂÆΩÂ∫¶ */
                max-width: 500px; /* ÊúÄÂ§ßÂÆΩÂ∫¶ */
                background-color: transparent;
                border-right: 1px solid rgba(154, 114, 255, 0.4);
                display: flex;
                flex-direction: column;
                transition-property: all;
                transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
                transition-duration: 300ms;
                z-index: 10;
                position: relative;
            }

            /* ÊãñÊãΩË∞ÉÊï¥Âô® */
            .resize-handle {
                position: absolute;
                top: 0;
                right: 0;
                width: 6px;
                height: 100%;
                background: transparent;
                cursor: col-resize;
                z-index: 50;
                transition: background-color 0.2s ease;
            }

            .resize-handle:hover {
                background: rgba(154, 114, 255, 0.5);
            }

            .resize-handle:active {
                background: rgba(154, 114, 255, 0.8);
            }

            /* Á°Æ‰øùÊãñÊãΩÊâãÊüÑÂèØËßÅ */
            .resize-handle::before {
                content: '';
                position: absolute;
                top: 50%;
                right: 1px;
                width: 2px;
                height: 20px;
                background: rgba(154, 114, 255, 0.3);
                transform: translateY(-50%);
                border-radius: 1px;
            }

            /* ÊãñÊãΩÊó∂ÁöÑËßÜËßâÂèçÈ¶à */
            .resizing {
                user-select: none;
                pointer-events: none;
            }

            .resizing * {
                pointer-events: none;
            }

            main {
                flex: 1;
                display: flex;
                flex-direction: column;
                min-width: 0;
                width: calc(100% - 280px); /* ‰∏ªÂÜÖÂÆπÂå∫ÂüüÂç†ÊçÆÂâ©‰ΩôÂÆΩÂ∫¶ÔºåÈÄÇÂ∫îÂ±ïÂºÄÁöÑ‰æßËæπÊ†è */
                height: 100%;
            }

            /* ÂÜÖÂÆπÂå∫ÂüüÂÖ®Â±èÊòæÁ§∫ */
            .content-area {
                flex: 1;
                overflow-y: auto;
                /* background-color: #0b0a20; */
                padding: 1rem;
                width: 100%;
                min-height: 0; /* Á°Æ‰øùflexÂ≠êÂÖÉÁ¥†ÂèØ‰ª•Êî∂Áº© */
            }

            /* ‰ªªÂä°ÂàõÂª∫Èù¢ÊùøÂÖ®Â±è */
            #task-creator {
                max-width: none;
                width: 80%;
            }

            #inspiration-gallery {
                max-width: none;
                width: 80%;
                padding: 0 1rem;
            }

            /* ‰ªªÂä°ËØ¶ÊÉÖÈù¢ÊùøÂÖ®Â±è */
            .task-detail-panel {
                max-width: none;
                width: 80%;
                padding: 0 0rem;
            }

            /* ‰∏ä‰º†Âå∫ÂüüÂÖ®Â±èÂ∏ÉÂ±Ä */
            .upload-section {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
                gap: 2rem;
                margin-bottom: 2rem;
                width: 100%;
            }

            /* ‰ªªÂä°Á±ªÂûãÈÄâÊã©ÂÖ®Â±è */
            .task-type-selection {
                width: 100%;
                margin-bottom: 2rem;
            }

            .task-type-buttons {
                display: flex;
                width: 100%;
                border-bottom: 1px solid rgba(154, 114, 255, 0.3);
            }

            .task-type-btn {
                flex: 1;
                padding: 1rem 1.5rem;
                font-size: 1rem;
                font-weight: 500;
                transition-property: color, background-color;
                transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
                transition-duration: 150ms;
                text-align: center;
            }

            /* Ê®°ÂûãÈÄâÊã©ÂÖ®Â±è */
            .model-selection {
                display: flex;
                flex-wrap: wrap;
                gap: 1rem;
                width: 100%;
                justify-content: flex-start;
            }

            /* ÊèêÁ§∫ËØçËæìÂÖ•ÂÖ®Â±è */
            .prompt-input-section {
                width: 100%;
                margin-bottom: 2rem;
            }

            .prompt-textarea {
                width: 100%;
                min-height: 150px;
                resize: vertical;
            }

            /* ÂéÜÂè≤‰ªªÂä°Âå∫ÂüüÊî∂Ëµ∑Ê†∑Âºè */
            .sidebar-collapsed .history-tasks-section {
                display: none !important;
            }

            /* ‰æßËæπÊ†èÂ±ïÂºÄÊ†∑Âºè */
            aside {
                width: 280px !important;
            }

            .sidebar-collapsed .sidebar-content {
                display: none !important;
            }

            .sidebar-collapsed .resize-handle {
                display: none !important;
            }

            .sidebar-collapsed .user-info-section {
                display: none !important;
            }

            .sidebar-collapsed .sidebar-header {
                justify-content: center;
                padding: 1rem 0.5rem;
            }

            .sidebar-collapsed .sidebar-header h1 {
                display: none;
            }

            /* Â±ïÂºÄÁä∂ÊÄÅ‰∏ãÊòæÁ§∫ÊâÄÊúâÂÜÖÂÆπ */
            aside:not(.sidebar-collapsed) .sidebar-content {
                display: flex !important;
            }

            aside:not(.sidebar-collapsed) .resize-handle {
                display: block !important;
            }

            aside:not(.sidebar-collapsed) .sidebar-header {
                justify-content: space-between;
                padding: 1rem;
            }

            aside:not(.sidebar-collapsed) .sidebar-header h1 {
                display: flex;
            }

            aside:not(.sidebar-collapsed) .sidebar-header .toggle-btn {
                display: flex !important;
                align-items: center;
                justify-content: center;
            }

            aside:not(.sidebar-collapsed) .user-info-section {
                display: block !important;
            }

            .sidebar-collapsed .sidebar-header .toggle-btn {
                display: flex !important;
                align-items: center;
                justify-content: center;
                width: 2rem;
                height: 2rem;
                border-radius: 0.375rem;
                background-color: rgba(154, 114, 255, 0.1);
                border: 1px solid rgba(154, 114, 255, 0.3);
                margin: 0 auto;
            }

            /* ÂΩìÂéÜÂè≤‰ªªÂä°Âå∫ÂüüÊäòÂè†Êó∂Ôºå‰∏ªÂÜÖÂÆπÂå∫ÂüüË∞ÉÊï¥ */
            .sidebar-collapsed + main {
                width: calc(100% - 256px); /* Âè™ÂáèÂéªÂõ∫ÂÆöÂå∫ÂüüÁöÑÂÆΩÂ∫¶ */
            }

            /* ÂΩìÂéÜÂè≤‰ªªÂä°Âå∫ÂüüÂ±ïÂºÄÊó∂Ôºå‰∏ªÂÜÖÂÆπÂå∫ÂüüË∞ÉÊï¥ */
            aside:not(.sidebar-collapsed) + main {
                width: calc(100% - 256px); /* ÂáèÂéª‰æßËæπÊ†èÁöÑÂÆΩÂ∫¶ */
            }

            /* ÂìçÂ∫îÂºèËÆæËÆ° */
            @media (max-width: 1200px) {
                aside:not(.sidebar-collapsed) {
                    width: 250px !important;
                }

                .sidebar-collapsed + main {
                    width: calc(100% - 250px);
                }

                aside:not(.sidebar-collapsed) + main {
                    width: calc(100% - 250px);
                }
            }

            @media (max-width: 768px) {
                aside:not(.sidebar-collapsed) {
                    width: 200px !important;
                }

                .sidebar-collapsed + main {
                    width: calc(100% - 200px);
                }

                aside:not(.sidebar-collapsed) + main {
                    width: calc(100% - 200px);
                }

                .upload-section {
                    grid-template-columns: 1fr;
                }
            }


            /* ÂàÜÈ°µÁªÑ‰ª∂Ê†∑Âºè */
            .pagination-container {
                border-bottom: 1px solid rgba(154, 114, 255, 0.15);
                padding-bottom: 0.5rem;
            }

            .pagination-btn-compact {
                @apply px-1.5 py-0.5 rounded text-xs transition-all duration-200;
                background: rgba(27, 18, 64, 0.2);
                border: 1px solid rgba(154, 114, 255, 0.2);
                color: rgba(255, 255, 255, 0.6);
                min-width: 20px;
                height: 20px;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 10px;
            }

            .pagination-btn-compact:hover:not(.disabled) {
                background: rgba(154, 114, 255, 0.15);
                border-color: rgba(154, 114, 255, 0.4);
                color: rgba(255, 255, 255, 0.8);
                transform: translateY(-0.5px);
            }

            .pagination-btn-compact.active {
                background: linear-gradient(135deg, rgba(154, 114, 255, 0.6), rgba(168, 139, 255, 0.6));
                border-color: rgba(154, 114, 255, 0.6);
                color: white;
                box-shadow: 0 0 6px rgba(154, 114, 255, 0.4);
            }

            .pagination-btn-compact.disabled {
                opacity: 0.3;
                cursor: not-allowed;
                background: rgba(27, 18, 64, 0.05);
                border-color: rgba(154, 114, 255, 0.05);
                color: rgba(255, 255, 255, 0.2);
            }

            .pagination-btn-compact.disabled:hover {
                transform: none;
                background: rgba(27, 18, 64, 0.05);
                border-color: rgba(154, 114, 255, 0.05);
                color: rgba(255, 255, 255, 0.2);
            }

            /* È°µÁ†ÅËæìÂÖ•Ê°ÜÊ†∑Âºè */
            .page-input {
                @apply w-8 h-5 text-center text-xs rounded;
                background: linear-gradient(135deg, rgba(154, 114, 255, 0.3), rgba(168, 139, 255, 0.3));
                border: 1px solid rgba(154, 114, 255, 0.4);
                color: white;
                outline: none;
                transition: all 0.2s ease;
                font-weight: 500;
            }

            .page-input:focus {
                border-color: rgba(154, 114, 255, 0.8);
                background: linear-gradient(135deg, rgba(154, 114, 255, 0.5), rgba(168, 139, 255, 0.5));
                box-shadow: 0 0 6px rgba(154, 114, 255, 0.4);
            }

            .page-input::-webkit-outer-spin-button,
            .page-input::-webkit-inner-spin-button {
                -webkit-appearance: none;
                margin: 0;
            }

            .page-input[type=number] {
                -moz-appearance: textfield;
            }

            /* ‰øÆÂ§çÁä∂ÊÄÅÊåáÁ§∫Âô® */
            .status-indicator {
                width: 0.75rem;
                height: 0.75rem;
                border-radius: 9999px;
                box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            }

            /* ‰øÆÂ§çÊåâÈíÆÊ†∑Âºè */
            .btn-primary {
                padding: 12px 22px;
                border-radius: 14px;
                font-weight: 700;
                letter-spacing: 0.2px;
                color: #0c0920;
                background: linear-gradient(135deg, #d2c1ff, #a88bff, #8e88ff);
                border: 0;
                text-decoration: none;
                box-shadow: 0 10px 30px rgba(140, 110, 255, 0.4);
                transition: transform 0.15s ease, box-shadow 0.15s ease;
                cursor: pointer;
                display: inline-block;
            }

            .btn-primary:hover {
                transform: translateY(-1px);
                box-shadow: 0 14px 40px rgba(140, 110, 255, 0.55);
            }

            /* ‰øÆÂ§çÊ®°ÂûãÊåâÈíÆÊ†∑Âºè */
            .model-btn {
                padding: 0.5rem 1rem;
                border-radius: 0.5rem;
                font-size: 0.875rem;
                transition-property: all;
                transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
                transition-duration: 150ms;
                cursor: pointer;
                border: 1px solid;
            }

            .model-btn.active {
                background-color: rgba(154, 114, 255, 0.2);
                border-color: rgba(154, 114, 255, 0.4);
                box-shadow: 0 0 20px rgba(154, 114, 255, 0.8), 0 0 40px rgba(154, 114, 255, 0.6), 0 0 60px rgba(154, 114, 255, 0.4), 0 0 80px rgba(154, 114, 255, 0.2);
                animation: electricPulse 1.5s ease-in-out infinite;
            }

            /* Á°Æ‰øùÂÜÖÂÆπÂå∫ÂüüÊ≠£Á°ÆÊªöÂä® */
            .content-scroll {
                flex: 1;
                overflow-y: auto;
            }


            /* ‰ªªÂä°ËøõË°å‰∏≠Èù¢ÊùøÊ†∑Âºè */
            .task-running-panel .animate-pulse-slow {
                animation: pulse 3s cubic-bezier(0.4, 0, 0.6, 0.5) infinite;
            }

            /* ËøõÂ∫¶Êù°Ê†∑Âºè */
            .progress-container {
                background: rgba(27, 18, 64, 0.3);
                border-radius: 8px;
                padding: 1rem;
                margin: 1rem 0;
            }

            .progress-bar {
                width: 100%;
                height: 8px;
                background: rgba(154, 114, 255, 0.2);
                border-radius: 4px;
                overflow: hidden;
                position: relative;
            }

            .progress-fill {
                height: 100%;
                background: linear-gradient(90deg, #9a72ff, #a88bff);
                border-radius: 4px;
                transition: width 0.3s ease;
                position: relative;
            }

            .progress-fill::after {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
                animation: shimmer 2s infinite;
            }

            @keyframes shimmer {
                0% { transform: translateX(-100%); }
                100% { transform: translateX(100%); }
            }

            .subtask-item {
                background: rgba(27, 18, 64, 0.2);
                border: 1px solid rgba(154, 114, 255, 0.2);
                border-radius: 8px;
                padding: 0.75rem;
                margin: 0.5rem 0;
            }

            .subtask-header {
                display: flex;
                justify-content: between;
                align-items: center;
                margin-bottom: 0.5rem;
            }

            .subtask-status {
                padding: 0.25rem 0.5rem;
                border-radius: 4px;
                font-size: 0.75rem;
                font-weight: 500;
            }

            .subtask-status.pending {
                background: rgba(251, 191, 36, 0.2);
                color: #fbbf24;
            }

            .subtask-status.running {
                background: rgba(59, 130, 246, 0.2);
                color: #3b82f6;
            }

            .subtask-info {
                font-size: 0.75rem;
                color: rgba(255, 255, 255, 0.6);
                margin-top: 0.25rem;
            }

            /* ‰ªªÂä°Â§±Ë¥•Èù¢ÊùøÊ†∑Âºè */
            .task-failed-panel .bg-red-500\/10 {
                background-color: rgba(239, 68, 68, 0.1);
            }

            .error-details {
                background: rgba(239, 68, 68, 0.1);
                border: 1px solid rgba(239, 68, 68, 0.3);
                border-radius: 8px;
                padding: 1rem;
                margin: 1rem 0;
                text-align: left;
            }

            .error-details pre {
                background: rgba(0, 0, 0, 0.3);
                border-radius: 4px;
                padding: 0.75rem;
                margin: 0.5rem 0 0 0;
                font-size: 0.75rem;
                color: #fca5a5;
                overflow-x: auto;
                white-space: pre-wrap;
                word-break: break-word;
            }

            .subtask-error {
                background: rgba(239, 68, 68, 0.05);
                border-left: 3px solid #ef4444;
                padding: 0.75rem;
                margin: 0.5rem 0;
                border-radius: 0 4px 4px 0;
            }
            
            .subtask-error pre {
                background: #1a1a1a;
                border: 1px solid #dc2626;
                border-radius: 6px;
                padding: 12px;
                margin: 8px 0;
                color: #fca5a5;
                font-size: 12px;
                line-height: 1.4;
                white-space: pre-wrap;
                word-break: break-word;
                max-height: 200px;
                overflow-y: auto;
            }
            
            .error-details {
                animation: slideDown 0.3s ease-out;
            }
            
            @keyframes slideDown {
                from {
                    opacity: 0;
                    transform: translateY(-10px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }


            .task-detail-panel video {
                width: 100%;
                height: 100%;
                object-fit: cover;
            }

            /* Á¥†ÊùêÈ¢ÑËßàÊ†∑Âºè */

            /* ‰ªªÂä°Áä∂ÊÄÅÊåáÁ§∫Âô®Â¢ûÂº∫ */
            .status-indicator {
                position: relative;
            }

            .status-indicator::after {
                content: '';
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                width: 0.25rem;
                height: 0.25rem;
                background-color: currentColor;
                border-radius: 50%;
                opacity: 0.8;
            }


            /* ÂìçÂ∫îÂºè‰ªªÂä°Èù¢Êùø */
            @media (max-width: 768px) {
                .task-detail-panel {
                    padding: 0 0.5rem;
                }
            }

            /* ÊèêÁ§∫Ê∂àÊÅØÂä®Áîª */
            .animate-slide-down {
                animation: slideDown 0.3s ease-out;
            }

            @keyframes slideDown {
                0% {
                    opacity: 0;
                    transform: translate(-50%, -100%);
                }
                100% {
                    opacity: 1;
                    transform: translate(-50%, 0);
                }
            }

            /* ÊèêÁ§∫Ê∂àÊÅØÊ†∑Âºè - Áªü‰∏ÄÊµÖËâ≤ÈÄèÊòéËÉåÊôØ */
            .alert {
                backdrop-filter: blur(15px);
                background: rgba(0, 0, 0, 0.8);
                border-radius: 0.75rem;
                box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
                color: #fff;
            }
        }
 
             
             .floating-toggle-btn {
                 position: fixed;
                 top: 50%;
                 left: 256px; /* ÈªòËÆ§‰ΩçÁΩÆÔºåÂØπÂ∫î w-64 (256px) */
                 transform: translateY(-50%);
                 width: 20px;
                 height: 40px;
                 background: linear-gradient(135deg, #1a1a2e 0%, #2a2a4e 50%, #1e1e3e 100%);
                 border: 1px solid rgba(139, 92, 246, 0.3);
                 border-left: none;
                 border-radius: 0 8px 8px 0;
                 color: #9ca3af;
                 display: flex;
                 align-items: center;
                 justify-content: center;
                 cursor: pointer;
                 transition: background-color 0.3s ease, color 0.3s ease, box-shadow 0.3s ease;
                 z-index: 20;
                 box-shadow: 2px 0 8px rgba(0, 0, 0, 0.3);
             }
             
             .floating-toggle-btn:hover {
                 background: linear-gradient(135deg, #2a2a4e 0%, #3a3a5e 50%, #2e2e4e 100%);
                 color: #8b5cf6;
                 box-shadow: 2px 0 12px rgba(139, 92, 246, 0.3);
             }
             
             .floating-toggle-btn.collapsed {
                 border-radius: 0 8px 8px 0;
                 border-left: 1px solid rgba(139, 92, 246, 0.3);
                 border-right: none;
             }
             
             .resizing .floating-toggle-btn {
                 transition: none !important;
             }
             
             
             .left-glow-zone.show-glow {
                 opacity: 1;
             }
             
             .history-section {
                 max-height: calc(100% - 200px);
                 border-radius: 0 12px 12px 0;
                 border: 2px solid rgba(139, 92, 246, 0.4);
                 box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
                 margin: 8px 8px 8px 0;
                 transition: all 0.3s ease;
                 cursor: pointer;
                 background: rgba(139, 92, 246, 0.05);
             }
             
             .history-section:hover {
                 background: rgba(139, 92, 246, 0.05) !important;
                 border-color: rgba(139, 92, 246, 0.15) !important;
                 box-shadow: 0 0 20px rgba(154, 114, 255, 0.8), 0 0 40px rgba(154, 114, 255, 0.6), 0 0 60px rgba(154, 114, 255, 0.4), 0 0 80px rgba(154, 114, 255, 0.2);
                 transform: translateY(-2px);
             }
             
             .history-section:hover {
                 background: rgba(139, 92, 246, 0.08) !important;
             }
             
                   /* ‰øÆÂ§ç‰ªªÂä°È°πÊ†∑Âºè */
            .task-item {
                border: 1px solid rgba(139, 92, 246, 0.3);
                padding: 0.75rem;
                border-radius: 0.5rem;
                cursor: pointer;
                transition-property: all;
                transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
                transition-duration: 200ms;
                transition: all 0.2s ease;
            }

            .task-item:hover {
                border: 1px solid rgba(167, 132, 255, 0.2);
                background-color: rgba(167, 132, 255, 0.2);
                transform: translateX(5px);
            }

            /* ‰ªªÂä°Êìç‰ΩúËèúÂçïÊ†∑Âºè */
            .task-menu-container {
                position: relative;
            }

            .task-menu-dropdown {
                animation: fadeInUp 0.2s ease-out;
            }

            @keyframes fadeInUp {
                from {
                    opacity: 0;
                    transform: translateY(10px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }

            .task-menu-item {
                transition: all 0.2s ease;
            }

            .task-menu-item:hover {
                transform: translateX(2px);
            }

            /* ËØ≠Ë®ÄÂàáÊç¢Âô®Ê†∑Âºè */
            .language-switcher {
                position: relative;
            }

            .language-switcher button {
                transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            }

            .language-switcher button:hover {
                transform: translateY(-1px);
                box-shadow: 0 4px 12px rgba(154, 114, 255, 0.3);
            }

            .language-switcher .rotate-180 {
                transform: rotate(180deg);
            }

            /* ËØ≠Ë®ÄÈÄâÊã©‰∏ãÊãâËèúÂçïÂä®Áîª */
            .language-switcher .absolute {
                animation: slideDown 0.2s ease-out;
            }

            @keyframes slideDown {
                from {
                    opacity: 0;
                    transform: translateY(-10px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }

            /* ËØ≠Ë®ÄÂàáÊç¢Êó∂ÁöÑÊñáÊú¨ËøáÊ∏°Âä®Áîª */
            .language-transition {
                transition: all 0.3s ease-in-out;
            }


            /* ËØ≠Ë®ÄÈÄâÈ°πÊÇ¨ÂÅúÊïàÊûú */
            .language-switcher .absolute > div:hover {
                background: bg-laser-purple/20;
                transform: translateX(2px);
            }

            /* ÂΩìÂâçÈÄâ‰∏≠ËØ≠Ë®ÄÁöÑÊ†∑Âºè */
            .language-switcher .absolute > div[class*="bg-laser-purple"] {
                background: bg-laser-purple/20;
                border-left: 3px solid #9a72ff;
            }
    </style>
</head>

<body class="text-gray-100 font-inter">

    <div id="app" v-cloak>
        <!-- Âä†ËΩΩÁä∂ÊÄÅ -->
        <div v-if="isLoggedIn === null" class="login-container flex items-center justify-center">
            <div class="text-center">
                <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-laser-purple mx-auto mb-4"></div>
                <p class="text-gray-400">Loading...</p>
            </div>
        </div>

        <!-- ÁôªÂΩïÈ°µÈù¢ -->
        <div v-if="isLoggedIn === false" class="login-container w-full">
            <!-- ÊµÆÂä®Á≤íÂ≠êËÉåÊôØ -->
            <div class="floating-particles">
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
            </div>

            <div class="login-card">
                            <div class="card-body text-center p-5">
                                <!-- LogoÂíåÊ†áÈ¢ò -->
                                <div class="mb-4">
                                    <div class="login-logo">
                                        <i class="fas fa-film me-3"></i>
                                        LightX2V
                                    </div>
                        <p class="login-subtitle">{{ t('loginSubtitle') }}</p>
                                </div>

                                <!-- ÁôªÂΩïÊåâÈíÆ -->
                                <button @click="loginWithGitHub" class="btn btn-github btn-lg w-100 mb-4" :disabled="loginLoading">
                                    <i class="fab fa-github me-2"></i>
                        {{ loginLoading ? t('loggingIn') : t('loginWithGitHub') }}
                                </button>

                                <!-- ÂäüËÉΩÁâπÊÄß -->
                                <div class="login-features">
                                    <div class="feature-item">
                                        <div class="feature-icon">üé≠</div>
                            <span>{{ t('feature1') }}</span>
                                    </div>
                                    <div class="feature-item">
                                        <div class="feature-icon">‚ö°</div>
                            <span>{{ t('feature2') }}</span>
                                    </div>
                                    <div class="feature-item">
                                        <div class="feature-icon">üí∞</div>
                            <span>{{ t('feature3') }}</span>
                                    </div>
                                    <div class="feature-item">
                                        <div class="feature-icon">üéØ</div>
                            <span>{{ t('feature4') }}</span>
                                    </div>
                                    <div class="feature-item">
                                        <div class="feature-icon">üì±</div>
                            <span>{{ t('feature5') }}</span>
                                    </div>
                                    <div class="feature-item">
                                        <div class="feature-icon">üé®</div>
                            <span>{{ t('feature6') }}</span>
                                    </div>
                                </div>
                            </div>
            </div>
        </div>

        <!-- ‰∏ªÂ∫îÁî®È°µÈù¢ -->
        <div v-if="isLoggedIn === true" class="main-container">
        <!-- ÊµÆÂä®Á≤íÂ≠êËÉåÊôØ -->
        <div class="floating-particles">
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
        </div>

        <!-- ‰∏ªÂÜÖÂÆπÂå∫Âüü -->
        <div class="main-content-area flex flex-col relative h-full">
            <!-- È°∂ÈÉ®Ê†è -->
            <div class="top-bar">
                <div class="top-bar-content">
                    <!-- Â∑¶‰æßÂõæÊ†á -->
                    <!-- <div class="top-bar-left">
                        <img src="/icon/seko_logo_white.svg" alt="SekoTalk Logo" class="top-bar-logo">
                    </div> -->
                    <div class="top-bar-left">
                        <i class="fas fa-video text-gradient-icon mr-2 text-xl"></i>
                        <span class="text-lg">LightX2V</span>
                    </div>
                    
                    <!-- Âè≥‰æßÁî®Êà∑‰ø°ÊÅØ -->
                    <div class="top-bar-right">

                            <!-- ËØ≠Ë®ÄÂàáÊç¢ÊåâÈíÆ -->
                            <div class="language-switcher mr-6">
                                <button @click="toggleLanguage"
                                    class="w-10 h-10 bg-laser-purple/10 text-gradient-icon items-center px-1 py-1 rounded-lg bg-dark-light border border-laser-purple/50 hover:border-laser-purple transition-all duration-200 text-sm hover:scale-105"
                                    :title="t('switchLanguage')">
                                    <span class="text-lg">{{ languageOptions.find(lang => lang.code ===
                                        currentLanguage)?.flag }}</span>
                                </button>
                            </div>

                        <div class="user-info">
                            <div class="user-avatar text-gradient-icon">
                                    <img v-if="currentUser.avatar" :src="getUserAvatarUrl(currentUser)"
                                        :alt="currentUser.username" class="avatar-img">
                                <i v-else class="fas fa-user"></i>
                            </div>
                            <div class="user-details">
                                <span class="username">{{ currentUser.username }}</span>
                                <span class="user-email">{{ currentUser.email }}</span>
                            </div>
                                <button @click="logout" class="text-gradient-icon" :title="t('logout')">
                                <i class="fas fa-sign-out-alt"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

                <!-- ‰∏ãÊñπÂå∫Âüü -->
                <div class="flex flex-row relative flex-1 min-h-0">
                    <!-- Â∑¶‰æßÂäüËÉΩÂå∫ -->
                    <div
                        class="relative w-20 pl-5 flex flex-col z-10">
                        <!-- ÂäüËÉΩÂØºËà™ -->
                <div class="p-2 flex flex-col justify-center h-full" style="margin-top: -10vh;">
                            <nav class="space-y-3">
                                <!-- ÁîüÊàêËßÜÈ¢ëÂäüËÉΩ -->
                                <div class="relative group">
                                    <button @click="switchToCreateView"
                                        class="w-12 h-12 flex items-center justify-center rounded-lg transition-all duration-300 font-medium text-sm border border-transparent hover:scale-105 hover:shadow-lg hover:shadow-laser-purple/40"
                                        :class="currentView === 'create' 
                                            ? 'bg-laser-purple/40 text-white border-laser-purple/40 shadow-lg shadow-laser-purple/20' 
                                            : 'text-gray-400 hover:text-gradient-icon'"
                                        :title="t('generateVideo')">
                                        <i class="fas fa-plus text-lg transition-transform duration-300 group-hover:rotate-90"></i>
                    </button>
                </div>

                                <!-- ÊàëÁöÑÈ°πÁõÆÂäüËÉΩ -->
                                <div class="relative group">
                                    <button @click="switchToProjectsView"
                                        class="w-12 h-12 flex items-center justify-center rounded-lg transition-all duration-300 font-medium text-sm border border-transparent hover:scale-105 hover:shadow-lg hover:shadow-laser-purple/20"
                                        :class="currentView === 'projects' 
                                            ? 'bg-laser-purple/40 text-white border-laser-purple/40 shadow-lg shadow-laser-purple/40' 
                                            : 'text-gray-400 hover:text-white hover:bg-dark-light hover:border-laser-purple/30'"
                                        :title="t('myProjects')">
                                        <i class="fas fa-folder text-lg transition-transform duration-300 group-hover:scale-110"></i>
                                    </button>
                                </div>

                                <!-- ÁÅµÊÑüÂπøÂú∫ÂäüËÉΩ -->
                                <div class="relative group">
                                    <button @click="switchToInspirationView"
                                        class="w-12 h-12 flex items-center justify-center rounded-lg transition-all duration-300 font-medium text-sm border border-transparent hover:scale-105 hover:shadow-lg hover:shadow-laser-purple/40"
                                        :class="currentView === 'inspiration' 
                                            ? 'bg-laser-purple/40 text-white border-laser-purple/40 shadow-lg shadow-laser-purple/20' 
                                            : 'text-gray-400 hover:text-white hover:bg-dark-light hover:border-laser-purple/30'"
                                        :title="t('inspiration')">
                                        <i class="fas fa-star text-lg transition-transform duration-300 group-hover:animate-pulse"></i>
                                    </button>
                                </div>
                            </nav>
                        </div>
                    </div>
                            

                    <!-- ÂéÜÂè≤‰ªªÂä°Âå∫Âüü -->
                    <div v-if="currentView === 'projects'" class="flex-1 flex flex-col min-h-0">
                        <!-- ÂÜÖÂÆπÂå∫Âüü -->
                        <div class="flex-1 overflow-y-auto p-10 content-area">
                            <!-- ÂéÜÂè≤‰ªªÂä°ÂäüËÉΩÂå∫ -->
                            <div class="max-w-4xl mx-auto" id="task-creator">
                                <!-- ÊêúÁ¥¢ÂíåÁ≠õÈÄâÂå∫Âüü -->
                                <div class="flex flex-col md:flex-row gap-4 mb-6">
                            <!-- ÊêúÁ¥¢Ê°Ü -->
                                    <div class="relative flex-1">
                                        <i
                                            class="fas fa-search absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none z-10"></i>
                                        <input v-model="taskSearchQuery"
                                            class="w-full bg-dark-light border border-laser-purple/30 rounded-lg py-3 pl-10 pr-4 text-sm focus:outline-none focus:ring-2 focus:ring-laser-purple/50 transition-all focus:border-laser focus:shadow-laser"
                                            :placeholder="t('searchTasks')" type="text" />
                        </div>

                                    <!-- ÂàÜÁ±ªÁ≠õÈÄâ -->
                                    <div class="flex gap-2">
                                        <button @click="statusFilter = 'ALL'"
                                            :class="statusFilter === 'ALL' 
                                                ? 'bg-laser-purple/20 text-white border-laser-purple/40' 
                                                : 'bg-dark-light text-gray-400 hover:text-white hover:bg-dark-light/80'"
                                            class="px-4 py-2 rounded-lg border border-transparent transition-all duration-200 text-sm font-medium">
                                            {{ t('all') }}
                                </button>
                                        <button @click="statusFilter = 'SUCCEED'"
                                            :class="statusFilter === 'SUCCEED' 
                                                ? 'bg-laser-purple/20 text-white border-laser-purple/40' 
                                                : 'bg-dark-light text-gray-400 hover:text-white hover:bg-dark-light/80'"
                                            class="px-4 py-2 rounded-lg border border-transparent transition-all duration-200 text-sm font-medium">
                                            {{ t('success') }}
                                </button>
                                        <button @click="statusFilter = 'RUNNING'"
                                            :class="statusFilter === 'RUNNING' 
                                                ? 'bg-laser-purple/20 text-white border-laser-purple/40' 
                                                : 'bg-dark-light text-gray-400 hover:text-white hover:bg-dark-light/80'"
                                            class="px-4 py-2 rounded-lg border border-transparent transition-all duration-200 text-sm font-medium">
                                            {{ t('running') }}
                                </button>
                                        <button @click="statusFilter = 'FAILED'"
                                            :class="statusFilter === 'FAILED' 
                                                ? 'bg-laser-purple/20 text-white border-laser-purple/40' 
                                                : 'bg-dark-light text-gray-400 hover:text-white hover:bg-dark-light/80'"
                                            class="px-4 py-2 rounded-lg border border-transparent transition-all duration-200 text-sm font-medium">
                                            {{ t('failed') }}
                                </button>
                                        <button @click="() => refreshTasks(true)"
                                    class="text-gray-400 hover:text-gradient-icon transition-colors flex-shrink-0"
                                            :title="t('refreshTasks')">
                                    <i class="fas fa-sync-alt"></i>
                                </button>
                        </div>
                    </div>
                            
                            <!-- ÂàÜÈ°µÁªÑ‰ª∂ -->
                            <div v-cloak>
                                            <div v-if="paginationInfo" :key="paginationKey" class="pagination-container mb-3">
                                    <div class="flex items-center justify-between text-xs text-gray-400">
                                        <div class="flex items-center space-x-1 text-gray-500">
                                                <span>{{ t('total') }} {{ paginationInfo.total }} {{ t('tasks') }}</span>
                        </div>
                                            <div v-if="paginationInfo.total_pages > 1"
                                                class="flex items-center space-x-2">
                                            <!-- ‰∏ä‰∏ÄÈ°µÊåâÈíÆ -->
                                                <button @click="goToPage(currentTaskPage - 1)" :disabled="currentTaskPage <= 1"
                                                class="pagination-btn-compact"
                                                    :class="{ 'disabled': currentTaskPage <= 1 }" :title="t('previousPage')">
                                                <i class="fas fa-chevron-left text-xs"></i>
                                            </button>
                                            
                                            <!-- È°µÁ†ÅËæìÂÖ•Ê°Ü -->
                                            <div class="flex items-center space-x-1">
                                                    <input v-model.number="pageInput" @keyup.enter="jumpToPage"
                                                        @blur="jumpToPage" type="number" :min="1"
                                                        :max="paginationInfo.total_pages" class="page-input"
                                                        :title="t('jumpToPage')" />
                                                <span class="text-gray-500">/</span>
                                                <span class="text-gray-500">{{ paginationInfo.total_pages }}</span>
                            </div>
                                            
                                            <!-- ‰∏ã‰∏ÄÈ°µÊåâÈíÆ -->
                                                <button @click="goToPage(currentTaskPage + 1)"
                                                :disabled="currentTaskPage >= paginationInfo.total_pages"
                                                class="pagination-btn-compact"
                                                :class="{ 'disabled': currentTaskPage >= paginationInfo.total_pages }"
                                                    :title="t('nextPage')">
                                                <i class="fas fa-chevron-right text-xs"></i>
                                            </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                            
                        
                        <!-- ÂèØÊªöÂä®ÁöÑ‰ªªÂä°ÂàóË°®Âå∫Âüü -->
                                <div class="flex-1 overflow-y-auto history-tasks-scroll min-h-0 p-4"
                                    style="overflow-x: visible;">
                            <div v-cloak>
                                        <div v-if="filteredTasks.length === 0"
                                            class="flex-col items-center justify-center py-12 text-center">
                                            <p class="text-gray-400 text-sm">{{ t('noHistoryTasks') }}</p>
                                            <p class="text-gray-500 text-xs mt-1">{{ t('startToCreateYourFirstAIVideo') }}</p>
                                </div>
                                        <div v-else
                                            class="columns-1 md:columns-2 lg:columns-3 xl:columns-4 gap-6">
                                                <!-- ‰ªªÂä°Âç°Áâá -->
                                            <div v-for="task in filteredTasks" :key="task.task_id"
                                                    class="break-inside-avoid mb-6 group relative bg-dark-light rounded-xl overflow-hidden border border-gray-700/50 hover:border-laser-purple/40 transition-all duration-300 hover:shadow-laser/20"
                                                @click="openTaskDetailModal(task)">
                                                    <!-- Áº©Áï•ÂõæÂå∫Âüü -->
                                                    <div class="relative mb-3">
                                                        <div class="w-full h-auto bg-dark-light rounded-lg overflow-hidden">
                                                            <!-- ÊàêÂäü‰ªªÂä°ÔºöÊòæÁ§∫ËßÜÈ¢ëÂä®Âõæ -->
                                                        <video v-if="task.status === 'SUCCEED'"
                                                            :src="getTaskVideoUrl(task.task_id, 'output_video') + '#t=0,5'"
                                                            :poster="getTaskImageUrl(task)"
                                                                class="w-full h-auto object-cover group-hover:scale-105 transition-transform duration-300"
                                                            muted loop preload="auto" playsinline webkit-playsinline
                                                                @mouseenter="playVideo($event)"
                                                                @mouseleave="pauseVideo($event)"
                                                                @loadeddata="onVideoLoaded($event)"
                                                            @error="onVideoError($event)"></video>
                                                            
                                                            <!-- Â§±Ë¥•‰ªªÂä°ÔºöÊòæÁ§∫ËæìÂÖ•ÂõæÁâá -->
                                                        <img v-else-if="task.status !== 'SUCCEED' && getTaskImageUrl(task)"
                                                            :src="getTaskImageUrl(task)" :alt="t('taskPreview')"
                                                                class="w-full h-auto object-cover bg-dark-light transition-transform duration-300 group-hover:scale-105"
                                                            @error="handleThumbnailError" />
                                                            
                                                            <!-- ÂÖ∂‰ªñÁä∂ÊÄÅÔºöÊòæÁ§∫ËæìÂÖ•ÂõæÁâáÊàñÂç†‰ΩçÁ¨¶ -->
                                                        <img v-else-if="getTaskImageUrl(task)"
                                                            :src="getTaskImageUrl(task)" :alt="t('taskPreview')"
                                                                class="w-full h-44 object-cover bg-dark-light transition-transform duration-300 group-hover:scale-105"
                                                            @error="handleThumbnailError" />
                                                        <div v-else
                                                            class="w-full h-44 bg-laser-purple/20 flex items-center justify-center">
                                                                <i class="fas fa-video text-gradient-icon text-4xl"></i>
                                                            </div>
                                    </div>
                                                        
                                                        <!-- Áä∂ÊÄÅÊåáÁ§∫Âô® -->
                                                        <div class="absolute top-2 right-2">
                                                        <span :class="getTaskStatusColor(task.status)"
                                                            class="px-2 py-1 rounded-full text-xs font-medium bg-black/50 backdrop-blur-sm">
                                                                {{ getTaskStatusDisplay(task.status) }}
                                                            </span>
                                                        </div>
                                                        
                                                        <!-- ÊÇ¨ÂÅúÊó∂ÊòæÁ§∫ÁöÑÊìç‰ΩúÊåâÈíÆ -->                
                                                    <div
                                                        class="absolute bottom-2 left-1/2 transform -translate-x-1/2 opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none">
                                                            <div class="flex space-x-3 pointer-events-auto">
                                                <button
                                                                    v-if="['CREATED', 'PENDING', 'RUNNING','SUCCEED', 'FAILED', 'CANCEL'].includes(task.status)"
                                                                    @click.stop="reuseTask(task)"
                                                                    class="w-10 h-10 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center text-white hover:bg-white/30 transition-colors"
                                                                :title="t('reuseTask')">
                                                            <i class="fas fa-copy text-lg"></i>
                                                </button>
                                                        <button
                                                                v-if="['CREATED', 'PENDING', 'RUNNING'].includes(task.status)"
                                                                @click.stop="cancelTask(task.task_id)"
                                                                class="w-10 h-10 rounded-full bg-laser-purple/80 backdrop-blur-sm flex items-center justify-center text-white hover:bg-laser-purple transition-colors"
                                                                :title="t('cancelTask')">
                                                            <i class="fas fa-times text-lg"></i>
                                                        </button>
                                                        <button
                                                                    v-if="['SUCCEED', 'FAILED', 'CANCEL'].includes(task.status)"
                                                                    @click.stop="resumeTask(task.task_id)"
                                                                    class="w-10 h-10 rounded-full bg-laser-purple/80 backdrop-blur-sm flex items-center justify-center text-white hover:bg-laser-purple transition-colors"
                                                                :title="t('retryTask')">
                                                                    <i class="fas fa-redo text-lg"></i>
                                                        </button>
                                                            <button v-if="task.status === 'SUCCEED'"
                                                                    @click.stop="downloadTaskOutput(task)"
                                                                    class="w-10 h-10 rounded-full bg-laser-purple/80 backdrop-blur-sm flex items-center justify-center text-white hover:bg-laser-purple transition-colors"
                                                                :title="t('downloadTask')">
                                                                    <i class="fas fa-download text-lg"></i>
                                                        </button>
                                                        <button
                                                                    v-if="['SUCCEED', 'FAILED', 'CANCEL'].includes(task.status)"
                                                                    @click.stop="deleteTask(task.task_id)"
                                                                    class="w-10 h-10 rounded-full bg-red-400/80 backdrop-blur-sm flex items-center justify-center text-white hover:bg-red-500 transition-colors"
                                                                :title="t('deleteTask')">
                                                                    <i class="fas fa-trash text-lg"></i>
                                                        </button>
                                                </div>
                                            </div>
                                        </div>
                                                    
                                                    <!-- ‰ªªÂä°‰ø°ÊÅØ -->
                                                    <div class="pl-4 pr-4 pb-4">
                                                    <h3 class="text-white font-medium text-sm mb-2 line-clamp-2">{{
                                                        task.params.prompt.length > 20 ? task.params.prompt.slice(0, 20)
                                                        + '¬∑¬∑¬∑' : task.params.prompt }}</h3>
                                                    <div
                                                        class="flex items-center justify-between text-xs text-gray-500">
                                                            <span>{{ task.model_cls }}</span>
                                                            <span>{{ getRelativeTime(task.create_t) }}</span>
                                    </div>
                                                        
                                </div>
                            </div>
                            </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- ÁîüÊàêËßÜÈ¢ëÂå∫Âüü -->
                <div v-if="currentView === 'create'" class="flex-1 flex flex-col min-h-0">
                    <!-- ÂÜÖÂÆπÂå∫Âüü -->
                    <div class="flex-1 overflow-y-auto p-6 content-area">
                        <!-- Ê®°ÊùøÈÄâÊã©ÊµÆÁ™ó -->
                        <div v-cloak>
                            <div v-if="showImageTemplates || showAudioTemplates"
                                class="fixed inset-0 bg-black/50 z-50 flex items-center justify-center"
                                @click="showImageTemplates = false; showAudioTemplates = false">
                                <div class="bg-secondary rounded-xl p-6 max-w-4xl w-full mx-4 h-[90vh] overflow-hidden"
                                    @click.stop>
                                    <!-- ÊµÆÁ™óÂ§¥ÈÉ® -->
                                    <div class="flex items-center justify-between mb-4">
                                        <h3 class="text-lg font-medium text-white">
                                                <i v-if="showImageTemplates"
                                                    class="fas fa-image text-gradient-icon mr-2"></i>
                                                <i v-if="showAudioTemplates"
                                                    class="fas fa-music text-gradient-icon mr-2"></i>
                                                {{ showImageTemplates ? t('imageTemplates') : t('audioTemplates') }}
                                        </h3>
                                        <button @click="showImageTemplates = false; showAudioTemplates = false"
                                                class="text-gray-400 hover:text-white transition-colors">
                                            <i class="fas fa-times text-xl"></i>
                                        </button>
                                    </div>

                                    <!-- Ê†áÁ≠æÈ°µÂàáÊç¢ -->
                                    <div class="flex border-b border-gray-700 mb-6">
                                            <button
                                                @click="mediaModalTab = 'history'; showImageTemplates && getImageHistory(); showAudioTemplates && getAudioHistory()"
                                                class="px-4 py-2 text-sm font-medium transition-colors" :class="mediaModalTab === 'history' 
                                                    ? 'text-gradient-icon border-b-2 border-laser-purple' 
                                                    : 'text-gray-400 hover:text-gray-300'">
                                            <i class="fas fa-history mr-2"></i>
                                                {{ t('history') }}
                                        </button>
                                        <button @click="mediaModalTab = 'templates'"
                                                class="px-4 py-2 text-sm font-medium transition-colors" :class="mediaModalTab === 'templates' 
                                                    ? 'text-gradient-icon border-b-2 border-laser-purple' 
                                                    : 'text-gray-400 hover:text-gray-300'">
                                            <i class="fas fa-layer-group mr-2"></i>
                                                {{ t('templates') }}
                                        </button>
                                    </div>

                                    <!-- ÂõæÁâáÂéÜÂè≤ËÆ∞ÂΩï -->
                                          <div v-if="showImageTemplates && mediaModalTab === 'history'"
                                             class="overflow-y-auto flex-1 max-h-[60vh] content-area">
                                            <div v-if="imageHistory.length === 0"
                                                class="flex flex-col items-center justify-center py-12 text-center">
                                                <div
                                                    class="w-16 h-auto bg-laser-purple/20 rounded-full flex items-center justify-center mb-4">
                                                <i class="fas fa-history text-gradient-icon text-2xl"></i>
                                            </div>
                                                <p class="text-gray-400 text-lg mb-2">{{ t('noHistoryRecords') }}</p>
                                                <p class="text-gray-500 text-sm">{{ t('imageHistoryAutoSave') }}</p>
                                        </div>
                                        <div v-else class="space-y-3">
                                            <div class="flex items-center justify-between mb-4">
                                                    <span class="text-sm text-gray-400">{{ t('total') }} {{ imageHistory.length }}
                                                        {{ t('records') }}</span>
                                                <button @click="clearImageHistory" 
                                                        class="text-xs text-red-400 hover:text-red-300 transition-colors flex items-center gap-1"
                                                        :title="t('clearHistory')">
                                                    <i class="fas fa-trash"></i>
                                                        {{ t('clear') }}
                                                </button>
                                            </div>
                                            <div class="columns-2 md:columns-3 lg:columns-4 xl:columns-5 gap-4">
                                                <div v-for="(history, index) in imageHistory" :key="index"
                                                    @click="selectImageHistory(history)"
                                                    class="break-inside-avoid mb-4 relative group cursor-pointer rounded-lg overflow-hidden border border-gray-700 hover:border-laser-purple/50 transition-all">
                                                        <img :src="getHistoryImageUrl(history)" :alt="history.filename" loading="lazy"
                                                            class="w-full h-auto object-contain">
                                                        <div
                                                            class="absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center">
                                                        <i class="fas fa-check text-white text-xl"></i>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                     <!-- ÂõæÁâáÊ®°ÊùøÁΩëÊ†º -->
                                         <div v-if="showImageTemplates && mediaModalTab === 'templates'">

                                            <!-- ÂõæÁâáÊ®°ÊùøÂàÜÈ°µÁªÑ‰ª∂ -->
                                            <div v-if="templatePaginationInfo" class="pagination-container mt-4">
                                                <div class="flex items-center justify-between text-xs text-gray-400">
                                                    <div class="flex items-center space-x-1 text-gray-500">
                                                        <span>{{ t('total') }} {{ templatePaginationInfo.total }} {{ t('records') }}</span>
                                                    </div>
                                                    <div v-if="templatePaginationInfo.total_pages > 1"
                                                        class="flex items-center space-x-2">
                                                        <!-- ‰∏ä‰∏ÄÈ°µÊåâÈíÆ -->
                                                        <button @click="goToTemplatePage(templateCurrentPage - 1)"
                                                            :disabled="templateCurrentPage <= 1"
                                                            class="pagination-btn-compact"
                                                            :class="{ 'disabled': templateCurrentPage <= 1 }"
                                                            :title="t('previousPage')">
                                                            <i class="fas fa-chevron-left text-xs"></i>
                                                        </button>

                                                        <!-- È°µÁ†ÅÊåâÈíÆ -->
                                                        <template v-for="page in getVisibleTemplatePages()" :key="page">
                                                            <button v-if="page !== '...'"
                                                                @click="goToTemplatePage(page)" :class="[
                                                                'pagination-btn-compact',
                                                                { 'active': page === templateCurrentPage }
                                                            ]">
                                                                {{ page }}
                                                            </button>
                                                            <span v-else class="text-gray-500">...</span>
                                                        </template>

                                                        <!-- È°µÁ†ÅËæìÂÖ•Ê°Ü -->
                                                        <div class="flex items-center space-x-1">
                                                            <input v-model="templatePageInput"
                                                                @keyup.enter="jumpToTemplatePage"
                                                                @blur="jumpToTemplatePage" type="number" :min="1"
                                                                :max="templatePaginationInfo.total_pages"
                                                                class="page-input" :title="t('jumpToPage')" />
                                                            <span class="text-gray-500">/</span>
                                                            <span class="text-gray-500">{{
                                                                templatePaginationInfo.total_pages }}</span>
                                                        </div>

                                                        <!-- ‰∏ã‰∏ÄÈ°µÊåâÈíÆ -->
                                                        <button @click="goToTemplatePage(templateCurrentPage + 1)"
                                                            :disabled="templateCurrentPage >= templatePaginationInfo.total_pages"
                                                            class="pagination-btn-compact"
                                                            :class="{ 'disabled': templateCurrentPage >= templatePaginationInfo.total_pages }"
                                                            :title="t('nextPage')">
                                                            <i class="fas fa-chevron-right text-xs"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                         <div class="overflow-y-auto flex-1 max-h-[60vh] content-area">
                                         <div v-if="imageTemplates.length > 0" class="columns-4 gap-4">
                                            <div v-for="template in imageTemplates" :key="template.filename"
                                                @click="selectImageTemplate(template)"
                                                class="break-inside-avoid mb-4 relative group cursor-pointer rounded-lg border border-gray-700 hover:border-laser-purple/50 transition-all">
                                                    <img :src="getTemplateFileUrl(template.filename,'images')" :alt="template.filename" loading="lazy"
                                                    class="w-full h-auto object-contain" preload="metadata">
                                                    <div
                                                        class="absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center">
                                                    <i class="fas fa-check text-white text-2xl"></i>
                                                </div>
                                            </div>
                                        </div>
                                            <div v-else
                                                class="flex flex-col items-center justify-center py-12 text-center">
                                                <div
                                                    class="w-16 h-16 bg-laser-purple/20 rounded-full flex items-center justify-center mb-4">
                                                <i class="fas fa-image text-gradient-icon text-2xl"></i>
                                            </div>
                                                <p class="text-gray-400 text-lg mb-2">{{ t('noImageTemplates') }}</p>
                                        </div>
                                    </div>

                                    </div>

                                    <!-- Èü≥È¢ëÂéÜÂè≤ËÆ∞ÂΩï -->
                                          <div v-if="showAudioTemplates && mediaModalTab === 'history'"
                                             class="overflow-y-auto flex-1 max-h-[60vh] content-area">
                                            <div v-if="audioHistory.length === 0"
                                                class="flex flex-col items-center justify-center py-12 text-center">
                                                <div
                                                    class="w-16 h-16 bg-laser-purple/20 rounded-full flex items-center justify-center mb-4">
                                                <i class="fas fa-history text-gradient-icon text-2xl"></i>
                                            </div>
                                                <p class="text-gray-400 text-lg mb-2">{{ t('noHistoryRecords') }}</p>
                                                <p class="text-gray-500 text-sm">{{ t('audioHistoryAutoSave') }}</p>
                                        </div>
                                        <div v-else class="space-y-3">
                                            <div class="flex items-center justify-between mb-4">
                                                    <span class="text-sm text-gray-400">ÂÖ± {{ audioHistory.length }}
                                                        {{ t('records') }}</span>
                                                <button @click="clearAudioHistory" 
                                                        class="text-xs text-red-400 hover:text-red-300 transition-colors flex items-center gap-1"
                                                        :title="t('clearHistory')">
                                                    <i class="fas fa-trash"></i>
                                                        {{ t('clear') }}
                                                </button>
                                            </div>
                                            <div class="space-y-3">
                                                <div v-for="(history, index) in audioHistory" :key="index"
                                                    @click="selectAudioHistory(history)"
                                                    class="flex items-center gap-4 p-4 rounded-lg border border-gray-700 hover:border-laser-purple/50 transition-all cursor-pointer bg-dark-light/50 group">
                                                        <div
                                                            class="w-12 h-12 bg-laser-purple/20 rounded-lg flex items-center justify-center">
                                                        <i class="fas fa-music text-gradient-icon text-xl"></i>
                                                    </div>
                                                    <div class="flex-1">
                                                            <div
                                                                class="text-white font-medium group-hover:text-gradient-icon transition-colors">
                                                                {{ history.filename }}</div>
                                                            <div class="text-gray-400 text-sm">{{ t('audioFile') }}</div>
                                                    </div>
                                                    <button @click.stop="previewAudioHistory(history)"
                                                            class="px-3 py-2 bg-laser-purple/20 hover:bg-laser-purple/30 text-gradient-icon rounded-lg transition-all">
                                                        <i class="fas fa-play mr-2"></i>
                                                            {{ t('preview') }}
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Èü≥È¢ëÊ®°ÊùøÂàóË°® -->
                                          <div v-if="showAudioTemplates && mediaModalTab === 'templates'">
                                                                                    <!-- Èü≥È¢ëÊ®°ÊùøÂàÜÈ°µÁªÑ‰ª∂ -->
                                                                                    <div v-if="templatePaginationInfo" class="pagination-container mt-4">
                                                                                        <div class="flex items-center justify-between text-xs text-gray-400">
                                                                                            <div class="flex items-center space-x-1 text-gray-500">
                                                                                                <span>{{ templatePaginationInfo.total }} {{ t('records') }}</span>
                                                                            </div>
                                                                                            <div v-if="templatePaginationInfo.total_pages > 1"
                                                                                                class="flex items-center space-x-2">
                                                                                                <!-- ‰∏ä‰∏ÄÈ°µÊåâÈíÆ -->
                                                                                                <button @click="goToTemplatePage(templateCurrentPage - 1)"
                                                                                                    :disabled="templateCurrentPage <= 1"
                                                                                                    class="pagination-btn-compact"
                                                                                                    :class="{ 'disabled': templateCurrentPage <= 1 }"
                                                                                                    :title="t('previousPage')">
                                                                                                    <i class="fas fa-chevron-left text-xs"></i>
                                                                                                </button>
                                        
                                                                                                <!-- È°µÁ†ÅÊåâÈíÆ -->
                                                                                                <template v-for="page in getVisibleTemplatePages()" :key="page">
                                                                                                    <button v-if="page !== '...'"
                                                                                                        @click="goToTemplatePage(page)" :class="[
                                                                                                        'pagination-btn-compact',
                                                                                                        { 'active': page === templateCurrentPage }
                                                                                                    ]">
                                                                                                        {{ page }}
                                                                                                    </button>
                                                                                                    <span v-else class="text-gray-500">...</span>
                                                                                                </template>
                                        
                                                                                                <!-- È°µÁ†ÅËæìÂÖ•Ê°Ü -->
                                                                                                <div class="flex items-center space-x-1">
                                                                                                    <input v-model="templatePageInput"
                                                                                                        @keyup.enter="jumpToTemplatePage"
                                                                                                        @blur="jumpToTemplatePage" type="number" :min="1"
                                                                                                        :max="templatePaginationInfo.total_pages"
                                                                                                        class="page-input" :title="t('jumpToPage')" />
                                                                                                    <span class="text-gray-500">/</span>
                                                                                                    <span class="text-gray-500">{{
                                                                                                        templatePaginationInfo.total_pages }}</span>
                                                                                                </div>
                                        
                                                                                                <!-- ‰∏ã‰∏ÄÈ°µÊåâÈíÆ -->
                                                                                                <button @click="goToTemplatePage(templateCurrentPage + 1)"
                                                                                                    :disabled="templateCurrentPage >= templatePaginationInfo.total_pages"
                                                                                                    class="pagination-btn-compact"
                                                                                                    :class="{ 'disabled': templateCurrentPage >= templatePaginationInfo.total_pages }"
                                                                                                    :title="t('nextPage')">
                                                                                                    <i class="fas fa-chevron-right text-xs"></i>
                                                                                                </button>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                        <div class="overflow-y-auto flex-1 max-h-[60vh] content-area">
                                        <div v-if="audioTemplates.length > 0" class="space-y-3">
                                            <div v-for="template in audioTemplates" :key="template.filename"
                                                @click="selectAudioTemplate(template)"
                                                class="flex items-center gap-4 p-4 rounded-lg border border-gray-700 hover:border-laser-purple/50 transition-all cursor-pointer bg-dark-light/50">
                                                    <div
                                                        class="w-12 h-12 bg-laser-purple/20 rounded-lg flex items-center justify-center">
                                                    <i class="fas fa-music text-gradient-icon text-xl"></i>
                                                </div>
                                                <div class="flex-1">
                                                        <div class="text-white font-medium">{{ template.filename }}
                                                        </div>
                                                        <div class="text-gray-400 text-sm">{{ t('audioTemplates') }}</div>
                                                </div>
                                                <button @click.stop="previewAudioTemplate(template)"
                                                        class="px-3 py-2 bg-laser-purple/20 hover:bg-laser-purple/30 text-gradient-icon rounded-lg transition-all">
                                                    <i class="fas fa-play mr-2"></i>
                                                        {{ t('preview') }}
                                                </button>
                                            </div>
                                        </div>
                                            <div v-else
                                                class="flex flex-col items-center justify-center py-12 text-center">
                                                <div
                                                    class="w-16 h-16 bg-laser-purple/20 rounded-full flex items-center justify-center mb-4">
                                                <i class="fas fa-music text-gradient-icon text-2xl"></i>
                                            </div>
                                            <p class="text-gray-400 text-lg mb-2">ÁõÆÂâçÊöÇÊó†Èü≥È¢ëÊ®°Êùø</p>
                                        </div>
                                        </div>

                                        </div>
                                </div>
                            </div>
                        </div>

                        <!-- ‰ªªÂä°ÂàõÂª∫Èù¢Êùø -->
                        <div class="max-w-4xl mx-auto" id="task-creator">
                            <!-- ÂêàÂπ∂ÁöÑÂàõ‰ΩúÂå∫Âüü -->
                            <div class="creation-area-container">
                                      
                                <div class="default-state-container">
                                    <!-- ‰∏§‰∏™Âπ∂ÂàóÁöÑ‰∏ãÊãâËèúÂçï -->
                                    <div class="flex justify-center gap-10 mb-6">
                                        <!-- ‰ªªÂä°Á±ªÂûã‰∏ãÊãâËèúÂçï -->
                                        <div class="task-type-dropdown">
                                            <div class="relative">
                                                <button @click="showTaskTypeMenu = !showTaskTypeMenu"
                                                    class="flex items-center gap-3 px-4 py-3 text-white hover:text-gradient-icon transition-all duration-200 text-sm min-w-[120px]"
                                                    :title="t('selectTaskType')">
                                                    <span class="text-sm">{{ getTaskTypeName(selectedTaskId) }}</span>
                                                    <i class="fas fa-chevron-down text-xs transition-transform duration-200 ml-auto"
                                                        :class="{ 'rotate-180': showTaskTypeMenu }"></i>
                                                </button>

                                                <!-- ‰ªªÂä°Á±ªÂûãÈÄâÊã©‰∏ãÊãâËèúÂçï -->
                                                <div v-if="showTaskTypeMenu"
                                                    class="absolute top-full left-0 mt-2 bg-dark-light border border-laser-purple/30 rounded-lg shadow-lg z-50 min-w-[150px]"
                                                    @click.stop>
                                                    <div v-for="taskType in availableTaskTypes" :key="taskType"
                                                        @click="selectTask(taskType); showTaskTypeMenu = false"
                                                        class="flex items-center gap-3 px-4 py-3 hover:bg-laser-purple/20 cursor-pointer transition-colors duration-200 first:rounded-t-lg last:rounded-b-lg"
                                                        :class="{ 'bg-laser-purple/20': selectedTaskId === taskType }">
                                                        <i :class="getTaskTypeIcon(taskType)" class="text-sm"></i>
                                                        <span class="text-white text-sm">{{ getTaskTypeName(taskType) }}</span>
                                                        <i v-if="selectedTaskId === taskType"
                                                            class="fas fa-check text-laser-purple ml-auto"></i>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Ê®°ÂûãÈÄâÊã©‰∏ãÊãâËèúÂçï -->
                                        <div class="model-dropdown">
                                            <div class="relative">
                                                <button @click="showModelMenu = !showModelMenu"
                                                    class="flex items-center gap-3 px-4 py-3 text-white hover:text-gradient-icon transition-all duration-200 text-sm min-w-[120px]"
                                                    :title="t('selectModel')">
                                                    <span class="text-sm">{{ getCurrentForm().model_cls || t('selectModel') }}</span>
                                                    <i class="fas fa-chevron-down text-xs transition-transform duration-200 ml-auto"
                                                        :class="{ 'rotate-180': showModelMenu }"></i>
                                                </button>

                                                <!-- Ê®°ÂûãÈÄâÊã©‰∏ãÊãâËèúÂçï -->
                                                <div v-if="showModelMenu"
                                                    class="absolute top-full left-0 mt-2 bg-dark-light border border-laser-purple/30 rounded-lg shadow-lg z-50 min-w-[150px] max-h-48 overflow-y-auto"
                                                    @click.stop>
                                                    <div v-if="availableModelClasses.length > 0">
                                                        <div v-for="modelCls in availableModelClasses" :key="modelCls"
                                                            @click="selectModel(modelCls); showModelMenu = false"
                                                            class="flex items-center gap-3 px-4 py-3 hover:bg-laser-purple/20 cursor-pointer transition-colors duration-200 first:rounded-t-lg last:rounded-b-lg"
                                                            :class="{ 'bg-laser-purple/20': getCurrentForm().model_cls === modelCls }">
                                                            <span class="text-white text-sm">{{ modelCls }}</span>
                                                            <i v-if="getCurrentForm().model_cls === modelCls"
                                                                class="fas fa-check text-laser-purple ml-auto text-xs"></i>
                                                        </div>
                                                    </div>
                                                    <div v-else class="px-4 py-3 text-center text-gray-500 text-xs">
                                                        {{ t('selectTaskTypeFirst') }}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>


                                
                                 <!-- ÈªòËÆ§Áä∂ÊÄÅÔºö‰∏≠ÂøÉÊñáÂ≠ó -->
                                <div v-show="!isCreationAreaExpanded" class="flex flex-col items-center justify-center h-[60vh]">
                                    
                                    <div class="text-center">

                                        <h2 class="text-4xl font-bold text-white mb-6">‰ªäÂ§©ÊÉ≥ÂÅö‰ªÄ‰πàÊ†∑ÁöÑËßÜÈ¢ëÂë¢Ôºü</h2>
                                        
                                        <!-- Âä®ÊÄÅÊªöÂä®ÊèêÁ§∫ -->
                                        <div class="hint-container mb-8 pb-10">
                                            <div class="hint-text text-gray-400 text-lg min-h-[60px] flex items-center justify-center">
                                                <transition name="hint-fade" mode="out-in">
                                                    <p :key="currentHintIndex" class="text-center">
                                                        {{ currentTaskHints[currentHintIndex] }}
                                                    </p>
                                                </transition>
                                            </div>
                                            <!-- ÊèêÁ§∫ÊåáÁ§∫Âô® -->
                                            <div class="flex justify-center mt-4 space-x-2">
                                                <div v-for="(hint, index) in currentTaskHints" :key="index"
                                                    class="w-2 h-2 rounded-full transition-all duration-300"
                                                    :class="index === currentHintIndex ? 'bg-laser-purple' : 'bg-gray-600'">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                
                                    <!-- Â±ïÂºÄÂºÄÂÖ≥ -->
                                    <div class="relative group cursor-pointer w-3/5" @click="expandCreationArea">
                                        <textarea
                                            class="pl-14 relative w-full max-h-[75px] bg-dark-light/80 border border-laser-purple/30 rounded-full p-6 text-base focus:ring-1 transition-all duration-300 resize-none scrollbar-thin focus:shadow-2xl placeholder-gray-500"
                                            placeholder="ÂºÄÂßãÂàõ‰ΩúËßÜÈ¢ë¬∑¬∑¬∑"
                                        ></textarea>
                                        
                                        <!-- Èº†Ê†áÂõæÊ†á -->
                                        <div class="absolute left-8 top-[28%] text-gray-400 group-hover:text-gradient-icon transition-all duration-300 pointer-events-none group-hover:drop-shadow-[0_0_8px_rgba(168,85,247,0.6)] group-hover:animate-pulse">
                                            <i class="fas fa-mouse-pointer text-lg"></i>
                                        </div>
                                        
                                        <!-- Ë£ÖÈ•∞ÊÄßËæπÊ°Ü -->
                                        <div class="absolute inset-0 rounded-full border border-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none"></div>
                                    </div>
                                </div>
                                

                                <!-- Â±ïÂºÄÁä∂ÊÄÅÔºöÁ¥†ÊùêÂå∫Âüü -->
                                <div v-show="isCreationAreaExpanded" class="mb-8 prompt-input-section">
                                    <!-- ‰∏≠ÂøÉÊñáÂ≠ó -->
                                    <div class="text-center">

                                        <h2 class="text-4xl font-bold text-white mb-6 animate-fade-in">Âàõ‰ΩúËßÜÈ¢ëÈúÄË¶Å‰ªÄ‰πàÁ¥†ÊùêÂë¢Ôºü</h2>
                                        
                                        <p class="text-gray-400 text-lg mb-8 transition-all duration-300">
                                            <span v-if="selectedTaskId === 't2v'" 
                                                  class="inline-block animate-fade-in">ËØ∑ËæìÂÖ•Â∞ΩÂèØËÉΩËØ¶ÁªÜÁöÑËßÜÈ¢ëËÑöÊú¨</span>
                                            <span v-else-if="selectedTaskId === 'i2v'" 
                                                  class="inline-block animate-fade-in">ËØ∑‰∏ä‰º†‰∏ÄÂº†ÂõæÁâá‰Ωú‰∏∫ËßÜÈ¢ëÁöÑÈ¶ñÂ∏ßÂõæÔºå‰ª•ÂèäÂ∞ΩÂèØËÉΩËØ¶ÁªÜÁöÑËßÜÈ¢ëËÑöÊú¨</span>
                                            <span v-else-if="selectedTaskId === 's2v'" 
                                                  class="inline-block animate-fade-in">ËØ∑‰∏ä‰º†‰∏ÄÂº†ËßíËâ≤ÂõæÁâá„ÄÅ‰∏ÄÊÆµÈü≥È¢ë„ÄÅ‰ª•ÂèäÂ§ßËá¥ÁöÑËßÜÈ¢ëË¶ÅÊ±Ç</span>
                                            <span v-else 
                                                  class="inline-block animate-fade-in">ÈÄâÊã©‰ªªÂä°Á±ªÂûãÂºÄÂßãÂàõ‰ΩúÊÇ®ÁöÑËßÜÈ¢ë</span>
                                        </p>
                                    </div>
                                
                                                                    <!-- Êî∂Áº©ÂºÄÂÖ≥ -->

                                <div 
                                    class="creation-area transition-all duration-500 ease-out max-w-4xl mx-auto"
                                    @click.stop>
                                    <!-- Êî∂Ëµ∑ÊåâÈíÆ -->
                                    <div class="flex justify-center mb-4">
                                        <button @click="contractCreationArea" 
                                                class="flex items-center gap-2 px-4 py-2 text-gray-400 hover:text-laser-purple transition-all duration-300 hover:bg-laser-purple/10 rounded-lg group"
                                                :class="{ 'animate-pulse': isContracting }">
                                            <i class="fas fa-compress-alt text-sm transition-transform duration-200 group-hover:scale-110"
                                               :class="{ 'animate-spin': isContracting }"></i>
                                            <span class="text-sm font-medium">
                                                Êî∂Ëµ∑Âàõ‰ΩúÂå∫Âüü
                                            </span>
                                            <i class="fas fa-chevron-up text-xs transition-transform duration-200 group-hover:translate-y-[-2px]"
                                               :class="{ 'animate-bounce': isContracting }"></i>
                                        </button>
                                    </div>
                                    <div v-if="selectedTaskId === 'i2v' || selectedTaskId === 's2v'" class="upload-section">
                                    <!-- ‰∏ä‰º†ÂõæÁâá -->
                                    <div v-if="selectedTaskId === 'i2v' || selectedTaskId === 's2v'">
                                        <!-- ÂõæÁâáÂéÜÂè≤ÂíåÁ¥†ÊùêÂ∫ì -->
                                        <div class="flex justify-between items-center mb-2">
                                                <label class="block text-sm text-gray-400 flex items-center">
                                                                {{ t('image') }}
                                                            <button
                                                            @click.stop="showImageTemplates = true; mediaModalTab = 'history'; getImageHistory()"
                                                        class="text-xs hover:text-gradient-icon transition-colors pl-3"
                                                        :title="t('templates')">

                                                    <i class="fas fa-lightbulb mr-1"></i>
                                                </button>
                                                </label>
                                        </div>
                                        <!-- ‰∏ä‰º†ÂõæÁâá -->
                                        <div class="upload-area"
                                            @click="triggerImageUpload">
                                            <!-- ÈªòËÆ§‰∏ä‰º†ÁïåÈù¢ -->
                                            <div v-if="!getCurrentImagePreview()" class="upload-content">
                                            <div class="upload-icon">
                                                <i class="fas fa-image text-gradient-icon text-xl"></i>
                                            </div>
                                                    <p class="text-xs text-gray-400 mb-4">{{ t('supportedImageFormats') }}</p>
                                            <div class="flex gap-2">
                                                        <button
                                                            class="btn-primary px-4 py-1.5 rounded-lg transition-all flex-1">{{ t('uploadImage') }}</button>
                                            </div>
                                            </div>
            
                                            <!-- ÂõæÁâáÈ¢ÑËßà -->
                                            <div v-if="getCurrentImagePreview()" class="image-preview group">
                                                    <img :src="getCurrentImagePreviewUrl()" alt="t('previewImage')" loading="lazy" preload="metadata"
                                                        class="w-full h-full object-cover rounded-lg transition-all duration-300 group-hover:brightness-50">
            
                                                <!-- ÊÇ¨ÂÅúÊó∂ÊòæÁ§∫ÁöÑÊìç‰ΩúÊåâÈíÆÔºå‰ΩçÁΩÆÂú®‰∏≠‰∏ãÊñπ -->
                                                    <div
                                                        class="absolute inset-x-0 bottom-4 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                                                    <div class="flex space-x-3">
                                                            <button @click.stop="triggerImageUpload"
                                                            class="w-12 h-12 flex items-center justify-center bg-white/15 text-white p-3 rounded-full transition-all duration-200 hover:scale-110 shadow-lg"
                                                                :title="t('reupload')">
                                                            <i class="fas fa-upload text-lg"></i>
                                                        </button>
                                                            <button @click.stop="removeImage"
                                                            class="w-12 h-12 flex items-center justify-center bg-white/15 text-white p-3 rounded-full transition-all duration-200 hover:scale-110 shadow-lg"
                                                                :title="t('deleteImage')">
                                                            <i class="fas fa-trash text-lg"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                                <input type="file" ref="imageInput" @change="handleImageUpload" accept="image/*"
                                                style="display: none;">
                                            </div>
                                    </div>

    
                                    <!-- ‰∏ä‰º†Èü≥È¢ë -->        
                                    <div v-if="selectedTaskId === 's2v'">     
                                        <!-- Èü≥È¢ëÂéÜÂè≤ÂíåÁ¥†ÊùêÂ∫ì -->
                                        <div class="flex justify-between items-center mb-2">
                                                        <label class="block text-sm text-gray-400 flex items-center">
                                                                        {{ t('audio') }}
                                                                    <button
                                                                    @click.stop="showAudioTemplates = true; mediaModalTab = 'history'; getAudioHistory()"
                                                                class="text-xs hover:text-gradient-icon transition-colors pl-3"
                                                                :title="t('templates')">

                                                            <i class="fas fa-lightbulb mr-1"></i>
                                                        </button>
                                                        </label>
                                        </div>
                                        <!-- ‰∏ä‰º†Èü≥È¢ë -->
                                        <div class="upload-area">
                                        <!-- ÈªòËÆ§‰∏ä‰º†ÁïåÈù¢ -->
                                            <div v-if="!getCurrentAudioPreview()" class="upload-content"
                                                @click="triggerAudioUpload">
                                        <div class="upload-icon">
                                            <i class="fas fa-microphone text-gradient-icon text-xl"></i>
                                        </div>
                                                <p class="text-xs text-gray-400 mb-4">{{ t('supportedAudioFormats') }}</p>
                                        <div class="flex gap-2">
                                                    <button
                                                        class="btn-primary px-4 py-1.5 rounded-lg transition-all flex-1">{{ t('uploadAudio') }}</button>
                                                    
                                        </div>
                                            </div>
        
                                        <!-- Èü≥È¢ëÈ¢ÑËßà -->
                                            <div v-if="getCurrentAudioPreview()" class="audio-preview group">
                                            <audio controls class="w-full h-full">
                                                    <source :src="getCurrentAudioPreviewUrl()" :type="getAudioMimeType()" preload="metadata">
                                            </audio>
        
                                            <!-- ÊÇ¨ÂÅúÊó∂ÊòæÁ§∫ÁöÑÊìç‰ΩúÊåâÈíÆÔºå‰ΩçÁΩÆÂú®‰∏≠‰∏ãÊñπ -->
                                                <div
                                                    class="absolute inset-x-0 bottom-4 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300 bg-black/20">
                                                <div class="flex space-x-3">
                                                        <button @click.stop="triggerAudioUpload"
                                                        class="w-12 h-12 flex items-center justify-center bg-white/15 text-white p-3 rounded-full transition-all duration-200 hover:scale-110 shadow-lg"
                                                            :title="t('reupload')">
                                                        <i class="fas fa-upload text-lg"></i>
                                                    </button>
                                                        <button @click.stop="removeAudio"
                                                        class="w-12 h-12 flex items-center justify-center bg-white/15 text-white p-3 rounded-full transition-all duration-200 hover:scale-110 shadow-lg"
                                                            :title="t('deleteAudio')">
                                                        <i class="fas fa-trash text-lg"></i>
                                                    </button>
                                                </div>
                                            </div>
                                            </div>
        
                                            <input type="file" ref="audioInput" @change="handleAudioUpload" accept="audio/*"
                                            style="display: none;">
                                        </div>
                                    </div>
                                </div>

                                        <!-- ÊèêÁ§∫ËØçËæìÂÖ•Âå∫Âüü -->
                                        <div class="flex justify-between items-center mb-2">
                                            <label class="block text-sm text-gray-400 flex items-center">
                                                    {{ t('prompt') }}
                                                    <button @click="showPromptModal = true; promptModalTab = 'templates'"
                                                        class="text-xs text-gray-400 hover:text-gradient-icon transition-colors pl-3"
                                                        :title="t('promptTemplates')">
                                                    <i class="fas fa-lightbulb"></i>
                                                </button>
                                            </label>
                                            <div class="text-xs text-gray-400">
                                                {{ getCurrentForm().prompt?.length || 0 }} / 500
                                            </div>
                                        </div>
                                        <div class="relative group cursor-pointer">
                                            <textarea v-model="getCurrentForm().prompt"
                                                class="relative w-full bg-dark-light/80 border border-laser-purple/30 rounded-xl p-6 text-base min-h-[100px] focus:ring-1 transition-all duration-300 resize-none scrollbar-thin focus:shadow-2x placeholder-gray-500"
                                                :placeholder="getPromptPlaceholder()" 
                                                rows="4" 
                                                maxlength="500"
                                                required></textarea>
                                            
                                            <!-- Ë£ÖÈ•∞ÊÄßËæπÊ°Ü -->
                                            <div class="absolute inset-0 rounded-xl border border-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none"></div>
                                        </div>
        
                                        <div class="flex justify-between items-center">
                                            <button @click="clearPrompt"
                                                class="flex items-center text-sm rounded-lg px-2 transition-all duration-200 text-gray-400 hover:text-laser-purple hover:bg-laser-purple/10 group">
                                                <i class="fas fa-sync-alt text-sm mr-2 group-hover:rotate-180 transition-transform duration-300"></i>
                                                {{ t('clear') }}
                                            </button>
                                        
                                        </div>
                                <!-- Êèê‰∫§ÊåâÈíÆ -->
                                <div class="flex justify-center mt-2">
                                    <button @click="submitTask" :disabled="submitting"
                                        class="btn-primary flex items-center justify-center px-8 py-3 rounded-lg text-lg transition-all shadow-lg">
                                        <i class="fas fa-play text-xl mr-2"></i>
                                        {{ submitting ? t('submitting') : t('generateVideo') }}
                                    </button>
                                </div>

                                </div>
                                
                                </div>

                            </div>
                            
                </div>



                        </div>
                </div>
                </div>
                        <!-- ÁÅµÊÑüÂπøÂú∫Âå∫Âüü -->
                        <div v-if="currentView === 'inspiration'" class="flex-1 flex flex-col min-h-0">
                            <!-- ÂÜÖÂÆπÂå∫Âüü -->
                            <div class="flex-1 overflow-y-auto p-6 content-area">
                                <!-- ÁÅµÊÑüÂπøÂú∫ÂäüËÉΩÂå∫ -->
                                <div class="max-w-4xl mx-auto" id="inspiration-gallery">
                                    <!-- Âõ∫ÂÆöÂäüËÉΩÂå∫ -->
                                    <div class="flex-shrink-0 p-1">
                                        <!-- Ê†áÈ¢òÂå∫Âüü -->
                                        <div class="text-center mb-8">
                                                <h1 class="text-3xl font-bold text-white mb-2">{{ t('inspiration') }}</h1>
                                                <p class="text-gray-400">{{ t('discoverCreativity') }}</p>
                                        </div>
                    
                                        <!-- ÊêúÁ¥¢ÂíåÁ≠õÈÄâÂå∫Âüü -->
                                        <div class="flex flex-col md:flex-row gap-4 mb-6">
                                            <!-- ÊêúÁ¥¢Ê°Ü -->
                                            <div class="relative flex-1">
                                                    <i
                                                        class="fas fa-search absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none z-10"></i>
                                                    <input v-model="inspirationSearchQuery"
                                                    @keyup.enter="handleInspirationSearch"
                                                    @input="handleInspirationSearch"
                                                    class="w-full bg-dark-light border border-laser-purple/30 rounded-lg py-3 pl-10 pr-4 text-sm focus:outline-none focus:ring-2 focus:ring-laser-purple/50 transition-all focus:border-laser focus:shadow-laser"
                                                        :placeholder="t('searchInspiration')" type="text" />
                                            </div>
                                            
                                            <!-- ÂàÜÁ±ªÁ≠õÈÄâ -->
                                                <div class="flex gap-2 flex-wrap">
                                                    <button v-for="category in dynamicInspirationCategories" :key="category.id"
                                                    @click="selectInspirationCategory(category.id)"
                                                    :class="selectedInspirationCategory === category.id 
                                                        ? 'bg-laser-purple/20 text-white border-laser-purple/40' 
                                                        : 'bg-dark-light text-gray-400 hover:text-white hover:bg-dark-light/80'"
                                                        class="px-4 py-2 rounded-lg border border-transparent transition-all duration-200 text-sm font-medium">
                                                    {{ category.name }}
                                                </button>
                                            </div>
                                        </div>
                      <!-- ÁÅµÊÑüÂπøÂú∫ÂàÜÈ°µÁªÑ‰ª∂ -->
                                        <div v-if="inspirationPaginationInfo" class="pagination-container mt-8">
                                                <div class="flex items-center justify-between text-xs text-gray-400">
                                                    <div class="flex items-center space-x-1 text-gray-500">
                                                        <span>{{ inspirationPaginationInfo.total }} {{ t('records') }}</span>
                                        </div>
                                                    <div v-if="inspirationPaginationInfo.total_pages > 1"
                                                        class="flex items-center space-x-2">
                                                        <!-- ‰∏ä‰∏ÄÈ°µÊåâÈíÆ -->
                                                        <button @click="goToInspirationPage(inspirationCurrentPage - 1)"
                                                            :disabled="inspirationCurrentPage <= 1"
                                                            class="pagination-btn-compact"
                                                            :class="{ 'disabled': inspirationCurrentPage <= 1 }" :title="t('previousPage')">
                                                            <i class="fas fa-chevron-left text-xs"></i>
                                                        </button>
        
                                                        <!-- È°µÁ†ÅÊåâÈíÆ -->
                                                        <template v-for="page in getVisibleInspirationPages()" :key="page">
                                                            <button v-if="page !== '...'" @click="goToInspirationPage(page)"
                                                                :class="[
                                                                'pagination-btn-compact',
                                                                { 'active': page === inspirationCurrentPage }
                                                            ]">
                                                                {{ page }}
                                                        </button>
                                                            <span v-else class="text-gray-500">...</span>
                                                        </template>
        
                                                        <!-- È°µÁ†ÅËæìÂÖ•Ê°Ü -->
                                                        <div class="flex items-center space-x-1">
                                                            <input v-model="inspirationPageInput"
                                                                @keyup.enter="jumpToInspirationPage"
                                                                @blur="jumpToInspirationPage" type="number" :min="1"
                                                                :max="inspirationPaginationInfo.total_pages" class="page-input"
                                                                :title="t('jumpToPage')">
                                                            <span class="text-gray-500">/</span>
                                                            <span class="text-gray-500">{{ inspirationPaginationInfo.total_pages
                                                                }}</span>
                                                        </div>
        
                                                        <!-- ‰∏ã‰∏ÄÈ°µÊåâÈíÆ -->
                                                        <button @click="goToInspirationPage(inspirationCurrentPage + 1)"
                                                            :disabled="inspirationCurrentPage >= inspirationPaginationInfo.total_pages"
                                                            class="pagination-btn-compact"
                                                            :class="{ 'disabled': inspirationCurrentPage >= inspirationPaginationInfo.total_pages }"
                                                            :title="t('nextPage')">
                                                            <i class="fas fa-chevron-right text-xs"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                        </div>
                                        <!-- ÁÅµÊÑüÂÜÖÂÆπÁΩëÊ†º -->
                                        <div class="flex-1 overflow-y-auto history-tasks-scroll min-h-0 p-4"
                                        style="overflow-x: visible;">
                                        <div class="columns-1 md:columns-2 lg:columns-3 xl:columns-4 gap-6">
                                            <!-- ÁÅµÊÑüÂç°Áâá -->
                                            <div v-for="item in filteredInspirationItems" :key="item.task_id"
                                                    class="break-inside-avoid mb-6 group relative bg-dark-light rounded-xl overflow-hidden border border-gray-700/50 hover:border-laser-purple/40 transition-all duration-300 hover:shadow-laser/20">
                                                <!-- ËßÜÈ¢ëÁº©Áï•ÂõæÂå∫Âüü -->
                                                <div class="bg-gray-800 relative flex flex-col">
                                                        <!-- ËßÜÈ¢ëÈ¢ÑËßà -->
                                                        <video v-if="item?.outputs?.output_video" 
                                                            :src="getTemplateFileUrl(item.outputs.output_video,'videos') + '#t=0,5'"
                                                            :poster="getTemplateFileUrl(item.inputs.input_image,'images')"
                                                            class="w-full h-auto object-contain group-hover:scale-105 transition-transform duration-300"
                                                            muted loop preload="auto" playsinline webkit-playsinline
                                                            @mouseenter="playVideo($event)" @mouseleave="pauseVideo($event)"
                                                            @loadeddata="onVideoLoaded($event)"
                                                            @error="onVideoError($event)"></video>
                                                    <!-- ÂõæÁâáÁº©Áï•Âõæ -->
                                                        <img v-else-if="item?.inputs?.input_image" 
                                                        :src="getTemplateFileUrl(item.inputs.input_image,'images')"
                                                        :alt="item.params?.prompt || 'Ê®°ÊùøÂõæÁâá'"
                                                        class="w-full h-auto object-contain group-hover:scale-105 transition-transform duration-300" preload="metadata" />
                                                    <!-- Âç†‰ΩçÁ¨¶ -->
                                                    <div v-else class="w-full h-48 flex items-center justify-center">
                                                        <i class="fas fa-star text-4xl text-gray-600"></i>
                                                    </div>
                                                    
                                                    <!-- ÊÇ¨ÊµÆÊìç‰ΩúÊåâÈíÆ -->
                                                        <div
                                                            class="absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none z-10">
                                                        <div class="flex space-x-3 pointer-events-auto">
                                                                <button @click="previewTemplateDetail(item)"
                                                                class="w-10 h-10 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center text-white hover:bg-white/30 transition-colors"
                                                                    :title="t('previewDetail')">
                                                                <i class="fas fa-eye text-sm"></i>
                                                            </button>
                                                                <button @click="useTemplate(item)"
                                                                class="w-10 h-10 rounded-full bg-laser-purple/80 backdrop-blur-sm flex items-center justify-center text-white hover:bg-laser-purple transition-colors"
                                                                    :title="t('useTemplate')">
                                                                <i class="fas fa-copy text-sm"></i>
                    </button>
                                                        </div>
                                                    </div>
                                                    
                                                </div>
                                                <!-- Âõ∫ÂÆöÈ´òÂ∫¶ÂÜÖÂÆπ‰ø°ÊÅØÂíåÊ†áÁ≠æÔºåÂêàÂπ∂‰∏∫‰∏Ä‰∏™ÁªÑ‰ª∂ÔºåÊúÄÂ§ö‰∏§Ë°åÊñáÂ≠ó -->
                                                <div class="p-4 flex flex-col justify-between h-20">
                                                        <div class="flex flex-wrap gap-1">
                                                            <span v-for="tag in item.tags" :key="tag"
                                                                class="px-2 py-1 bg-gray-700/50 text-gray-300 text-xs rounded-full">
                                                            {{ tag }}
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
        
                          
                                    </div>
                                </div>
                            </div>
                        </div>
        <!-- Â¢ûÂº∫ÁöÑÊèêÁ§∫Ê∂àÊÅØÁ≥ªÁªü -->
        <div v-cloak>
            <div v-if="alert.show"
                class="fixed top-4 left-1/2 transform -translate-x-1/2 z-[9999] max-w-xs w-full px-4"
                :class="getAlertClass(alert.type)">
                    <div
                        class="bg-gray-800/95 backdrop-blur-sm border border-gray-700/50 rounded-lg shadow-lg transition-all duration-300 ease-out">
                    <div class="flex items-center p-3">
                        <div class="flex-shrink-0 mr-3">
                            <div class="w-6 h-6 rounded-full flex items-center justify-center"
                                :class="getAlertIconBgClass(alert.type)">
                                <i :class="getAlertIcon(alert.type)" class="text-xs"></i>
                            </div>
                        </div>
                        <div class="flex-1">
                            <p class="text-xs font-medium text-gray-200">
                                {{ alert.message }}
                            </p>
                        </div>
                        <div class="flex-shrink-0 ml-2">
                            <button @click="alert.show = false"
                                    class="w-5 h-5 rounded-full flex items-center justify-center text-gray-400 hover:text-gray-200 hover:bg-gray-700/50 transition-all duration-200">
                                <i class="fas fa-times text-xs"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ëá™ÂÆö‰πâÁ°ÆËÆ§ÂØπËØùÊ°Ü -->
         <div v-cloak>
        <div v-if="confirmDialog.show" class="fixed inset-0 z-50 flex items-center justify-center p-4">
            <!-- ËÉåÊôØÈÅÆÁΩ© -->
                    <div class="absolute inset-0 bg-black/60 backdrop-blur-sm" @click="confirmDialog.show = false">
                    </div>
            
            <!-- ÂØπËØùÊ°ÜÂÜÖÂÆπ -->
            <div class="relative bg-dark-light border border-laser-purple/30 rounded-xl shadow-2xl max-w-md w-full mx-4 transform transition-all duration-300 ease-out"
                 :class="confirmDialog.show ? 'scale-100 opacity-100' : 'scale-95 opacity-0'">
                <!-- Â§¥ÈÉ® -->
                <div class="flex items-center justify-between p-6 border-b border-gray-700">
                    <div class="flex items-center gap-3">
                        <div class="w-10 h-10 bg-red-500/20 rounded-full flex items-center justify-center">
                            <i class="fas fa-exclamation-triangle text-red-400 text-lg"></i>
                                            </div>
                        <h3 class="text-lg font-semibold text-white">{{ confirmDialog.title }}</h3>
                    </div>
                    <button @click="confirmDialog.show = false" 
                            class="text-gray-400 hover:text-gray-300 transition-colors">
                        <i class="fas fa-times text-lg"></i>
                                                </button>
                                                </div>
                
                <!-- ÂÜÖÂÆπ -->
                <div class="p-6">
                    <p class="text-gray-300 leading-relaxed mb-6">{{ confirmDialog.message }}</p>
                    
                    <!-- Ë≠¶Âëä‰ø°ÊÅØ -->
                            <div v-if="confirmDialog.warning"
                                class="bg-red-500/10 border border-red-500/30 rounded-lg p-4 mb-6">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-info-circle text-red-400 mt-0.5"></i>
                            <div class="text-sm text-red-300">
                                <p class="font-medium mb-2">{{ confirmDialog.warning.title }}</p>
                                <ul class="space-y-1 text-xs">
                                            <li v-for="item in confirmDialog.warning.items" :key="item"
                                                class="flex items-center gap-2">
                                        <i class="fas fa-minus text-red-400 text-xs"></i>
                                        {{ item }}
                                    </li>
                                </ul>
                                            </div>
                                        </div>
                                    </div>
                </div>
                
                <!-- Â∫ïÈÉ®ÊåâÈíÆ -->
                <div class="flex gap-3 p-6 pt-0">
                    <button @click="confirmDialog.cancel()" 
                            class="flex-1 px-4 py-2.5 bg-gray-600 hover:bg-gray-500 text-white rounded-lg transition-all duration-200 font-medium">
                                {{ t('cancel') }}
                    </button>
                    <button @click="confirmDialog.confirm()" 
                            class="flex-1 px-4 py-2.5 bg-red-500 hover:bg-red-600 text-white rounded-lg transition-all duration-200 font-medium flex items-center justify-center gap-2">
                        <i class="fas fa-trash text-sm"></i>
                        {{ confirmDialog.confirmText }}
                    </button>
                </div>
            </div>
        </div>
        </div>

        <!-- ÊèêÁ§∫ËØçÊ®°ÊùøÂíåÂéÜÂè≤ËÆ∞ÂΩïÂºπÁ™ó -->
        <div v-cloak>
                <div v-if="showPromptModal" class="fixed inset-0 bg-black/50 z-50 flex items-center justify-center"
                @click="showPromptModal = false">
                <div class="bg-secondary rounded-xl p-6 max-w-4xl w-full mx-4 max-h-[80vh] overflow-hidden"
                    @click.stop>
                    <!-- ÊµÆÁ™óÂ§¥ÈÉ® -->
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-medium text-white">
                            <i class="fas fa-lightbulb text-gradient-icon mr-2"></i>
                                {{ t('promptTemplates') }}
                        </h3>
                        <button @click="showPromptModal = false"
                                class="text-gray-400 hover:text-white transition-colors">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>

                    <!-- Ê†áÁ≠æÈ°µÂàáÊç¢ -->
                    <div class="flex border-b border-gray-700 mb-6">
                        <button @click="promptModalTab = 'templates'"
                                class="px-4 py-2 text-sm font-medium transition-colors" :class="promptModalTab === 'templates' 
                                    ? 'text-gradient-icon border-b-2 border-laser-purple' 
                                    : 'text-gray-400 hover:text-gray-300'">
                            <i class="fas fa-layer-group mr-2"></i>
                                {{ t('templates') }}
                        </button>
                        <button @click="promptModalTab = 'history'"
                                class="px-4 py-2 text-sm font-medium transition-colors" :class="promptModalTab === 'history' 
                                    ? 'text-gradient-icon border-b-2 border-laser-purple' 
                                    : 'text-gray-400 hover:text-gray-300'">
                            <i class="fas fa-history mr-2"></i>
                                {{ t('history') }}
                        </button>
                    </div>

                    <!-- Ê®°ÊùøÂÜÖÂÆπ -->
                    <div v-if="promptModalTab === 'templates'" class="overflow-y-auto max-h-[50vh]">
                            <div v-if="getPromptTemplates(selectedTaskId).length > 0"
                                class="grid grid-cols-1 md:grid-cols-2 gap-4 overflow-y-auto max-h-[50vh] content-area">
                                <button v-for="template in getPromptTemplates(selectedTaskId)" :key="template.id"
                                @click="selectPromptTemplate(template)"
                                    class="break-inside-avoid mb-4 p-4 text-left bg-dark-light rounded-lg hover:bg-laser-purple/20 transition-all border border-transparent hover:border-laser-purple/40 group">
                                    <div
                                        class="font-medium text-sm mb-2 text-white group-hover:text-gradient-icon transition-colors">
                                    {{ template.title }}
                                </div>
                                <div class="text-xs text-gray-400 line-clamp-3 leading-relaxed">
                                    {{ template.prompt }}
                                </div>
                                <div class="mt-3 flex items-center justify-between">
                                        <span class="text-xs text-laser-purple/60">{{ t('clickApply') }}</span>
                                        <i
                                            class="fas fa-arrow-right text-xs text-laser-purple/60 group-hover:translate-x-1 transition-transform"></i>
                                </div>
                            </button>
                        </div>
                        <div v-else class="flex flex-col items-center justify-center py-12 text-center">
                                <div
                                    class="w-16 h-16 bg-laser-purple/20 rounded-full flex items-center justify-center mb-4">
                                <i class="fas fa-layer-group text-gradient-icon text-2xl"></i>
                            </div>
                                <p class="text-gray-400 text-lg mb-2">{{ t('noAvailableTemplates') }}</p>
                                <p class="text-gray-500 text-sm">{{ t('pleaseSelectTaskType') }}</p>
                        </div>
                    </div>

                    <!-- ÂéÜÂè≤ËÆ∞ÂΩïÂÜÖÂÆπ -->
                    <div v-if="promptModalTab === 'history'" class="overflow-y-auto max-h-[50vh]">
                            <div v-if="promptHistory.length === 0"
                                class="flex flex-col items-center justify-center py-12 text-center">
                                <div
                                    class="w-16 h-16 bg-laser-purple/20 rounded-full flex items-center justify-center mb-4">
                                <i class="fas fa-history text-gradient-icon text-2xl"></i>
                            </div>
                                <p class="text-gray-400 text-lg mb-2">{{ t('noHistoryRecords') }}</p>
                                <p class="text-gray-500 text-sm">{{ t('promptHistoryAutoSave') }}</p>
                        </div>
                        <div v-else class="space-y-3">
                            <div class="flex items-center justify-between mb-4">
                                    <span class="text-sm text-gray-400">{{ promptHistory.length }} {{ t('records') }}</span>
                                <button @click="clearPromptHistory" 
                                        class="text-xs text-red-400 hover:text-red-300 transition-colors flex items-center gap-1"
                                        title="{{ t('clearHistory') }}">
                                    <i class="fas fa-trash"></i>
                                        {{ t('clear') }}
                                </button>
                            </div>
                                <button v-for="(history, index) in promptHistory" :key="index"
                                @click="selectPromptHistory(history)"
                                    class="w-full p-4 text-left bg-dark-light rounded-lg hover:bg-laser-purple/20 transition-all border border-transparent hover:border-laser-purple/40 group">
                                    <div
                                        class="text-sm text-gray-300 line-clamp-3 leading-relaxed group-hover:text-white transition-colors">
                                    {{ history }}
                                </div>
                                <div class="mt-2 flex items-center justify-between">
                                        <span class="text-xs text-laser-purple/60">{{ t('clickApply') }}</span>
                                        <i
                                            class="fas fa-arrow-right text-xs text-laser-purple/60 group-hover:translate-x-1 transition-transform"></i>
                                </div>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

            <!-- Ê®°ÊùøËØ¶ÊÉÖÂºπÁ™ó -->
            <div v-cloak>
                <div v-if="showTemplateDetailModal"
                    class="fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4"
                    @click="closeTemplateDetailModal">
                    <div class="bg-secondary rounded-xl max-w-6xl w-full max-h-[90vh] overflow-hidden" @click.stop>
                        <!-- ÂºπÁ™óÂ§¥ÈÉ® -->
                        <div class="flex items-center justify-between p-6 border-b border-gray-700">
                            <h3 class="text-xl font-medium text-white flex items-center">
                                <i class="fas fa-star text-laser-purple mr-3"></i>
                                {{ t('templateDetail') }}
                            </h3>
                            <button @click="closeTemplateDetailModal"
                                class="text-gray-400 hover:text-white transition-colors">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        
                        <!-- ÂºπÁ™óÂÜÖÂÆπ -->
                        <div class="flex h-[calc(90vh-120px)]">
                            <!-- Â∑¶‰æßËßÜÈ¢ëÊí≠ÊîæÂå∫Âüü -->
                            <div class="flex-1 p-6">
                                <div class="w-full h-full bg-gray-900 rounded-lg overflow-hidden">
                                    <video 
                                    :src="getTemplateFileUrl(selectedTemplate.outputs.output_video,'videos')"
                                    :poster="getTemplateFileUrl(selectedTemplate.inputs.input_image,'images')"
                                        class="w-full h-full object-contain" controls autoplay preload="metadata"
                                        @loadeddata="onVideoLoaded($event)"></video>
                                </div>
                            </div>
                            
                            <!-- Âè≥‰æßÊ®°Êùø‰ø°ÊÅØÂå∫Âüü -->
                            <div class="w-[28rem] overflow-y-auto border-l border-gray-700">
                                <div class="p-6 space-y-6">
                                    <!-- Êìç‰ΩúÊåâÈíÆ -->
                                    <div class="flex flex-col space-y-3 items-center">
                                        <button @click="useTemplate(selectedTemplate)"
                                            class="w-3/4 px-4 py-3 bg-laser-purple/20 text-laser-purple border border-laser-purple/40 rounded-xl hover:bg-laser-purple/30 transition-all duration-200 font-medium">
                                            {{ t('useTemplate') }}
                                        </button>

                                    </div>  
                                    
                                    <!-- Ê®°Êùø‰ø°ÊÅØ -->
                                    <div>
                                        <h4 class="text-lg font-medium text-white mb-3">{{ t('templateInfo') }}</h4>
                                        <div class="space-y-2 text-sm">
                                            <div class="flex justify-between">
                                                <span class="text-gray-400">{{ t('model') }}:</span>
                                                <span class="text-white">{{
                                                    selectedTemplate?.model_cls }}</span>
                                            </div>
                                            <div class="flex justify-between">
                                                <span class="text-gray-400">{{ t('type') }}:</span>
                                                <span class="text-white">{{
                                                    selectedTemplate?.task_type }}</span>
                                            </div>
                                            <div class="flex justify-between">
                                                <span class="text-gray-400">{{ t('prompt') }}:</span>
                                                <span class="text-white text-xs">{{
                                                    selectedTemplate?.params?.prompt }}</span>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- ËæìÂÖ•Á¥†Êùê -->
                                    <div>
                                        <h4 class="text-lg font-medium text-white mb-3">{{ t('inputMaterials') }}</h4>
                                        <div class="space-y-4">
                                            <!-- ËæìÂÖ•ÂõæÁâá -->
                                            <div v-if="selectedTemplate?.inputs?.input_image">
                                                <label class="text-sm text-gray-400 mb-2 block">{{ t('inputImage') }}</label>
                                                <div class="w-32 h-32 bg-gray-800 rounded-lg overflow-hidden">
                                                    <img :src="getTemplateFileUrl(selectedTemplate.inputs.input_image,'images')" :alt="'ËæìÂÖ•ÂõæÁâá'"
                                                        class="w-full h-full object-cover" />
                                                </div>
                                            </div>
                                            
                                            <!-- ËæìÂÖ•Èü≥È¢ë -->
                                            <div v-if="selectedTemplate?.inputs?.input_audio">
                                                <label class="text-sm text-gray-400 mb-2 block">{{ t('inputAudio') }}</label>
                                                <div class="bg-gray-800 rounded-lg p-3">
                                                    <audio :src="getTemplateFileUrl(selectedTemplate.inputs.input_audio,'audios')" controls
                                                        class="w-full" preload="metadata"></audio>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ‰ªªÂä°ËØ¶ÊÉÖÂºπÁ™ó -->
            <div v-cloak>
                <div v-if="showTaskDetailModal"
                    class="fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4"
                    @click="closeTaskDetailModal">
                    <!-- ‰ªªÂä°ÂÆåÊàêÊó∂ÁöÑÂ§ßÂºπÁ™ó -->
                    <div v-if="modalTask?.status === 'SUCCEED'"
                        class="bg-secondary rounded-xl max-w-7xl w-full max-h-[95vh] overflow-hidden" @click.stop>
                        <!-- ÂºπÁ™óÂ§¥ÈÉ® -->
                        <div class="flex items-center justify-between p-6 border-b border-gray-700">
                            <h3 class="text-xl font-medium text-white flex items-center">
                                <i class="fas fa-info-circle text-gradient-icon mr-2"></i>
                                {{ t('taskDetail') }}
                            </h3>
                            <button @click="closeTaskDetailModal"
                                class="text-gray-400 hover:text-white transition-colors">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>

                        <!-- Â∑¶Âè≥Â∏ÉÂ±ÄÂÜÖÂÆπ -->
                        <div class="flex h-[calc(100vh-120px)]">
                            <!-- Â∑¶‰æßËßÜÈ¢ëÊí≠ÊîæÂô® -->
                            <div class="flex-1 p-6">
                                <div class="h-full bg-black rounded-xl border border-laser-purple/50 overflow-hidden">
                        <video
                            v-if="selectedTaskFiles.outputs.output_video && selectedTaskFiles.outputs.output_video.url"
                                        class="w-full h-full object-contain" controls preload="metadata"
                            :src="selectedTaskFiles.outputs.output_video.url">
                                        {{ t('browserNotSupported') }}
                        </video>
                        <div v-else-if="selectedTaskFiles.outputs.output_video && selectedTaskFiles.outputs.output_video.error"
                            class="w-full h-full flex items-center justify-center bg-red-900/20">
                            <div class="text-center">
                                <i class="fas fa-exclamation-triangle text-red-400 text-2xl mb-2"></i>
                                            <p class="text-red-400 text-sm">{{ t('videoLoadFailed') }}</p>
                            </div>
                        </div>
                                    <div v-else class="w-full h-full flex items-center justify-center bg-gray-700">
                            <div class="text-center">
                                <i class="fas fa-spinner fa-spin text-gray-400 text-2xl mb-2"></i>
                                            <p class="text-gray-400 text-sm">{{ t('loadingVideo') }}...</p>
                            </div>
                        </div>
                    </div>
                </div>

                            <!-- Âè≥‰æß‰ªªÂä°ËØ¶ÊÉÖ -->
                            <div class="w-[28rem] overflow-y-auto border-l border-gray-700">
                                <!-- ‰ªªÂä°Êìç‰ΩúÊåâÈíÆ -->
                                <div class="flex flex-col space-y-3 items-center">
                                    <button v-if="['CREATED', 'PENDING', 'RUNNING'].includes(modalTask?.status)"
                                            @click="cancelTask(modalTask.task_id, true); closeTaskDetailModal()"
                                            class="w-3/4 px-4 py-3 bg-gray-700/50 hover:bg-gray-600/50 text-white border border-gray-600/30 rounded-xl text-sm transition-all duration-200 hover:border-gray-500/50">
                                        <i class="fas fa-times mr-2"></i>
                                        {{ t('cancelTask') }}
                                    </button>
                                    <button v-if="['SUCCEED', 'FAILED', 'CANCEL'].includes(modalTask?.status)"
                                            @click="reuseTask(modalTask); closeTaskDetailModal()"
                                            class="w-3/4 px-4 py-3 bg-laser-purple/20 hover:bg-laser-purple/30 text-white border border-laser-purple/40 rounded-xl text-sm transition-all duration-200 hover:border-laser-purple/60">
                                        <i class="fas fa-copy mr-2"></i>
                                        {{ t('reuseTask') }}
                                    </button>
                                    <button v-if="['SUCCEED', 'FAILED', 'CANCEL'].includes(modalTask?.status)"
                                            @click="resumeTask(modalTask.task_id, true); closeTaskDetailModal()"
                                            class="w-3/4 px-4 py-3 bg-gray-700/50 hover:bg-gray-600/50 text-white border border-gray-600/30 rounded-xl text-sm transition-all duration-200 hover:border-gray-500/50">
                                        <i class="fas fa-redo mr-2"></i>
                                        {{ t('regenerateTask') }}
                                    </button>
                                    <button
                                        v-if="selectedTaskFiles.outputs.output_video && selectedTaskFiles.outputs.output_video.url"
                                            @click="downloadFile(selectedTaskFiles.outputs.output_video)"
                                            class="w-3/4 px-4 py-3 bg-gray-700/50 hover:bg-gray-600/50 text-white border border-gray-600/30 rounded-xl text-sm transition-all duration-200 hover:border-gray-500/50">
                                        <i class="fas fa-download mr-2"></i>
                                        {{ t('downloadVideo') }}
                                    </button>
                                    <button v-if="['SUCCEED', 'FAILED', 'CANCEL'].includes(modalTask?.status)"
                                            @click="deleteTask(modalTask.task_id, true); closeTaskDetailModal()"
                                            class="w-3/4 px-4 py-3 bg-red-900/20 hover:bg-red-900/30 text-red-400 border border-red-500/30 rounded-xl text-sm transition-all duration-200 hover:border-red-500/50">
                                        <i class="fas fa-trash mr-2"></i>
                                        {{ t('deleteTask') }}
                                    </button>
            </div>
                                <div class="p-6 space-y-6">
                                    <!-- ‰ªªÂä°Áä∂ÊÄÅÊòæÁ§∫ -->
                                    <div class="bg-secondary/30 rounded-xl p-4">
                                <h4 class="text-sm font-medium mb-3 flex items-center">
                                    <i class="fas fa-info-circle text-gradient-icon mr-2"></i>
                                            {{ t('taskInfo') }}
                                </h4>
                                <ul class="space-y-2 text-sm">
                                    <li class="flex justify-between">
                                                <span class="text-gray-400">{{ t('taskID') }}</span>
                                        <span class="text-xs">{{ modalTask?.task_id }}</span>
                                    </li>
                                    <li class="flex justify-between">
                                                <span class="text-gray-400">{{ t('taskType') }}</span>
                                        <span>{{ getTaskTypeName(modalTask) }}</span>
                                    </li>
                                    <li class="flex justify-between">
                                                <span class="text-gray-400">{{ t('modelName') }}</span>
                                        <span class="text-gradient-icon">{{ modalTask?.model_cls }}</span>
                                    </li>
                                    <li class="flex justify-between">
                                                <span class="text-gray-400">{{ t('createTime') }}</span>
                                        <span>{{ formatTime(modalTask?.create_t) }}</span>
                                    </li>
                                    <li class="flex justify-between">
                                                <span class="text-gray-400">{{ t('updateTime') }}</span>
                                        <span>{{ formatTime(modalTask?.update_t) }}</span>
                                    </li>
                                    <li class="flex justify-between">
                                                <span class="text-gray-400">{{ t('status') }}</span>
                                                <span :class="getStatusTextClass(modalTask?.status)">{{
                                                    getTaskStatusDisplay(modalTask?.status) }}</span>
                                    </li>
                                </ul>
        </div>

                                    <!-- ÊèêÁ§∫ËØç -->
                                    <div class="bg-secondary/30 rounded-xl p-4">
                                        <h4 class="text-sm font-medium mb-3 flex items-center">
                                            <i class="fas fa-file-alt text-gradient-icon mr-2"></i>
                                            {{ t('prompt') }}
                                        </h4>
                                        <div class="bg-dark-light rounded-lg p-3 text-sm text-gray-300">
                                            <p>{{ modalTask?.params?.prompt || t('noPrompt') }}</p>
                                </div>
                                </div>

                                    <!-- ‰∏ä‰º†Á¥†Êùê -->
                                    <div v-if="modalTask?.inputs && Object.keys(modalTask.inputs).length"
                                        class="bg-secondary/30 rounded-xl p-4">
                                <h4 class="text-sm font-medium mb-3 flex items-center">
                                    <i class="fas fa-upload text-gradient-icon mr-2"></i>
                                            {{ t('uploadMaterials') }}
                                            <span v-if="loadingTaskFiles"
                                                class="ml-2 text-xs text-gray-400">({{ t('loading') }}...)</span>
                                </h4>
                                <div class="space-y-3">
                                    <template v-for="(input, key) in modalTask.inputs" :key="key">
                                        <div class="flex items-center gap-3">
                                            <template v-if="key.includes('image')">
                                                <i class="fas fa-image text-gradient-icon text-lg"></i>
                                                <div class="flex items-center gap-2">
                                                            <span
                                                                v-if="!selectedTaskFiles.inputs[key] || !selectedTaskFiles.inputs[key].url"
                                                                class="text-gray-400 text-sm">{{ typeof input ===
                                                                'string' ? input : t('image') }}</span>
                                                    <div class="flex items-center gap-2 relative group">
                                                        <img v-if="selectedTaskFiles.inputs[key] && selectedTaskFiles.inputs[key].url"
                                                            :src="selectedTaskFiles.inputs[key].url"
                                                            :alt="input"
                                                           
                                                            class="w-16 h-16 object-cover rounded bg-dark-light border border-gray-700">
                                                        <div v-else-if="selectedTaskFiles.inputs[key] && selectedTaskFiles.inputs[key].error"
                                                            class="w-16 h-16 rounded bg-red-900/20 border border-red-500/30 flex items-center justify-center">
                                                                    <i
                                                                        class="fas fa-exclamation-triangle text-red-400"></i>
                                                        </div>
                                                        <div v-else
                                                            class="w-16 h-16 rounded bg-gray-700 border border-gray-600 flex items-center justify-center">
                                                            <i class="fas fa-spinner fa-spin text-gray-400"></i>
                                                        </div>
                                                                <button
                                                                    v-if="selectedTaskFiles.inputs[key] && selectedTaskFiles.inputs[key].url"
                                                                @click="downloadFile(selectedTaskFiles.inputs[key])"
                                                                class="text-xs px-2 py-1 rounded">
                                                                    <i
                                                                        class="fas fa-download mr-1 text-white opacity-30 hover:opacity-100 transition-opacity"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                            </template>
                                            <template v-else-if="key.includes('audio')">
                                                <i class="fas fa-microphone text-gradient-icon text-lg"></i>
                                                <div class="flex items-center gap-2">
                                                            <span
                                                                v-if="!selectedTaskFiles.inputs[key] || !selectedTaskFiles.inputs[key].url"
                                                                class="text-gray-400 text-sm">{{ typeof input ===
                                                                'string' ? input : t('audioFile') }}</span>
                                                    <div class="flex items-center gap-2">
                                                                <audio
                                                                    v-if="selectedTaskFiles.inputs[key] && selectedTaskFiles.inputs[key].url"
                                                                    :src="selectedTaskFiles.inputs[key].url" controls
                                                            class="h-8 text-gradient-icon"
                                                            preload="metadata">
                                                            
                                                                    {{ t('browserNotSupported') }}
                                                        </audio>
                                                        <div v-else-if="selectedTaskFiles.inputs[key] && selectedTaskFiles.inputs[key].error"
                                                            class="h-8 px-3 rounded bg-red-900/20 border border-red-500/30 flex items-center">
                                                                    <i
                                                                        class="fas fa-exclamation-triangle text-red-400 text-xs"></i>
                                                        </div>
                                                        <div v-else
                                                            class="h-8 px-3 rounded bg-gray-700 border border-gray-600 flex items-center">
                                                                    <i
                                                                        class="fas fa-spinner fa-spin text-gray-400 text-xs"></i>
                                                        </div>
                                                                <button
                                                                    v-if="selectedTaskFiles.inputs[key] && selectedTaskFiles.inputs[key].url"
                                                                @click="downloadFile(selectedTaskFiles.inputs[key])"
                                                                class="text-xs px-2 py-1 rounded">
                                                                    <i
                                                                        class="fas fa-download mr-1 text-white opacity-30 hover:opacity-100 transition-opacity"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                            </template>
                                        </div>
                                    </template>
                                </div>
                            </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ÂÖ∂‰ªñÁä∂ÊÄÅÁöÑÂ∞èÂºπÁ™ó -->
                    <div v-else class="bg-secondary rounded-xl max-w-4xl w-full max-h-[90vh] overflow-hidden"
                        @click.stop>
                        <!-- ÂºπÁ™óÂ§¥ÈÉ® -->
                        <div class="flex items-center justify-between p-6 border-b border-gray-700">
                            <h3 class="text-xl font-medium text-white flex items-center">
                                <i class="fas fa-info-circle text-gradient-icon mr-2"></i>
                                {{ t('taskDetail') }}
                            </h3>
                            <button @click="closeTaskDetailModal"
                                class="text-gray-400 hover:text-white transition-colors">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>

                        <!-- ÂºπÁ™óÂÜÖÂÆπ -->
 

                        <div class="overflow-y-auto max-h-[calc(90vh-120px)] p-6">
                                <!-- ‰ªªÂä°ËøõË°å‰∏≠‰ø°ÊÅØ -->
                            <div v-if="['CREATED', 'PENDING', 'RUNNING'].includes(modalTask?.status)"
                                class="max-w-4xl mx-auto task-running-panel">
                                    <div class="text-center py-8">
                                    <div
                                        class="w-24 h-24 mx-auto bg-laser-purple/20 rounded-full flex items-center justify-center mb-6 animate-pulse-slow">
                                            <i class="fas fa-spinner fa-spin text-gradient-icon text-3xl"></i>
                                        </div>
                                    <h3 class="text-xl font-medium mb-2">{{ t('videoGenerating') }}</h3>
                                    <p class="text-gray-400 mb-6">{{ t('aiIsGeneratingYourVideo') }}...</p>
                                        
                                        <!-- Â≠ê‰ªªÂä°ËøõÂ∫¶ÊòæÁ§∫ -->
                                    <div v-if="modalTask && modalTask.subtasks && modalTask.subtasks.length > 0"
                                        class="progress-container">
                                            <h4 class="text-sm font-medium mb-4 flex items-center">
                                            <i class="fas fa-chart-line text-gradient-icon mr-2"></i>
                                            {{ t('taskProgress') }}
                                            </h4>
                                            
                                            <!-- ÊÄª‰ΩìËøõÂ∫¶Êù° -->
                                            <div class="mb-4">
                                                <div class="flex justify-between items-center mb-2">
                                                <span class="text-sm text-gray-300">{{
                                                    getProgressTitle(modalTask.subtasks || []) }}</span>
                                                <span class="text-sm text-gradient-icon">{{
                                                    getProgressInfo(modalTask.subtasks || []) }}</span>
                                                </div>
                                                <div class="progress-bar">
                                                <div class="progress-fill"
                                                    :style="{ width: getOverallProgress(modalTask.subtasks || []) + '%' }">
                                                </div>
                                                </div>
                                            </div>
                                            
                                            <!-- Â≠ê‰ªªÂä°ÂàóË°® -->
                                            <div class="space-y-2">
                                            <div v-for="(subtask, index) in (modalTask.subtasks || [])" :key="index"
                                                class="subtask-item">
                                                    <div class="subtask-header">
                                                    <span class="text-sm font-medium">{{ t('subtask') }} {{ index + 1 }}</span>
                                                        <span class="subtask-status" :class="subtask.status.toLowerCase()">
                                                            {{ getSubtaskStatusText(subtask.status) }}
                                                        </span>
                                                    </div>
                                                    
                                                    <!-- Â≠ê‰ªªÂä°ËøõÂ∫¶Êù° -->
                                                <div v-if="subtask.status === 'PENDING' || subtask.status === 'RUNNING'"
                                                    class="mt-2">
                                                        <div class="flex justify-between items-center mb-1">
                                                        <span class="text-xs text-gray-400">{{
                                                            getSubtaskStatusText(subtask.status) }}</span>
                                                        <span class="text-xs text-gradient-icon">{{
                                                            formatEstimatedTime(subtask) }}</span>
                                                        </div>
                                                        <div class="progress-bar">
                                                        <div class="progress-fill"
                                                            :style="{ width: getSubtaskProgress(subtask) + '%' }"></div>
                                                        </div>
                                                    </div>
                                                    
                                                    <!-- Â≠ê‰ªªÂä°ËØ¶ÁªÜ‰ø°ÊÅØ -->
                                                    <div class="subtask-info">
                                                    <div v-if="subtask.estimated_pending_order !== null"
                                                        class="flex items-center gap-2 mt-1">
                                                            <i class="fas fa-clock text-xs"></i>
                                                        <span>{{ t('queuePosition') }}: {{ subtask.estimated_pending_order }}</span>
                                                        </div>
                                                    <div v-if="subtask.ready_worker_count !== null"
                                                        class="flex items-center gap-2 mt-1">
                                                            <i class="fas fa-users text-xs"></i>
                                                        <span>{{ t('availableWorker') }}: {{ subtask.ready_worker_count }}</span>
                                                        </div>
                                                    <div v-if="subtask.fail_msg"
                                                        class="flex items-center gap-2 mt-1 text-red-400">
                                                            <i class="fas fa-exclamation-triangle text-xs"></i>
                                                            <span>{{ subtask.fail_msg }}</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- ‰ªªÂä°Â§±Ë¥•‰ø°ÊÅØ -->
                            <div v-if="modalTask?.status === 'FAILED'" class="max-w-4xl mx-auto task-failed-panel">
                                    <div class="text-center py-8">
                                    <div
                                        class="w-24 h-24 mx-auto bg-red-500/10 rounded-full flex items-center justify-center mb-6">
                                            <i class="fas fa-exclamation-triangle text-red-500 text-3xl"></i>
                                        </div>
                                    <h3 class="text-xl font-medium mb-2">{{ t('videoGeneratingFailed') }}</h3>
                                    <p
                                        class="text-gray-400 mb-4 max-w-md mx-auto flex items-center justify-center gap-2">
                                        {{ t('sorryYourVideoGenerationTaskFailed') }}
                                        <button v-if="getTaskFailureInfo(modalTask)" 
                                                    @click="showErrorDetails = !showErrorDetails" 
                                                    class="text-gray-400 hover:text-gray-100 transition-colors">
                                                <i class="fas fa-info-circle"></i>
                                            </button>
                                        </p>
                                        
                                        <!-- ÂèØÂ±ïÂºÄÁöÑÈîôËØØËØ¶ÊÉÖ -->
                                    <div v-if="showErrorDetails && getTaskFailureInfo(modalTask)" class="mt-4">
                                            <span class="text-xs">{{ getTaskFailureInfo(modalTask) }}</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- ‰ªªÂä°ÂèñÊ∂à‰ø°ÊÅØ -->
                            <div v-if="modalTask?.status === 'CANCEL'" class="max-w-4xl mx-auto task-cancelled-panel">
                                    <div class="text-center py-8">
                                    <div
                                        class="w-24 h-24 mx-auto bg-yellow-500/10 rounded-full flex items-center justify-center mb-6">
                                            <i class="fas fa-ban text-yellow-500 text-3xl"></i>
                                        </div>
                                    <h3 class="text-xl font-medium mb-2">{{ t('taskCancelled') }}</h3>
                                        <p class="text-gray-400 mb-4 max-w-md mx-auto">
                                        {{ t('thisTaskHasBeenCancelledYouCanRegenerateOrViewTheMaterialsYouUploadedBefore') }}
                                        </p>
                                    </div>

                                </div>

                            <!-- ‰ªªÂä°Êìç‰ΩúÊåâÈíÆ -->
                            <div class="flex justify-center space-x-3 p-4">
                            <button v-if="['CREATED', 'PENDING', 'RUNNING'].includes(modalTask?.status)"
                                    @click="cancelTask(modalTask.task_id, true); closeTaskDetailModal()"
                                            class="px-4 py-2 btn-primary rounded-lg text-sm transition-all">
                                        <i class="fas fa-times mr-2"></i>
                                    {{ t('cancelTask') }}
                                    </button>
                                <button
                                    v-if="['SUCCEED', 'FAILED', 'CANCEL','CREATED', 'PENDING', 'RUNNING'].includes(modalTask?.status)"
                                    @click="reuseTask(modalTask); closeTaskDetailModal()"
                                    class="px-4 py-3 bg-laser-purple/20 hover:bg-laser-purple/30 text-white border border-laser-purple/40 rounded-xl text-sm transition-all duration-200 hover:border-laser-purple/60">
                                <i class="fas fa-copy mr-2"></i>
                                    {{ t('reuseTask') }}
                                    </button>
                            <button v-if="['SUCCEED', 'FAILED', 'CANCEL'].includes(modalTask?.status)"
                                    @click="resumeTask(modalTask.task_id, true); closeTaskDetailModal()"
                                    class="px-4 py-3 bg-gray-700/50 hover:bg-gray-600/50 text-white border border-gray-600/30 rounded-xl text-sm transition-all duration-200 hover:border-gray-500/50">
                                        <i class="fas fa-redo mr-2"></i>
                                    {{ t('regenerateTask') }}
                                    </button>
                            <button v-if="['SUCCEED', 'FAILED', 'CANCEL'].includes(modalTask?.status)"
                                    @click="deleteTask(modalTask.task_id, true); closeTaskDetailModal()"
                                    class="px-4 py-3 bg-red-900/20 hover:bg-red-900/30 text-red-400 border border-red-500/30 rounded-xl text-sm transition-all duration-200 hover:border-red-500/50">
                                        <i class="fas fa-trash mr-2"></i>
                                    {{ t('deleteTask') }}
                                    </button>
                                </div>
                            
                                <!-- ‰ªªÂä°Áä∂ÊÄÅÊòæÁ§∫ -->
                                <div class="bg-secondary/30 rounded-xl p-6 mb-6">
                                    <h4 class="text-sm font-medium mb-3 flex items-center">
                                        <i class="fas fa-info-circle text-gradient-icon mr-2"></i>
                                    {{ t('taskInfo') }}
                                    </h4>
                                    <ul class="space-y-2 text-sm">
                                        <li class="flex justify-between">
                                        <span class="text-gray-400">{{ t('taskID') }}</span>
                                        <span>{{ modalTask?.task_id }}</span>
                                        </li>
                                        <li class="flex justify-between">
                                        <span class="text-gray-400">{{ t('taskType') }}</span>
                                        <span>{{ getTaskTypeName(modalTask) }}</span>
                                        </li>
                                        <li class="flex justify-between">
                                        <span class="text-gray-400">{{ t('modelName') }}</span>
                                        <span class="text-gradient-icon">{{ modalTask?.model_cls }}</span>
                                        </li>
                                        <li class="flex justify-between">
                                        <span class="text-gray-400">{{ t('createTime') }}</span>
                                        <span>{{ formatTime(modalTask?.create_t) }}</span>
                                        </li>
                                        <li class="flex justify-between">
                                        <span class="text-gray-400">{{ t('updateTime') }}</span>
                                        <span>{{ formatTime(modalTask?.update_t) }}</span>
                                        </li>
                                        <li class="flex justify-between">
                                        <span class="text-gray-400">{{ t('status') }}</span>
                                        <div class="flex items-center gap-2">
                                            <span :class="getStatusTextClass(modalTask?.status)">{{
                                                getTaskStatusDisplay(modalTask?.status) }}</span>
                                            <button
                                                v-if="modalTask?.status === 'FAILED' && getTaskFailureInfo(modalTask)"
                                                    @click="showFailureDetails = !showFailureDetails"
                                                    class="text-red-400 hover:text-red-300 transition-colors"
                                                title="{{ t('viewFailureReason') }}">
                                                <i class="fas fa-exclamation-triangle text-xs"></i>
                                            </button>
                                        </div>
                                        </li>
                                    </ul>
                                
                                <!-- Â§±Ë¥•ÂéüÂõ†ËØ¶ÊÉÖ -->
                                <div v-if="showFailureDetails && modalTask?.status === 'FAILED' && getTaskFailureInfo(modalTask)" 
                                     class="mt-4 p-3 bg-red-900/20 border border-red-500/30 rounded-lg">
                                    <div class="flex items-start gap-2">
                                        <i class="fas fa-exclamation-triangle text-red-400 text-sm mt-0.5"></i>
                                        <div class="flex-1">
                                            <p class="text-xs text-red-300 font-medium mb-1">{{ t('failureReason') }}:</p>
                                            <p class="text-xs text-red-200 whitespace-pre-wrap">{{
                                                getTaskFailureInfo(modalTask) }}</p>
                                        </div>
                                    </div>
                                </div>
                                </div>

                                <!-- ÊèêÁ§∫ËØç -->
                                <div class="bg-secondary/30 rounded-xl p-4 mb-6">
                                    <h4 class="text-sm font-medium mb-3 flex items-center">
                                        <i class="fas fa-file-alt text-gradient-icon mr-2"></i>
                                    {{ t('prompt') }}
                                    </h4>
                                    <div class="bg-dark-light rounded-lg p-4 text-sm text-gray-300">
                                    <p>{{ modalTask?.params?.prompt || t('noPrompt') }}</p>
                                    </div>
                                </div>

                            <!-- ‰∏ä‰º†Á¥†Êùê -->
                            <div v-if="modalTask?.inputs && Object.keys(modalTask.inputs).length"
                                class="bg-secondary/30 rounded-xl p-4 mb-6">
                                    <h4 class="text-sm font-medium mb-3 flex items-center">
                                        <i class="fas fa-upload text-gradient-icon mr-2"></i>
                                    {{ t('uploadMaterials') }}
                                    <span v-if="loadingTaskFiles" class="ml-2 text-xs text-gray-400">({{ t('loading') }}...)</span>
                                    </h4>
                                    <div class="space-y-3">
                                    <template v-for="(input, key) in modalTask.inputs" :key="key">
                                            <div class="flex items-center gap-3">
                                                <template v-if="key.includes('image')">
                                                    <i class="fas fa-image text-gradient-icon text-xl"></i>
                                                    <div class="flex items-center gap-2">
                                                    <span
                                                        v-if="!selectedTaskFiles.inputs[key] || !selectedTaskFiles.inputs[key].url"
                                                        class="text-gray-400 text-sm">{{ typeof input === 'string' ?
                                                        input : t('image') }}</span>
                                                        <div class="flex items-center gap-2 relative group">
                                                            <img v-if="selectedTaskFiles.inputs[key] && selectedTaskFiles.inputs[key].url"
                                                            :src="selectedTaskFiles.inputs[key].url" :alt="input"
                                                                class="w-20 h-20 object-cover rounded bg-dark-light border border-gray-700"
                                                                >
                                                            <div v-else-if="selectedTaskFiles.inputs[key] && selectedTaskFiles.inputs[key].error"
                                                                class="w-20 h-20 rounded bg-red-900/20 border border-red-500/30 flex items-center justify-center">
                                                                <i class="fas fa-exclamation-triangle text-red-400"></i>
                                                            </div>
                                                            <div v-else
                                                                class="w-20 h-20 rounded bg-gray-700 border border-gray-600 flex items-center justify-center">
                                                                <i class="fas fa-spinner fa-spin text-gray-400"></i>
                                                            </div>
                                                        <button
                                                            v-if="selectedTaskFiles.inputs[key] && selectedTaskFiles.inputs[key].url"
                                                                    @click="downloadFile(selectedTaskFiles.inputs[key])"
                                                                    class="text-xs px-2 py-1 rounded">
                                                            <i
                                                                class="fas fa-download mr-1 text-white opacity-30 hover:opacity-100 transition-opacity"></i>
                                                            </button>
                                                        </div>
                                                    </div>
                                                </template>
                                                <template v-else-if="key.includes('audio')">
                                                    <i class="fas fa-microphone text-gradient-icon text-xl"></i>
                                                    <div class="flex items-center gap-2">
                                                    <span
                                                        v-if="!selectedTaskFiles.inputs[key] || !selectedTaskFiles.inputs[key].url"
                                                        class="text-gray-400 text-sm">{{ typeof input === 'string' ?
                                                        input : t('audioFile') }}</span>
                                                        <div class="flex items-center gap-2">
                                                        <audio
                                                            v-if="selectedTaskFiles.inputs[key] && selectedTaskFiles.inputs[key].url"
                                                            :src="selectedTaskFiles.inputs[key].url" controls
                                                                class="h-8 text-gradient-icon"
                                                                preload="metadata">
                                                            {{ t('browserNotSupported') }}
                                                            </audio>
                                                            <div v-else-if="selectedTaskFiles.inputs[key] && selectedTaskFiles.inputs[key].error"
                                                                class="h-8 px-3 rounded bg-red-900/20 border border-red-500/30 flex items-center">
                                                            <i
                                                                class="fas fa-exclamation-triangle text-red-400 text-xs"></i>
                                                            </div>
                                                            <div v-else
                                                                class="h-8 px-3 rounded bg-gray-700 border border-gray-600 flex items-center">
                                                                <i class="fas fa-spinner fa-spin text-gray-400 text-xs"></i>
                                                            </div>
                                                        <button
                                                            v-if="selectedTaskFiles.inputs[key] && selectedTaskFiles.inputs[key].url"
                                                                    @click="downloadFile(selectedTaskFiles.inputs[key])"
                                                                    class="text-xs px-2 py-1 rounded">
                                                            <i
                                                                class="fas fa-download mr-1 text-white opacity-30 hover:opacity-100 transition-opacity"></i>
                                                            </button>
                                                    </div>
                                </div>
                                                </template>
                                    </div>
                                        </template>
                                    </div>
                                </div>

                </div>
            </div>
        </div>
    </div>

        </div>
    </div>
</div>
</div>


    <script src="https://unpkg.com/vue@3/dist/vue.global.js">
    </script>

    <script>
        const { createApp, ref, computed, onMounted, onUnmounted, watch, nextTick } = Vue;

        createApp({
            setup() {
                // ÂìçÂ∫îÂºèÊï∞ÊçÆ
                const loading = ref(false);
                const loginLoading = ref(false);
                const initLoading = ref(false);
                const downloadLoading = ref(false);
                const alert = ref({ show: false, message: '', type: 'info' });
                const showErrorDetails = ref(false);
                const showFailureDetails = ref(false);

                // ËØ≠Ë®ÄÂàáÊç¢Áõ∏ÂÖ≥
                const currentLanguage = ref('zh'); // 'zh' Êàñ 'en'
                const showLanguageMenu = ref(false);
                const languageLoaded = ref(false); // ËØ≠Ë®ÄÊòØÂê¶Â∑≤Âä†ËΩΩÂÆåÊàê
                
                // ‰ªªÂä°Á±ªÂûã‰∏ãÊãâËèúÂçï
                const showTaskTypeMenu = ref(false);
                const showModelMenu = ref(false);
                const languageOptions = ref([
                    { code: 'zh', name: '‰∏≠Êñá', flag: 'ZH' },
                    { code: 'en', name: 'English', flag: 'EN' }
                ]);

                // ÁøªËØëÂáΩÊï∞
                const t = (key) => {
                    if (!languageLoaded.value) {
                        return '...'; // ËØ≠Ë®ÄÊú™Âä†ËΩΩÂÆåÊàêÊó∂ËøîÂõûÂç†‰ΩçÁ¨¶ÔºåÈÅøÂÖçÊòæÁ§∫ÂéüÂßãkey
                    }
                    return translations.value[currentLanguage.value]?.[key] || key;
                };
                // Â§öËØ≠Ë®ÄÊñáÊú¨Êò†Â∞Ñ
                const translations = ref({
                    zh: {
                        // ÈÄöÁî®
                        total: 'ÂÖ±',
                        tasks: 'Êù°',
                        records: 'Êù°',
                        noImageTemplates: 'ÁõÆÂâçÊöÇÊó†ÂõæÁâáÊ®°Êùø',
                        noAudioTemplates: 'ÁõÆÂâçÊöÇÊó†Èü≥È¢ëÊ®°Êùø',
                        noHistoryTasks: 'ÊöÇÊó†ÂéÜÂè≤‰ªªÂä°',
                        templateDetail: 'Ê®°ÊùøËØ¶ÊÉÖ',
                        templateInfo: 'Ê®°Êùø‰ø°ÊÅØ',
                        useTemplate: '‰ΩøÁî®Ê®°Êùø',
                        model: 'Ê®°Âûã',
                        type: 'Á±ªÂûã',
                        inputMaterials: '‰∏ä‰º†Á¥†Êùê',
                        inputImage: 'ËæìÂÖ•ÂõæÁâá',
                        inputAudio: 'ËæìÂÖ•Èü≥È¢ë',
                        imageTemplates: 'ÂõæÁâáÊ®°Êùø',
                        audioTemplates: 'Èü≥È¢ëÊ®°Êùø',
                        audio: 'Èü≥È¢ë',

                        // È°µÈù¢Ê†áÈ¢ò
                        pageTitle: 'LightX2VÊúçÂä°',
                        pleaseEnterThePromptForVideoGeneration: 'ËØ∑ËæìÂÖ•ËßÜÈ¢ëÁîüÊàêÊèêÁ§∫ËØç',
                        describeTheContentStyleSceneOfTheVideo: 'ÊèèËø∞ËßÜÈ¢ëÂÜÖÂÆπ„ÄÅÈ£éÊ†º„ÄÅÂú∫ÊôØÁ≠â...',
                        describeTheDigitalHumanImageBackgroundStyleActionRequirements: 'ÊèèËø∞Êï∞Â≠ó‰∫∫ÂΩ¢Ë±°„ÄÅËÉåÊôØÈ£éÊ†º„ÄÅÂä®‰ΩúË¶ÅÊ±ÇÁ≠â...',
                        describeTheContentActionRequirementsBasedOnTheImage: 'ÊèèËø∞Âü∫‰∫éÂõæÁâáÁöÑËßÜÈ¢ëÂÜÖÂÆπ„ÄÅÂä®‰ΩúË¶ÅÊ±ÇÁ≠â...',
                        loginSubtitle: '‰∏Ä‰∏™Âº∫Â§ßÁöÑËßÜÈ¢ëÁîüÊàêÂπ≥Âè∞',

                        // ÁôªÂΩïÁõ∏ÂÖ≥
                        loginWithGitHub: '‰ΩøÁî®GitHubÁôªÂΩï',
                        loggingIn: 'ÁôªÂΩï‰∏≠...',
                        logout: 'ÈÄÄÂá∫ÁôªÂΩï',
                        loggedOut: 'Â∑≤ÈÄÄÂá∫ÁôªÂΩï',
                        loginFailed: 'ÁôªÂΩïÂ§±Ë¥•',
                        loginError: 'ÁôªÂΩïËøáÁ®ã‰∏≠ÂèëÁîüÈîôËØØ',
                        authFailed: 'ËÆ§ËØÅÂ§±Ë¥•ÔºåËØ∑ÈáçÊñ∞ÁôªÂΩï',
                        loginExpired: 'ÁôªÂΩïÂ∑≤ËøáÊúüÔºåËØ∑ÈáçÊñ∞ÁôªÂΩï',

                        // ÂäüËÉΩÁâπÊÄß
                        feature1: 'ÁîµÂΩ±Á∫ßÊï∞Â≠ó‰∫∫ËßÜÈ¢ë',
                        feature2: '20ÂÄçÁîüÊàêÊèêÈÄü',
                        feature3: 'Ë∂Ö‰ΩéÊàêÊú¨ÁîüÊàê',
                        feature4: 'Á≤æÂáÜÂè£ÂûãÂØπÈΩê',
                        feature5: 'ÂàÜÈíüÁ∫ßËßÜÈ¢ëÊó∂Èïø',
                        feature6: 'Â§öÂú∫ÊôØÂ∫îÁî®',

                        // ÂØºËà™ÂíåËèúÂçï
                        generateVideo: 'ÁîüÊàêËßÜÈ¢ë',
                        history: 'ÂéÜÂè≤ËÆ∞ÂΩï',
                        inspiration: 'ÁÅµÊÑüÂπøÂú∫',
                        myProjects: 'ÊàëÁöÑÈ°πÁõÆ',
                        discoverCreativity: 'ÂèëÁé∞ÂàõÊÑèÔºåÊøÄÂèëÁÅµÊÑü',
                        searchTasks: 'ÊêúÁ¥¢ÂéÜÂè≤‰ªªÂä°...',
                        searchInspiration: 'ÊêúÁ¥¢ÁÅµÊÑü...',
                        refresh: 'Âà∑Êñ∞‰ªªÂä°ÂàóË°®',
                        noHistoryTasks: 'ÊöÇÊó†ÂéÜÂè≤‰ªªÂä°',
                        startToCreateYourFirstAIVideo: 'ÂºÄÂßãÂàõÂª∫‰Ω†ÁöÑÁ¨¨‰∏Ä‰∏™AIËßÜÈ¢ëÂêß',
                        switchLanguage: 'ÂàáÊç¢ËØ≠Ë®Ä',
                        selectTaskType: 'ÈÄâÊã©‰ªªÂä°Á±ªÂûã',
                        selectTaskTypeFirst: 'ËØ∑ÂÖàÈÄâÊã©‰ªªÂä°Á±ªÂûã',
                        noHistoryRecords: 'ÊöÇÊó†ÂéÜÂè≤ËÆ∞ÂΩï',
                        imageHistoryAutoSave: 'ÂºÄÂßã‰ΩøÁî®ÂõæÁâáÂêéÔºåÂéÜÂè≤ËÆ∞ÂΩïÂ∞ÜËá™Âä®‰øùÂ≠ò',
                        audioHistoryAutoSave: 'ÂºÄÂßã‰ΩøÁî®Èü≥È¢ëÂêéÔºåÂéÜÂè≤ËÆ∞ÂΩïÂ∞ÜËá™Âä®‰øùÂ≠ò',
                        clearHistory: 'Ê∏ÖÁ©∫ÂéÜÂè≤ËÆ∞ÂΩï',
                        clear: 'Ê∏ÖÁ©∫',
                        promptHistoryAutoSave: 'ÂºÄÂßãÂàõÂª∫‰ªªÂä°ÂêéÔºåÊèêÁ§∫ËØçÂ∞ÜËá™Âä®‰øùÂ≠ò',
                        searchTasks: 'ÊêúÁ¥¢‰ªªÂä°',
                        initializationFailed: 'ÂàùÂßãÂåñÂ§±Ë¥•ÔºåËØ∑Âà∑Êñ∞È°µÈù¢ÈáçËØï',
                        browserNotSupported: 'ÊÇ®ÁöÑÊµèËßàÂô®‰∏çÊîØÊåÅÊí≠Êîæ',
                        videoLoadFailed: 'ËßÜÈ¢ëÂä†ËΩΩÂ§±Ë¥•',
                        loadingVideo: 'Âä†ËΩΩËßÜÈ¢ë‰∏≠',
                        videoGenerating: 'ËßÜÈ¢ëÁîüÊàê‰∏≠',
                        taskProgress: '‰ªªÂä°ËøõÂ∫¶',
                        subtask: 'Â≠ê‰ªªÂä°',
                        queuePosition: 'ÈòüÂàó‰ΩçÁΩÆ',
                        availableWorker: 'ÂèØÁî®Worker',
                        videoGeneratingFailed: 'ËßÜÈ¢ëÁîüÊàêÂ§±Ë¥•',
                        sorryYourVideoGenerationTaskFailed: 'ÂæàÊä±Ê≠âÔºåÊÇ®ÁöÑËßÜÈ¢ëÁîüÊàê‰ªªÂä°Êú™ËÉΩÂÆåÊàê„ÄÇ',
                        thisTaskHasBeenCancelledYouCanRegenerateOrViewTheMaterialsYouUploadedBefore: 'Ê≠§‰ªªÂä°Â∑≤Ë¢´ÂèñÊ∂àÔºåÊÇ®ÂèØ‰ª•ÈáçÊñ∞ÁîüÊàêÊàñÊü•Áúã‰πãÂâç‰∏ä‰º†ÁöÑÁ¥†Êùê„ÄÇ',
                        taskCancelled: '‰ªªÂä°Â∑≤ÂèñÊ∂à',
                        taskDetail: '‰ªªÂä°ËØ¶ÊÉÖ',
                        taskInfo: '‰ªªÂä°‰ø°ÊÅØ',
                        taskID: '‰ªªÂä°ID',
                        taskType: '‰ªªÂä°Á±ªÂûã',
                        modelName: 'Ê®°ÂûãÂêçÁß∞',
                        createTime: 'ÂàõÂª∫Êó∂Èó¥',
                        updateTime: 'Êõ¥Êñ∞Êó∂Èó¥',
                        status: 'Áä∂ÊÄÅ',
                        viewFailureReason: 'Êü•ÁúãÂ§±Ë¥•ÂéüÂõ†',
                        failureReason: 'Â§±Ë¥•ÂéüÂõ†',
                        noPrompt: 'Êó†ÊèêÁ§∫ËØç',
                        uploadMaterials: '‰∏ä‰º†Á¥†Êùê',
                        loading: 'Âä†ËΩΩ‰∏≠',
                        image: 'ÂõæÁâá',
                        audioFile: 'Èü≥È¢ëÊñá‰ª∂',
                        browserNotSupported: 'ÊÇ®ÁöÑÊµèËßàÂô®‰∏çÊîØÊåÅÊí≠Êîæ',
                        videoLoadFailed: 'ËßÜÈ¢ëÂä†ËΩΩÂ§±Ë¥•',
                        loadingVideo: 'Âä†ËΩΩËßÜÈ¢ë‰∏≠',
                        videoGenerating: 'ËßÜÈ¢ëÁîüÊàê‰∏≠',
                        taskProgress: '‰ªªÂä°ËøõÂ∫¶',
                        subtask: 'Â≠ê‰ªªÂä°',
                        queuePosition: 'ÈòüÂàó‰ΩçÁΩÆ',
                        availableWorker: 'ÂèØÁî®Worker',
                        videoGeneratingFailed: 'ËßÜÈ¢ëÁîüÊàêÂ§±Ë¥•',
                        sorryYourVideoGenerationTaskFailed: 'ÂæàÊä±Ê≠âÔºåÊÇ®ÁöÑËßÜÈ¢ëÁîüÊàê‰ªªÂä°Êú™ËÉΩÂÆåÊàê„ÄÇ',
                        thisTaskHasBeenCancelledYouCanRegenerateOrViewTheMaterialsYouUploadedBefore: 'Ê≠§‰ªªÂä°Â∑≤Ë¢´ÂèñÊ∂àÔºåÊÇ®ÂèØ‰ª•ÈáçÊñ∞ÁîüÊàêÊàñÊü•Áúã‰πãÂâç‰∏ä‰º†ÁöÑÁ¥†Êùê„ÄÇ',
                        taskCancelled: '‰ªªÂä°Â∑≤ÂèñÊ∂à',
                        taskDetail: '‰ªªÂä°ËØ¶ÊÉÖ',
                        taskInfo: '‰ªªÂä°‰ø°ÊÅØ',
                        taskID: '‰ªªÂä°ID',
                        taskType: '‰ªªÂä°Á±ªÂûã',
                        modelName: 'Ê®°ÂûãÂêçÁß∞',
                        createTime: 'ÂàõÂª∫Êó∂Èó¥',
                        updateTime: 'Êõ¥Êñ∞Êó∂Èó¥',
                        viewFailureReason: 'Êü•ÁúãÂ§±Ë¥•ÂéüÂõ†',
                        failureReason: 'Â§±Ë¥•ÂéüÂõ†',
                        noPrompt: 'Êó†ÊèêÁ§∫ËØç',
                        uploadMaterials: '‰∏ä‰º†Á¥†Êùê',
                        loading: 'Âä†ËΩΩ‰∏≠',
                        image: 'ÂõæÁâá',
                        audioFile: 'Èü≥È¢ëÊñá‰ª∂',
                        status: 'Áä∂ÊÄÅ',
                        browserNotSupported: 'ÊÇ®ÁöÑÊµèËßàÂô®‰∏çÊîØÊåÅÊí≠Êîæ',
                        videoLoadFailed: 'ËßÜÈ¢ëÂä†ËΩΩÂ§±Ë¥•',
                        loadingVideo: 'Âä†ËΩΩËßÜÈ¢ë‰∏≠',
                        videoGenerating: 'ËßÜÈ¢ëÁîüÊàê‰∏≠',

                        // ‰ªªÂä°Áä∂ÊÄÅ
                        succeed: 'ÊàêÂäü',
                        success: 'ÊàêÂäü',
                        failed: 'Â§±Ë¥•',
                        running: 'ËøêË°å‰∏≠',
                        pending: 'Á≠âÂæÖ‰∏≠',
                        cancelled: 'Â∑≤ÂèñÊ∂à',
                        all: 'ÂÖ®ÈÉ®',

                        // ‰ªªÂä°Êìç‰Ωú
                        reuseTask: 'Â§çÁî®‰ªªÂä°',
                        regenerateTask: 'ÈáçÊñ∞ÁîüÊàê',
                        cancelTask: 'ÂèñÊ∂à‰ªªÂä°',
                        retryTask: 'ÈáçËØï‰ªªÂä°',
                        downloadTask: '‰∏ãËΩΩËßÜÈ¢ë',
                        downloadVideo: '‰∏ãËΩΩËßÜÈ¢ë',
                        deleteTask: 'Âà†Èô§‰ªªÂä°',

                        // ‰ªªÂä°ÂàõÂª∫
                        createVideo: 'ÂàõÂª∫ËßÜÈ¢ë',
                        selectTemplate: 'ÈÄâÊã©Ê®°Êùø',
                        uploadImage: '‰∏ä‰º†ÂõæÁâá',
                        uploadAudio: '‰∏ä‰º†Èü≥È¢ë',
                        enterPrompt: 'ËæìÂÖ•ÊèêÁ§∫ËØç',
                        selectModel: 'ÈÄâÊã©Ê®°Âûã',
                        startGeneration: 'ÂºÄÂßãÁîüÊàê',
                        templates: 'Á¥†Êùê',

                        // Ê®°ÂûãÂíå‰ªªÂä°Á±ªÂûã
                        textToVideo: 'ÊñáÁîüËßÜÈ¢ë',
                        imageToVideo: 'ÂõæÁîüËßÜÈ¢ë',
                        speechToVideo: 'Êï∞Â≠ó‰∫∫',

                        // ÊèêÁ§∫ËØçÁõ∏ÂÖ≥
                        prompt: 'ÊèêÁ§∫ËØç',
                        negativePrompt: 'Ë¥üÈù¢ÊèêÁ§∫ËØç',
                        promptTemplates: 'ÊèêÁ§∫ËØçÊ®°Êùø',
                        promptHistory: 'ÊèêÁ§∫ËØçÂéÜÂè≤',

                        // Êñá‰ª∂‰∏ä‰º†
                        uploadImageFile: '‰∏ä‰º†ÂõæÁâáÊñá‰ª∂',
                        uploadAudioFile: '‰∏ä‰º†Èü≥È¢ëÊñá‰ª∂',
                        dragDropHere: 'ÊãñÊãΩÊñá‰ª∂Âà∞Ê≠§Â§ÑÊàñÁÇπÂáª‰∏ä‰º†',
                        supportedImageFormats: 'ÊîØÊåÅjpg„ÄÅpng„ÄÅwebpÂõæÁâáÊ†ºÂºèÔºà10MB‰ª•ÂÜÖÔºâ',
                        supportedAudioFormats: 'ÊîØÊåÅmp3„ÄÅm4a„ÄÅwavÈü≥È¢ëÊ†ºÂºèÔºà120s‰ª•ÂÜÖÔºâ',
                        maxFileSize: 'ÊúÄÂ§ßÊñá‰ª∂Â§ßÂ∞è',

                        // ‰ªªÂä°ËØ¶ÊÉÖ
                        taskDetails: '‰ªªÂä°ËØ¶ÊÉÖ',
                        taskId: '‰ªªÂä°ID',
                        taskType: '‰ªªÂä°Á±ªÂûã',
                        taskStatus: '‰ªªÂä°Áä∂ÊÄÅ',
                        createdAt: 'ÂàõÂª∫Êó∂Èó¥',
                        completedAt: 'ÂÆåÊàêÊó∂Èó¥',
                        duration: 'ÊåÅÁª≠Êó∂Èó¥',

                        // ÈÄöÁî®Êìç‰Ωú
                        confirm: 'Á°ÆËÆ§',
                        cancel: 'ÂèñÊ∂à',
                        save: '‰øùÂ≠ò',
                        edit: 'ÁºñËæë',
                        delete: 'Âà†Èô§',
                        close: 'ÂÖ≥Èó≠',
                        back: 'ËøîÂõû',
                        next: '‰∏ã‰∏ÄÊ≠•',
                        previous: '‰∏ä‰∏ÄÊ≠•',
                        finish: 'ÂÆåÊàê',
                        submitting: 'Êèê‰∫§‰∏≠...',


                        // Ê∂àÊÅØÊèêÁ§∫
                        operationSuccess: 'Êìç‰ΩúÊàêÂäü',
                        operationFailed: 'Êìç‰ΩúÂ§±Ë¥•',
                        pleaseWait: 'ËØ∑Á®çÂÄô...',
                        loading: 'Âä†ËΩΩ‰∏≠...',
                        noData: 'ÊöÇÊó†Êï∞ÊçÆ',
                        errorOccurred: 'ÂèëÁîüÈîôËØØ',
                        networkError: 'ÁΩëÁªúÈîôËØØ',
                        serverError: 'ÊúçÂä°Âô®ÈîôËØØ',
                        deleteTaskConfirm: 'Âà†Èô§‰ªªÂä°Ôºü',
                        deleteTaskConfirmMessage: 'Âà†Èô§ÂêéÊó†Ê≥ïÊÅ¢Â§çÔºåÂåÖÊã¨‰ªªÂä°ËÆ∞ÂΩï„ÄÅÁîüÊàêÁöÑÊñá‰ª∂„ÄÅÁõ∏ÂÖ≥Êï∞ÊçÆ„ÄÇÊ≠§Êìç‰Ωú‰∏çÂèØÊí§ÈîÄÔºÅ',
                        confirmDelete: 'Âà†Èô§',
                        deletingTaskAlert: 'Ê≠£Âú®Âà†Èô§‰ªªÂä°...',
                        taskDeletedSuccessAlert: '‰ªªÂä°Âà†Èô§ÊàêÂäü',
                        deleteTaskFailedAlert: 'Âà†Èô§‰ªªÂä°Â§±Ë¥•',
                        getTaskDetailFailedAlert: 'Ëé∑Âèñ‰ªªÂä°ËØ¶ÊÉÖÂ§±Ë¥•',
                        taskNotExistAlert: '‰ªªÂä°‰∏çÂ≠òÂú®',
                        loadTaskFilesFailedAlert: 'Âä†ËΩΩ‰ªªÂä°Êñá‰ª∂Â§±Ë¥•',
                        taskMaterialReuseSuccessAlert: '‰ªªÂä°Á¥†ÊùêÂ§çÁî®ÊàêÂäü',
                        loadTaskDataFailedAlert: 'Âä†ËΩΩ‰ªªÂä°Êï∞ÊçÆÂ§±Ë¥•',
                        fileUnavailableAlert: 'Êñá‰ª∂‰∏çÂèØÁî®',
                        downloadFailedAlert: '‰∏ãËΩΩÂ§±Ë¥•',
                        taskSubmitSuccessAlert: '‰ªªÂä°Êèê‰∫§ÊàêÂäü',
                        taskSubmitFailedAlert: '‰ªªÂä°Êèê‰∫§Â§±Ë¥•',
                        submitTaskFailedAlert: 'Êèê‰∫§‰ªªÂä°Â§±Ë¥•',
                        fileDownloadSuccessAlert: 'Êñá‰ª∂‰∏ãËΩΩÊàêÂäü',
                        getTaskResultFailedAlert: 'Ëé∑ÂèñÁªìÊûúÂ§±Ë¥•',
                        downloadTaskResultFailedAlert: '‰∏ãËΩΩÁªìÊûúÂ§±Ë¥•',
                        viewTaskResultFailedAlert: 'Êü•ÁúãÁªìÊûúÂ§±Ë¥•',
                        cancelTaskConfirm: 'ÂèñÊ∂à‰ªªÂä°Ôºü',
                        cancelTaskConfirmMessage: 'ÂèñÊ∂à‰ªªÂä°Âêé‰ªªÂä°Â∞ÜÂÅúÊ≠¢ÊâßË°åÔºåÂ∑≤ÁîüÊàêÁöÑÈÉ®ÂàÜÁªìÊûúÂèØËÉΩ‰∏¢Â§±ÔºåÂèØ‰ª•Á®çÂêéÈáçÊñ∞ÁîüÊàê„ÄÇ',
                        confirmCancel: 'ÂèñÊ∂à',
                        taskCancelSuccessAlert: '‰ªªÂä°ÂèñÊ∂àÊàêÂäü',
                        cancelTaskFailedAlert: 'ÂèñÊ∂à‰ªªÂä°Â§±Ë¥•',
                        taskRetrySuccessAlert: '‰ªªÂä°ÈáçËØïÊàêÂäü',
                        retryTaskFailedAlert: 'ÈáçËØï‰ªªÂä°Â§±Ë¥•',
                        seconds: 'Áßí',
                        minutes: 'ÂàÜÈíü',
                        hours: 'Â∞èÊó∂',
                        days: 'Â§©',
                        weeks: 'Âë®',
                        months: 'Êúà',
                        years: 'Âπ¥',
                        position: '‰ΩçÁΩÆ',
                        remaining: 'Ââ©‰Ωô',
                        calculating: 'ËÆ°ÁÆó‰∏≠',
                        completed: 'Â∑≤ÂÆåÊàê',
                        unknown: 'Êú™Áü•',
                        queueing: 'ÊéíÈòü‰∏≠',
                        running: 'ËøêË°å‰∏≠',
                        overallProgress: 'ÊÄª‰ΩìËøõÂ∫¶',
                        queueStatus: 'ÊéíÈòüÁä∂ÊÄÅ',
                        templateApplied: 'Â∑≤Â∫îÁî®Ê®°Êùø',
                        promptHistoryApplied: 'Â∑≤Â∫îÁî®ÂéÜÂè≤ÊèêÁ§∫ËØç',
                        promptHistoryCleared: 'ÊèêÁ§∫ËØçÂéÜÂè≤Â∑≤Ê∏ÖÁ©∫',
                        getPromptHistoryFailed: 'Ëé∑ÂèñÊèêÁ§∫ËØçÂéÜÂè≤Â§±Ë¥•',
                        saveTaskHistoryFailed: '‰øùÂ≠ò‰ªªÂä°ÂéÜÂè≤Â§±Ë¥•',
                        parseTaskHistoryFailed: 'Ëß£Êûê‰ªªÂä°ÂéÜÂè≤Â§±Ë¥•',
                        getTaskHistoryFailed: 'Ëé∑Âèñ‰ªªÂä°ÂéÜÂè≤Â§±Ë¥•',
                        getImageHistoryFailed: 'Ëé∑ÂèñÂõæÁâáÂéÜÂè≤Â§±Ë¥•',
                        taskHistorySaved: '‰ªªÂä°ÂéÜÂè≤Â∑≤‰øùÂ≠ò',
                        taskHistoryCleared: '‰ªªÂä°ÂéÜÂè≤Â∑≤Ê∏ÖÁ©∫',
                        clickToDownload: 'ÁÇπÂáª‰∏ãËΩΩ',
                        clickApply: 'ÁÇπÂáªÂ∫îÁî®',


                        // Êó∂Èó¥Áõ∏ÂÖ≥
                        justNow: 'ÂàöÂàö',
                        minutesAgo: 'ÂàÜÈíüÂâç',
                        hoursAgo: 'Â∞èÊó∂Ââç',
                        daysAgo: 'Â§©Ââç',
                        weeksAgo: 'Âë®Ââç',
                        monthsAgo: 'ÊúàÂâç',
                        yearsAgo: 'Âπ¥Ââç',
                        oneMinuteAgo: '‰∏ÄÂàÜÈíüÂâç',
                        oneHourAgo: '‰∏ÄÂ∞èÊó∂Ââç',
                        oneDayAgo: '‰∏ÄÂ§©Ââç',
                        oneWeekAgo: '‰∏ÄÂë®Ââç',
                        oneMonthAgo: '‰∏Ä‰∏™ÊúàÂâç',
                        oneYearAgo: '‰∏ÄÂπ¥Ââç',

                    },
                    en: {
                        // ÈÄöÁî®
                        total: 'Total',
                        tasks: 'tasks',
                        records: 'records',
                        noImageTemplates: 'No image templates',
                        noAudioTemplates: 'No audio templates',
                        noHistoryTasks: 'No history tasks',
                        templateDetail: 'Template detail',
                        templateInfo: 'Template Info',
                        useTemplate: 'Use Template',
                        model: 'Model',
                        type: 'Type',
                        inputMaterials: 'Input Materials',
                        inputImage: 'Input Image',
                        inputAudio: 'Input Audio',

                        // È°µÈù¢Ê†áÈ¢ò
                        pageTitle: 'LightX2V Service',
                        pleaseEnterThePromptForVideoGeneration: 'Please enter the prompt for video generation',
                        describeTheContentStyleSceneOfTheVideo: 'Describe the content, style, and scene of the video...',
                        describeTheDigitalHumanImageBackgroundStyleActionRequirements: 'Describe the digital human image, background style, and action requirements...',
                        describeTheContentActionRequirementsBasedOnTheImage: 'Describe the content and action requirements based on the image...',
                        loginSubtitle: 'A powerful video generation platform',

                        // ÁôªÂΩïÁõ∏ÂÖ≥
                        loginWithGitHub: 'Login with GitHub',
                        loggingIn: 'Logging in...',
                        logout: 'Logout',
                        loggedOut: 'Logged out',
                        loginFailed: 'Login failed',
                        loginError: 'Error occurred during login',
                        authFailed: 'Authentication failed, please login again',
                        loginExpired: 'Login expired, please login again',

                        // ÂäüËÉΩÁâπÊÄß
                        feature1: 'Cinema-grade digital human videos',
                        feature2: '20x faster generation',
                        feature3: 'Ultra-low cost generation',
                        feature4: 'Precise lip-sync alignment',
                        feature5: 'Minute-level video duration',
                        feature6: 'Multi-scenario applications',


                        // ÂØºËà™ÂíåËèúÂçï
                        generateVideo: 'Generate Video',
                        history: 'History',
                        inspiration: 'Inspiration',
                        discoverCreativity: 'Discover creativity, inspire ideas',
                        searchTasks: 'Search history tasks...',
                        searchInspiration: 'Search inspiration...',
                        refresh: 'Refresh task list',
                        noHistoryTasks: 'No history tasks',
                        startToCreateYourFirstAIVideo: 'Start creating your first AI video',
                        switchLanguage: 'Switch Language',
                        selectTaskType: 'Select Task Type',
                        selectTaskTypeFirst: 'Please select task type first',
                        noHistoryRecords: 'No history records',
                        imageHistoryAutoSave: 'Image history will be automatically saved when you start using images',
                        audioHistoryAutoSave: 'Audio history will be automatically saved when you start using audio',
                        clearHistory: 'Clear history',
                        clear: 'Clear',
                        promptHistoryAutoSave: 'Prompt history will be automatically saved when you start creating tasks',
                        promptTip: 'Describe the video content you want in detail',
                        viewFailureReason: 'View Failure Reason',
                        failureReason: 'Failure Reason',
                        noPrompt: 'No Prompt',
                        uploadMaterials: 'Upload Materials',
                        loading: 'Loading',
                        image: 'Image',
                        audioFile: 'Audio File',
                        myProjects: 'My Projects',
                        initializationFailed: 'Initialization Failed, Please Refresh The Page',
                        browserNotSupported: 'Browser Not Supported',
                        videoLoadFailed: 'Video Load Failed',
                        loadingVideo: 'Loading Video',
                        videoGenerating: 'Video Generating',
                        taskProgress: 'Task Progress',
                        subtask: 'Subtask',
                        queuePosition: 'Queue Position',
                        availableWorker: 'Available Worker',
                        videoGeneratingFailed: 'Video Generating Failed',
                        sorryYourVideoGenerationTaskFailed: 'Sorry Your Video Generation Task Failed',
                        thisTaskHasBeenCancelledYouCanRegenerateOrViewTheMaterialsYouUploadedBefore: 'This Task Has Been Cancelled You Can Regenerate Or View The Materials You Uploaded Before',
                        taskCancelled: 'Task Cancelled',
                        regenerateTask: 'Regenerate Task',
                        retryTask: 'Retry Task',
                        downloadTask: 'Download Task',
                        downloadVideo: 'Download Video',
                        deleteTask: 'Delete Task',
                        taskInfo: 'Task Info',
                        taskID: 'Task ID',
                        taskType: 'Task Type',
                        modelName: 'Model Name',
                        createTime: 'Create Time',
                        updateTime: 'Update Time',

                        // ‰ªªÂä°Áä∂ÊÄÅ
                        success: 'Success',
                        failed: 'Failed',
                        running: 'Running',
                        pending: 'Pending',
                        cancelled: 'Cancelled',
                        all: 'All',
                        created: 'Created',
                        status: 'Status',

                        // ‰ªªÂä°Êìç‰Ωú
                        reuseTask: 'Reuse Task',
                        regenerateTask: 'Regenerate Task',
                        retryTask: 'Retry Task',
                        downloadTask: 'Download Task',
                        downloadVideo: 'Download Video',
                        deleteTask: 'Delete Task',
                        cancelTask: 'Cancel Task',
                        download: 'Download',
                        delete: 'Delete',

                        // ‰ªªÂä°ÂàõÂª∫
                        createVideo: 'Create Video',
                        selectTemplate: 'Select Template',
                        uploadImage: 'Upload Image',
                        uploadAudio: 'Upload Audio',
                        enterPrompt: 'Enter Prompt',
                        selectModel: 'Select Model',
                        startGeneration: 'Start Generation',
                        templates: 'Templates',

                        // Ê®°ÂûãÂíå‰ªªÂä°Á±ªÂûã
                        textToVideo: 'Text to Video',
                        imageToVideo: 'Image to Video',
                        speechToVideo: 'Speech to Video',

                        // ÊèêÁ§∫ËØçÁõ∏ÂÖ≥
                        prompt: 'Prompt',
                        negativePrompt: 'Negative Prompt',
                        promptTemplates: 'Prompt Templates',
                        promptHistory: 'Prompt History',

                        // Êñá‰ª∂‰∏ä‰º†
                        uploadImageFile: 'Upload Image File',
                        uploadAudioFile: 'Upload Audio File',
                        dragDropHere: 'Drag and drop files here or click to upload',
                        supportedImageFormats: 'Supported jpg, png, webp image formats (< 10MB)',
                        supportedAudioFormats: 'Supported mp3, m4a, wav audio formats (< 120s)',
                        maxFileSize: 'Max file size',

                        // ‰ªªÂä°ËØ¶ÊÉÖ
                        taskDetails: 'Task Details',
                        taskId: 'Task ID',
                        taskType: 'Task Type',
                        taskStatus: 'Task Status',
                        createdAt: 'Created At',
                        completedAt: 'Completed At',
                        duration: 'Duration',

                        // ÈÄöÁî®Êìç‰Ωú
                        confirm: 'Confirm',
                        cancel: 'Cancel',
                        save: 'Save',
                        edit: 'Edit',
                        delete: 'Delete',
                        close: 'Close',
                        back: 'Back',
                        next: 'Next',
                        previous: 'Previous',
                        finish: 'Finish',
                        submitting: 'Submitting...',

                        // Ê∂àÊÅØÊèêÁ§∫
                        operationSuccess: 'Operation successful',
                        operationFailed: 'Operation failed',
                        pleaseWait: 'Please wait...',
                        loading: 'Loading...',
                        noData: 'No data',
                        errorOccurred: 'Error occurred',
                        networkError: 'Network error',
                        serverError: 'Server error',
                        seconds: 'seconds',
                        deleteTaskConfirm: 'Delete Task?',
                        deleteTaskConfirmMessage: 'This action cannot be undone. It will delete the task record, generated files, and related data.',
                        confirmDelete: 'Delete',
                        deletingTaskAlert: 'Deleting task...',
                        taskDeletedSuccessAlert: 'Task deleted successfully',
                        deleteTaskFailedAlert: 'Delete task failed',
                        getTaskDetailFailedAlert: 'Get task detail failed',
                        taskNotExistAlert: 'Task not exist',
                        loadTaskFilesFailedAlert: 'Load task files failed',
                        taskMaterialReuseSuccessAlert: 'Task material reuse successfully',
                        loadTaskDataFailedAlert: 'Load task data failed',
                        fileUnavailableAlert: 'File unavailable',
                        downloadFailedAlert: 'Download failed',
                        taskSubmitSuccessAlert: 'Task submit successfully',
                        taskSubmitFailedAlert: 'Task submit failed',
                        submitTaskFailedAlert: 'Submit task failed',
                        fileDownloadSuccessAlert: 'File download successfully',
                        getTaskResultFailedAlert: 'Get task result failed',
                        downloadTaskResultFailedAlert: 'Download task result failed',
                        viewTaskResultFailedAlert: 'View task result failed',
                        cancelTaskConfirm: 'Cancel task?',
                        cancelTaskConfirmMessage: 'Cancel task will stop the task execution, and the generated part of the result may be lost, can be regenerated later.',
                        confirmCancel: 'Cancel',
                        taskCancelSuccessAlert: 'Task cancel successfully',
                        cancelTaskFailedAlert: 'Cancel task failed',
                        taskRetrySuccessAlert: 'Task retry successfully',
                        retryTaskFailedAlert: 'Retry task failed',
                        minutes: 'minutes',
                        hours: 'hours',
                        days: 'days',
                        weeks: 'weeks',
                        months: 'months',
                        years: 'years',
                        position: 'position',
                        remaining: 'remaining',
                        calculating: 'calculating',
                        completed: 'completed',
                        unknown: 'unknown',
                        queueing: 'queueing',
                        running: 'running',
                        overallProgress: 'overall progress',
                        queueStatus: 'queue status',
                        seconds: 'seconds',
                        minutes: 'minutes',
                        hours: 'hours',
                        days: 'days',
                        weeks: 'weeks',
                        months: 'months',
                        years: 'years',
                        position: 'position',
                        remaining: 'remaining',
                        calculating: 'calculating',
                        completed: 'completed',
                        unknown: 'unknown',
                        queueing: 'queueing',
                        running: 'running',
                        overallProgress: 'overall progress',
                        queueStatus: 'queue status',
                        templateApplied: 'Template applied',
                        promptHistoryApplied: 'Prompt history applied',
                        promptHistoryCleared: 'Prompt history cleared',
                        getPromptHistoryFailed: 'Get prompt history failed',
                        saveTaskHistoryFailed: 'Save task history failed',
                        parseTaskHistoryFailed: 'Parse task history failed',
                        getTaskHistoryFailed: 'Get task history failed',
                        getImageHistoryFailed: 'Get image history failed',
                        taskHistorySaved: 'Task history saved',
                        taskHistoryCleared: 'Task history cleared',
                        clickToDownload: 'Click to download',
                        clickApply: 'Click to apply',

                        // Êó∂Èó¥Áõ∏ÂÖ≥
                        justNow: 'Just now',
                        minutesAgo: 'minutes ago',
                        hoursAgo: 'hours ago',
                        daysAgo: 'days ago',
                        weeksAgo: 'weeks ago',
                        monthsAgo: 'months ago',
                        yearsAgo: 'years ago',
                        oneMinuteAgo: 'one minute ago',
                        oneHourAgo: 'one hour ago',
                        oneDayAgo: 'one day ago',
                        oneWeekAgo: 'one week ago',
                        oneMonthAgo: 'one month ago',
                        oneYearAgo: 'one year ago',

                    }
                });
                
                // ‰ªªÂä°Áä∂ÊÄÅËΩÆËØ¢Áõ∏ÂÖ≥
                const pollingInterval = ref(null);
                const pollingTasks = ref(new Set()); // Ê≠£Âú®ËΩÆËØ¢ÁöÑ‰ªªÂä°IDÈõÜÂêà
                const confirmDialog = ref({
                    show: false,
                    title: '',
                    message: '',
                    confirmText: 'Á°ÆËÆ§', // ‰ΩøÁî®ÈùôÊÄÅÊñáÊú¨ÔºåÈÅøÂÖçÁøªËØë‰æùËµñ
                    warning: null,
                    confirm: () => { }
                });
                const submitting = ref(false);
                const taskSearchQuery = ref('');
                const sidebarCollapsed = ref(false);
                const showExpandHint = ref(false);
                const showGlow = ref(false);
                const isDefaultStateHidden = ref(false);
                const isCreationAreaExpanded = ref(false);
                const hasUploadedContent = ref(false);
                const isContracting = ref(false);

                // Êñ∞Â¢ûÔºöËßÜÂõæÂàáÊç¢Áõ∏ÂÖ≥Áä∂ÊÄÅ
                const currentView = ref('create'); // 'create'„ÄÅ'projects' Êàñ 'inspiration'
                const showTaskDetailModal = ref(false);
                const modalTask = ref(null);

                // ÁÅµÊÑüÂπøÂú∫Áõ∏ÂÖ≥Êï∞ÊçÆ
                const inspirationSearchQuery = ref('');
                const selectedInspirationCategory = ref('all');
                const inspirationItems = ref([]);

                // ÁÅµÊÑüÂπøÂú∫ÂàÜÈ°µÁõ∏ÂÖ≥ÂèòÈáè
                const inspirationPagination = ref(null);
                const inspirationCurrentPage = ref(1);
                const inspirationPageSize = ref(12);
                const inspirationPageInput = ref(1);
                const inspirationPaginationKey = ref(0);

                // Ê®°ÊùøËØ¶ÊÉÖÂºπÁ™óÁõ∏ÂÖ≥Êï∞ÊçÆ
                const showTemplateDetailModal = ref(false);
                const selectedTemplate = ref(null);

                // ‰ªªÂä°Êñá‰ª∂ÁºìÂ≠òÁ≥ªÁªü
                const taskFileCache = ref(new Map());
                const taskFileCacheLoaded = ref(false);

                // Ê®°ÊùøÊñá‰ª∂ÁºìÂ≠òÁ≥ªÁªü
                const templateFileCache = ref(new Map());
                const templateFileCacheLoaded = ref(false);

                // localStorageÁºìÂ≠òÁõ∏ÂÖ≥Â∏∏Èáè
                const TASK_FILE_CACHE_KEY = 'lightx2v_task_files';
                const TEMPLATE_FILE_CACHE_KEY = 'lightx2v_template_files';
                const TASK_FILE_CACHE_EXPIRY = 24 * 60 * 60 * 1000; // 24Â∞èÊó∂ËøáÊúü
                const MODELS_CACHE_KEY = 'lightx2v_models';
                const MODELS_CACHE_EXPIRY = 60 * 60 * 1000; // 1Â∞èÊó∂ËøáÊúü
                const TEMPLATES_CACHE_KEY = 'lightx2v_templates';
                const TEMPLATES_CACHE_EXPIRY = 24 * 60 * 60 * 1000; // 24Â∞èÊó∂ËøáÊúü
                const TASKS_CACHE_KEY = 'lightx2v_tasks';
                const TASKS_CACHE_EXPIRY = 5 * 60 * 1000; // 5ÂàÜÈíüËøáÊúü

                const imageTemplates = ref([]);
                const audioTemplates = ref([]);
                const showImageTemplates = ref(false);
                const showAudioTemplates = ref(false);
                const mediaModalTab = ref('history');

                // TemplateÂàÜÈ°µÁõ∏ÂÖ≥ÂèòÈáè
                const templatePagination = ref(null);
                const templateCurrentPage = ref(1);
                const templatePageSize = ref(12); // ÂõæÁâáÊ®°ÊùøÊØèÈ°µ12‰∏™ÔºåÈü≥È¢ëÊ®°ÊùøÊØèÈ°µ10‰∏™
                const templatePageInput = ref(1);
                const templatePaginationKey = ref(0);
                const imageHistory = ref([]);
                const audioHistory = ref([]);
                
                // Ê®°ÊùøÊñá‰ª∂ÁºìÂ≠òÔºåÈÅøÂÖçÈáçÂ§ç‰∏ãËΩΩ
                const currentUser = ref({});
                const models = ref([]);
                const tasks = ref([]);
                const isLoggedIn = ref(null); // nullË°®Á§∫Êú™ÂàùÂßãÂåñÔºåfalseË°®Á§∫Êú™ÁôªÂΩïÔºåtrueË°®Á§∫Â∑≤ÁôªÂΩï

                const selectedTaskId = ref(null);
                const selectedTask = ref(null);
                const selectedTaskFiles = ref({ inputs: {}, outputs: {} }); // Â≠òÂÇ®‰ªªÂä°ÁöÑËæìÂÖ•ËæìÂá∫Êñá‰ª∂
                const loadingTaskFiles = ref(false); // Âä†ËΩΩ‰ªªÂä°Êñá‰ª∂ÁöÑÁä∂ÊÄÅ
                const statusFilter = ref('ALL');
                const pagination = ref(null);
                const currentTaskPage = ref(1);
                const taskPageSize = ref(12);
                const taskPageInput = ref(1);
                const paginationKey = ref(0); // Áî®‰∫éÂº∫Âà∂Âà∑Êñ∞ÂàÜÈ°µÁªÑ‰ª∂
                const taskMenuVisible = ref({}); // ÁÆ°ÁêÜÊØè‰∏™‰ªªÂä°ÁöÑËèúÂçïÊòæÁ§∫Áä∂ÊÄÅ
                const nameMap = computed(() => ({
                    't2v': t('textToVideo'),
                    'i2v': t('imageToVideo'),
                    's2v': t('speechToVideo')
                }));

                // ‰ªªÂä°Á±ªÂûãÊèêÁ§∫‰ø°ÊÅØ
                const taskHints = computed(() => ({
                    't2v': [
                        'ËæìÂÖ•ÊñáÂ≠óÊèèËø∞ÔºåAIÂ∞Ü‰∏∫ÊÇ®ÁîüÊàêÁ≤æÂΩ©ÁöÑËßÜÈ¢ëÂÜÖÂÆπ',
                        'ÊîØÊåÅÂ§öÁßçÈ£éÊ†ºÔºöÂÜôÂÆû„ÄÅÂä®Áîª„ÄÅËâ∫ÊúØÁ≠â',
                        'ÂèØ‰ª•ÊèèËø∞Âú∫ÊôØ„ÄÅÂä®‰Ωú„ÄÅÊÉÖÊÑüÁ≠âÁªÜËäÇ',
                        'ËÆ©ÊÇ®ÁöÑÂàõÊÑèÈÄöËøáÊñáÂ≠óÂèòÊàêÁîüÂä®ÁöÑËßÜÈ¢ë'
                    ],
                    'i2v': [
                        '‰∏ä‰º†‰∏ÄÂº†ÂõæÁâáÔºåAIÂ∞Ü‰∏∫ÊÇ®ÁîüÊàêÂä®ÊÄÅËßÜÈ¢ë',
                        'ÊîØÊåÅÂ§öÁßçÂõæÁâáÊ†ºÂºèÔºöJPG„ÄÅPNG„ÄÅWebPÁ≠â',
                        'ÂèØ‰ª•ÁîüÊàêÂêÑÁßçÈ£éÊ†ºÁöÑÂä®ÊÄÅÊïàÊûú',
                        'ËÆ©ÈùôÊÄÅÂõæÁâáÂä®Ëµ∑Êù•ÔºåÂàõÈÄ†Êó†ÈôêÂèØËÉΩ'
                    ],
                    's2v': [
                        '‰∏ä‰º†‰∏ÄÂº†ËßíËâ≤ÂõæÁâá+‰∏ÄÊÆµÈü≥È¢ë',
                        'AIÂ∞ÜËÆ©ËßíËâ≤Ê†πÊçÆÈü≥È¢ëÂÜÖÂÆπËØ¥ËØùÂíåÂä®‰Ωú',
                        'ËÆ©ÊÇ®ÁöÑËßíËâ≤Ê†©Ê†©Â¶ÇÁîüÂú∞Âä®Ëµ∑Êù•',
                        'Êù•ÂàõÈÄ†Â±û‰∫éÊÇ®ÁöÑ‰∏ìÂ±ûÊï∞Â≠ó‰∫∫Âêß'
                    ]
                }));

                // ÂΩìÂâç‰ªªÂä°Á±ªÂûãÁöÑÊèêÁ§∫‰ø°ÊÅØ
                const currentTaskHints = computed(() => {
                    return taskHints.value[selectedTaskId.value] || taskHints.value['s2v'];
                });

                // ÊªöÂä®ÊèêÁ§∫Áõ∏ÂÖ≥
                const currentHintIndex = ref(0);
                const hintInterval = ref(null);

                // ÂºÄÂßãÊªöÂä®ÊèêÁ§∫
                const startHintRotation = () => {
                    if (hintInterval.value) {
                        clearInterval(hintInterval.value);
                    }
                    hintInterval.value = setInterval(() => {
                        currentHintIndex.value = (currentHintIndex.value + 1) % currentTaskHints.value.length;
                    }, 3000); // ÊØè3ÁßíÂàáÊç¢‰∏ÄÊ¨°
                };

                // ÂÅúÊ≠¢ÊªöÂä®ÊèêÁ§∫
                const stopHintRotation = () => {
                    if (hintInterval.value) {
                        clearInterval(hintInterval.value);
                        hintInterval.value = null;
                    }
                };

                // ‰∏∫‰∏â‰∏™‰ªªÂä°Á±ªÂûãÂàÜÂà´ÂàõÂª∫Áã¨Á´ãÁöÑË°®Âçï
                const t2vForm = ref({
                    task: 't2v',
                    model_cls: '',
                    stage: 'single_stage',
                    prompt: '',
                    seed: 42
                });

                const i2vForm = ref({
                    task: 'i2v',
                    model_cls: '',
                    stage: 'multi_stage',
                    imageFile: null,
                    prompt: '',
                    seed: 42
                });

                const s2vForm = ref({
                    task: 's2v',
                    model_cls: '',
                    stage: 'single_stage',
                    imageFile: null,
                    audioFile: null,
                    prompt: '',
                    seed: 42
                });

                // Ê†πÊçÆÂΩìÂâçÈÄâÊã©ÁöÑ‰ªªÂä°Á±ªÂûãËé∑ÂèñÂØπÂ∫îÁöÑË°®Âçï
                const getCurrentForm = () => {
                    switch (selectedTaskId.value) {
                        case 't2v':
                            return t2vForm.value;
                        case 'i2v':
                            return i2vForm.value;
                        case 's2v':
                            return s2vForm.value;
                        default:
                            return t2vForm.value;
                    }
                };

                // ÊéßÂà∂ÈªòËÆ§Áä∂ÊÄÅÊòæÁ§∫/ÈöêËóèÁöÑÊñπÊ≥ï
                const hideDefaultState = () => {
                    isDefaultStateHidden.value = true;
                };

                const showDefaultState = () => {
                    isDefaultStateHidden.value = false;
                };

                // ÊéßÂà∂Âàõ‰ΩúÂå∫ÂüüÂ±ïÂºÄ/Êî∂Áº©ÁöÑÊñπÊ≥ï
                const expandCreationArea = () => {
                    isCreationAreaExpanded.value = true;
                    // Ê∑ªÂä†showÁ±ªÊù•Ëß¶ÂèëÂä®Áîª
                    setTimeout(() => {
                        const creationArea = document.querySelector('.creation-area');
                        if (creationArea) {
                            creationArea.classList.add('show');
                        }
                    }, 10);
                };

                const contractCreationArea = () => {
                    isContracting.value = true;
                    const creationArea = document.querySelector('.creation-area');
                    if (creationArea) {
                        // Ê∑ªÂä†hideÁ±ªÊù•Ëß¶ÂèëÊî∂Ëµ∑Âä®Áîª
                        creationArea.classList.add('hide');
                        creationArea.classList.remove('show');
                    }
                    // Á≠âÂæÖÂä®ÁîªÂÆåÊàêÂêéÊõ¥Êñ∞Áä∂ÊÄÅ
                    setTimeout(() => {
                        isCreationAreaExpanded.value = false;
                        isContracting.value = false;
                        if (creationArea) {
                            creationArea.classList.remove('hide');
                        }
                    }, 400);
                };


                // ‰∏∫ÊØè‰∏™‰ªªÂä°Á±ªÂûãÂàõÂª∫Áã¨Á´ãÁöÑÈ¢ÑËßàÂèòÈáè
                const i2vImagePreview = ref(null);
                const s2vImagePreview = ref(null);
                const s2vAudioPreview = ref(null);

                // ÁõëÂê¨‰∏ä‰º†ÂÜÖÂÆπÂèòÂåñ
                const updateUploadedContentStatus = () => {
                    hasUploadedContent.value = !!(getCurrentImagePreview() || getCurrentAudioPreview() || getCurrentForm().prompt?.trim());
                };

                // ÁõëÂê¨Ë°®ÂçïÂèòÂåñ
                watch([i2vImagePreview, s2vImagePreview, s2vAudioPreview, () => getCurrentForm().prompt], () => {
                    updateUploadedContentStatus();
                }, { deep: true });

                // ÁõëÂê¨‰ªªÂä°Á±ªÂûãÂèòÂåñÔºåÈáçÁΩÆÊèêÁ§∫ÊªöÂä®
                watch(selectedTaskId, () => {
                    currentHintIndex.value = 0;
                    stopHintRotation();
                    startHintRotation();
                });

                // Ê†πÊçÆÂΩìÂâç‰ªªÂä°Á±ªÂûãËé∑ÂèñÂØπÂ∫îÁöÑÈ¢ÑËßàÂèòÈáè
                const getCurrentImagePreview = () => {
                    switch (selectedTaskId.value) {
                        case 't2v':
                            return null;
                        case 'i2v':
                            return i2vImagePreview.value;
                        case 's2v':
                            return s2vImagePreview.value;
                        default:
                            return null;
                    }
                };

                const getCurrentAudioPreview = () => {
                    switch (selectedTaskId.value) {
                        case 't2v':
                            return null
                        case 'i2v':
                            return null
                        case 's2v':
                            return s2vAudioPreview.value;
                        default:
                            return null;
                    }
                };

                const setCurrentImagePreview = (value) => {
                    switch (selectedTaskId.value) {
                        case 't2v':
                            break;
                        case 'i2v':
                            i2vImagePreview.value = value;
                            break;
                        case 's2v':
                            s2vImagePreview.value = value;
                            break;
                    }
                };

                const setCurrentAudioPreview = (value) => {
                    switch (selectedTaskId.value) {
                        case 't2v':
                            break;
                        case 'i2v':
                            break;
                        case 's2v':
                            s2vAudioPreview.value = value;
                            break;
                    }
                };

                // ÊèêÁ§∫ËØçÊ®°ÊùøÁõ∏ÂÖ≥
                const showTemplates = ref(false);
                const showHistory = ref(false);
                const showPromptModal = ref(false);
                const promptModalTab = ref('templates');

                // ËÆ°ÁÆóÂ±ûÊÄß
                const availableTaskTypes = computed(() => {
                    const types = [...new Set(models.value.map(m => m.task))];
                    // ÈáçÊñ∞ÊéíÂ∫èÔºåÁ°Æ‰øùÊï∞Â≠ó‰∫∫Âú®ÊúÄÂ∑¶Ëæπ
                    const orderedTypes = [];

                    // Ê£ÄÊü•ÊòØÂê¶Êúâs2vÊ®°ÂûãÔºåÂ¶ÇÊûúÊúâÂàôÊ∑ªÂä†s2vÁ±ªÂûã
                    const hasS2vModels = models.value.some(m =>
                        m.task === 's2v'
                    );

                    // ‰ºòÂÖàÊ∑ªÂä†Êï∞Â≠ó‰∫∫ÔºàÂ¶ÇÊûúÂ≠òÂú®Áõ∏ÂÖ≥Ê®°ÂûãÔºâ
                    if (hasS2vModels) {
                        orderedTypes.push('s2v');
                    }

                    // ÁÑ∂ÂêéÊ∑ªÂä†ÂÖ∂‰ªñÁ±ªÂûã
                    types.forEach(type => {
                        if (type !== 's2v') {
                            orderedTypes.push(type);
                        }
                    });

                    return orderedTypes;
                });

                const availableModelClasses = computed(() => {
                    if (!selectedTaskId.value) return [];

                    // ÂÖ∂‰ªñ‰ªªÂä°Á±ªÂûãÊ≠£Â∏∏Â§ÑÁêÜ
                    return [...new Set(models.value
                        .filter(m => m.task === selectedTaskId.value)
                        .map(m => m.model_cls))];
                });

                const filteredTasks = computed(() => {
                    let filtered = tasks.value;

                    // Áä∂ÊÄÅËøáÊª§
                    if (statusFilter.value !== 'ALL') {
                        filtered = filtered.filter(task => task.status === statusFilter.value);
                    }

                    // ÊêúÁ¥¢ËøáÊª§
                    if (taskSearchQuery.value) {
                        filtered = filtered.filter(task =>
                        task.params.prompt?.toLowerCase().includes(taskSearchQuery.value.toLowerCase()) ||
                        task.task_id.toLowerCase().includes(taskSearchQuery.value.toLowerCase()) ||
                            nameMap.value[task.task_type].toLowerCase().includes(taskSearchQuery.value.toLowerCase())
                    );
                    }

                    // ÊåâÊó∂Èó¥ÊéíÂ∫èÔºåÊúÄÊñ∞ÁöÑ‰ªªÂä°Âú®ÂâçÈù¢
                    filtered = filtered.sort((a, b) => {
                        const timeA = parseInt(a.create_t) || 0;
                        const timeB = parseInt(b.create_t) || 0;
                        return timeB - timeA; // ÈôçÂ∫èÊéíÂàóÔºåÊúÄÊñ∞ÁöÑÂú®Ââç
                    });

                    return filtered;
                });

                // ÁõëÂê¨Áä∂ÊÄÅÁ≠õÈÄâÂèòÂåñÔºåÈáçÁΩÆÂàÜÈ°µÂà∞Á¨¨‰∏ÄÈ°µ
                watch(statusFilter, (newStatus, oldStatus) => {
                    if (newStatus !== oldStatus) {
                        currentTaskPage.value = 1;
                        taskPageInput.value = 1;
                        refreshTasks(true); // Âº∫Âà∂Âà∑Êñ∞
                    }
                });

                // ÁõëÂê¨ÊêúÁ¥¢Êü•ËØ¢ÂèòÂåñÔºåÈáçÁΩÆÂàÜÈ°µÂà∞Á¨¨‰∏ÄÈ°µ
                watch(taskSearchQuery, (newQuery, oldQuery) => {
                    if (newQuery !== oldQuery) {
                        currentTaskPage.value = 1;
                        taskPageInput.value = 1;
                        refreshTasks(true); // Âº∫Âà∂Âà∑Êñ∞
                    }
                });

                // ÂàÜÈ°µ‰ø°ÊÅØËÆ°ÁÆóÂ±ûÊÄßÔºåÁ°Æ‰øùÂìçÂ∫îÂºèÊõ¥Êñ∞
                const paginationInfo = computed(() => {
                    if (!pagination.value) return null;
                    
                    return {
                        total: pagination.value.total || 0,
                        total_pages: pagination.value.total_pages || 0,
                        current_page: pagination.value.current_page || currentTaskPage.value,
                        page_size: pagination.value.page_size || taskPageSize.value
                    };
                });

                // TemplateÂàÜÈ°µ‰ø°ÊÅØËÆ°ÁÆóÂ±ûÊÄß
                const templatePaginationInfo = computed(() => {
                    if (!templatePagination.value) return null;

                    return {
                        total: templatePagination.value.total || 0,
                        total_pages: templatePagination.value.total_pages || 0,
                        current_page: templatePagination.value.current_page || templateCurrentPage.value,
                        page_size: templatePagination.value.page_size || templatePageSize.value
                    };
                });

                // ÁÅµÊÑüÂπøÂú∫ÂàÜÈ°µ‰ø°ÊÅØËÆ°ÁÆóÂ±ûÊÄß
                const inspirationPaginationInfo = computed(() => {
                    if (!inspirationPagination.value) return null;

                    return {
                        total: inspirationPagination.value.total || 0,
                        total_pages: inspirationPagination.value.total_pages || 0,
                        current_page: inspirationPagination.value.current_page || inspirationCurrentPage.value,
                        page_size: inspirationPagination.value.page_size || inspirationPageSize.value
                    };
                });

                // Âä®ÊÄÅÁîüÊàêÁÅµÊÑüÂπøÂú∫Á±ªÂà´
                const dynamicInspirationCategories = computed(() => {
                    const categories = [{ id: 'all', name: 'ÂÖ®ÈÉ®' }];

                    // ‰ªéÊâÄÊúâÁÅµÊÑüÈ°πÁõÆ‰∏≠ÊèêÂèñÂîØ‰∏ÄÁöÑcategory
                    const uniqueCategories = new Set();
                    inspirationItems.value.forEach(item => {
                        if (item.tags && item.tags.length > 0) {
                            uniqueCategories.add(item.tags[0]);
                        }
                    });

                    // Â∞ÜÂîØ‰∏ÄÁöÑcategoryËΩ¨Êç¢‰∏∫Á±ªÂà´ÂØπË±°
                    Array.from(uniqueCategories).sort().forEach(category => {
                        categories.push({
                            id: category,
                            name: category
                        });
                    });
                    console.log(categories)
                    return categories;
                });

                // ‰ªªÂä°ÂõæÁâáURLÁºìÂ≠ò
                const taskImageUrlCache = ref(new Map());

                // ‰ªªÂä°ËßÜÈ¢ëURLÁºìÂ≠ò
                const taskVideoUrlCache = ref(new Map());

                // ÈÄöÁî®URLÁºìÂ≠ò
                const urlCache = ref(new Map());

                // Ëé∑Âèñ‰ªªÂä°ÂõæÁâáURLÔºàÂ∏¶ÁºìÂ≠òÔºâ
                const getTaskImageUrl = (task) => {
                    if (!task || !task.inputs) return null;

                    const cacheKey = task.task_id;
                    if (taskImageUrlCache.value.has(cacheKey)) {
                        return taskImageUrlCache.value.get(cacheKey);
                    }

                    const imageInputs = Object.keys(task.inputs).filter(key =>
                        key.includes('image') ||
                        task.inputs[key].toString().toLowerCase().match(/\.(jpg|jpeg|png|gif|bmp|webp)$/)
                    );

                    if (imageInputs.length > 0) {
                        const firstImageKey = imageInputs[0];
                        // ‰ºòÂÖà‰ªéÁºìÂ≠òËé∑Âèñ
                        const cachedUrl = getTaskFileUrlSync(task.task_id, firstImageKey);
                        if (cachedUrl) {
                            taskImageUrlCache.value.set(cacheKey, cachedUrl);
                            return cachedUrl;
                        }
                        // ÁºìÂ≠òÊ≤°ÊúâÂàôÁîüÊàêURL
                        const token = localStorage.getItem('accessToken');
                        const url = token
                            ? `./api/v1/task/input?task_id=${task.task_id}&name=${firstImageKey}&token=${encodeURIComponent(token)}`
                            : `./api/v1/task/input?task_id=${task.task_id}&name=${firstImageKey}`;

                        taskImageUrlCache.value.set(cacheKey, url);
                        return url;
                    }

                    return null;
                };

                // Ëé∑Âèñ‰ªªÂä°ËßÜÈ¢ëURLÔºàÂ∏¶ÁºìÂ≠òÔºåÂêåÊ≠•ÁâàÊú¨Ôºâ
                const getTaskVideoUrl = (taskId, key) => {
                    const cacheKey = `${taskId}_${key}`;
                    if (taskVideoUrlCache.value.has(cacheKey)) {
                        return taskVideoUrlCache.value.get(cacheKey);
                    }

                    // ‰ºòÂÖà‰ªéÁºìÂ≠òËé∑Âèñ
                    const cachedUrl = getTaskFileUrlSync(taskId, key);
                        if (cachedUrl) {
                            taskVideoUrlCache.value.set(cacheKey, cachedUrl);
                            return cachedUrl;
                        }

                        // ÁºìÂ≠òÊ≤°ÊúâÂàôÁîüÊàêURL
                        const token = localStorage.getItem('accessToken');
                        const url = token
                            ? `./api/v1/task/result?task_id=${taskId}&name=${key}&token=${encodeURIComponent(token)}`
                            : `./api/v1/task/result?task_id=${taskId}&name=${key}`;

                        // ÁºìÂ≠òAPI URL
                        setTaskFileToCache(taskId, key, {
                            url: url,
                            timestamp: Date.now()
                        });

                        taskVideoUrlCache.value.set(cacheKey, url);
                        return url;
                    };

                // ÈÄöÁî®URLÁºìÂ≠òÂáΩÊï∞
                const getCachedUrl = (key, urlGenerator) => {
                    if (urlCache.value.has(key)) {
                        return urlCache.value.get(key);
                    }

                    const url = urlGenerator();
                    urlCache.value.set(key, url);
                    return url;
                };

                // Ëé∑ÂèñÂéÜÂè≤ÂõæÁâáURLÔºàÂ∏¶ÁºìÂ≠òÔºâ
                const getHistoryImageUrl = (history) => {
                    if (!history || !history.thumbnail) return '';
                    return getCachedUrl(`history_image_${history.filename}`, () => history.thumbnail);
                };

                // Ëé∑ÂèñÁî®Êà∑Â§¥ÂÉèURLÔºàÂ∏¶ÁºìÂ≠òÔºâ
                const getUserAvatarUrl = (user) => {
                    if (!user || !user.avatar) return '';
                    return getCachedUrl(`user_avatar_${user.username}`, () => user.avatar);
                };

                // Ëé∑ÂèñÂΩìÂâçÂõæÁâáÈ¢ÑËßàURLÔºàÂ∏¶ÁºìÂ≠òÔºâ
                const getCurrentImagePreviewUrl = () => {
                    const preview = getCurrentImagePreview();
                    if (!preview) return '';
                    return getCachedUrl(`current_image_preview`, () => preview);
                };

                // Ëé∑ÂèñÂΩìÂâçÈü≥È¢ëÈ¢ÑËßàURLÔºàÂ∏¶ÁºìÂ≠òÔºâ
                const getCurrentAudioPreviewUrl = () => {
                    const preview = getCurrentAudioPreview();
                    if (!preview) return '';
                    return getCachedUrl(`current_audio_preview`, () => preview);
                };

                // ÊñπÊ≥ï
                const showAlert = (message, type = 'info') => {
                    alert.value = { show: true, message, type };
                    setTimeout(() => {
                        alert.value.show = false;
                    }, 5000);
                };

                // ÊòæÁ§∫Á°ÆËÆ§ÂØπËØùÊ°Ü
                const showConfirmDialog = (options) => {
                    return new Promise((resolve) => {
                        confirmDialog.value = {
                            show: true,
                            title: options.title || 'Á°ÆËÆ§Êìç‰Ωú',
                            message: options.message || 'Á°ÆÂÆöË¶ÅÊâßË°åÊ≠§Êìç‰ΩúÂêóÔºü',
                            confirmText: options.confirmText || 'Á°ÆËÆ§',
                            warning: options.warning || null,
                            confirm: () => {
                                confirmDialog.value.show = false;
                                resolve(true);
                            },
                            cancel: () => {
                                confirmDialog.value.show = false;
                                resolve(false);
                            }
                        };
                    });
                };

                const setLoading = (value) => {
                    loading.value = value;
                };

                const apiCall = async (endpoint, options = {}) => {
                    const url = `${endpoint}`;
                    const headers = {
                        'Content-Type': 'application/json',
                        ...options.headers
                    };

                    if (localStorage.getItem('accessToken')) {
                        headers['Authorization'] = `Bearer ${localStorage.getItem('accessToken')}`;
                    }

                    const response = await fetch(url, {
                        ...options,
                        headers
                    });

                    if (response.status === 401) {
                        logout();
                        throw new Error('ËÆ§ËØÅÂ§±Ë¥•ÔºåËØ∑ÈáçÊñ∞ÁôªÂΩï');
                    }
                    if (response.status === 400) {
                        const error = await response.json();
                        showAlert(error.message, 'danger');
                        throw new Error(error.message);
                    }

                    // Ê∑ªÂä†50msÂª∂ËøüÔºåÈò≤Ê≠¢Ëß¶ÂèëÊúçÂä°Á´ØÈ¢ëÁéáÈôêÂà∂
                    await new Promise(resolve => setTimeout(resolve, 50));

                    return response;
                };

                const loginWithGitHub = async () => {
                    try {
                        console.log('starting login')
                        loginLoading.value = true;
                        const response = await fetch('./auth/login/github');
                        const data = await response.json();
                        window.location.href = data.auth_url;
                    } catch (error) {
                        showAlert('Ëé∑ÂèñGitHubËÆ§ËØÅURLÂ§±Ë¥•', 'danger');
                    }
                };

                const handleGitHubCallback = async (code) => {
                    try {
                        const response = await fetch(`./auth/callback/github?code=${code}`);
                        if (response.ok) {
                            const data = await response.json();
                            console.log(data);
                            localStorage.setItem('accessToken', data.access_token);
                            localStorage.setItem('currentUser', JSON.stringify(data.user_info));
                            currentUser.value = data.user_info;
                            isLoggedIn.value = true;
                            
                            // ÁôªÂΩïÊàêÂäüÂêéÂàùÂßãÂåñÊï∞ÊçÆ
                            await init();
                            
                            // Ê∏ÖÈô§URL‰∏≠ÁöÑcodeÂèÇÊï∞
                            window.history.replaceState({}, document.title, window.location.pathname);
                        } else {
                            const error = await response.json();
                            showAlert(`ÁôªÂΩïÂ§±Ë¥•: ${error.detail}`, 'danger');
                        }
                    } catch (error) {
                        showAlert('ÁôªÂΩïËøáÁ®ã‰∏≠ÂèëÁîüÈîôËØØ', 'danger');
                        console.error(error);
                    }
                };



                const logout = () => {
                    localStorage.removeItem('accessToken');
                    localStorage.removeItem('currentUser');
                    clearAllCache();

                    currentUser.value = {};
                    isLoggedIn.value = false;
                    models.value = [];
                    tasks.value = [];
                    showAlert('Â∑≤ÈÄÄÂá∫ÁôªÂΩï', 'info');
                };

                const loadModels = async (forceRefresh = false) => {
                    try {
                        // Â¶ÇÊûú‰∏çÊòØÂº∫Âà∂Êõ¥Êñ∞ÔºåÂÖàÂ∞ùËØï‰ªéÁºìÂ≠òÂä†ËΩΩ
                        if (!forceRefresh) {
                            const cachedModels = loadFromCache(MODELS_CACHE_KEY, MODELS_CACHE_EXPIRY);
                            if (cachedModels) {
                                console.log('ÊàêÂäü‰ªéÁºìÂ≠òÂä†ËΩΩÊ®°ÂûãÂàóË°®');
                                models.value = cachedModels;
                                return;
                                }
                        }

                        console.log('ÂºÄÂßãÂä†ËΩΩÊ®°ÂûãÂàóË°®...');
                        const response = await apiRequest('./api/v1/model/list');
                        if (response && response.ok) {
                            const data = await response.json();
                            console.log('Ê®°ÂûãÂàóË°®Êï∞ÊçÆ:', data);
                            const modelsData = data.models || [];
                            models.value = modelsData;
                            
                            // ‰øùÂ≠òÂà∞ÁºìÂ≠ò
                            saveToCache(MODELS_CACHE_KEY, modelsData);
                            console.log('Ê®°ÂûãÂàóË°®Â∑≤ÁºìÂ≠ò');
                        } else if (response) {
                            console.error('Ê®°ÂûãÂàóË°®APIÂìçÂ∫îÂ§±Ë¥•:', response);
                            showAlert('Âä†ËΩΩÊ®°ÂûãÂàóË°®Â§±Ë¥•', 'danger');
                        }
                        // Â¶ÇÊûúresponse‰∏∫nullÔºåËØ¥ÊòéÊòØËÆ§ËØÅÈîôËØØÔºåapiRequestÂ∑≤ÁªèÂ§ÑÁêÜ‰∫Ü
                    } catch (error) {
                        console.error('Âä†ËΩΩÊ®°ÂûãÂ§±Ë¥•:', error);
                        showAlert(`Âä†ËΩΩÊ®°ÂûãÂ§±Ë¥•: ${error.message}`, 'danger');
                    }
                };

                // Âä†ËΩΩÊ®°ÊùøÊñá‰ª∂
                const loadImageAudioTemplates = async (forceRefresh = false) => {
                    try {
                        // Â¶ÇÊûú‰∏çÊòØÂº∫Âà∂Âà∑Êñ∞ÔºåÂÖàÂ∞ùËØï‰ªéÁºìÂ≠òÂä†ËΩΩ
                        const cacheKey = `${TEMPLATES_CACHE_KEY}_IMAGE_AUDIO_${templateCurrentPage.value}_${templatePageSize.value}`;
                        if (!forceRefresh) {
                        // ÊûÑÂª∫ÁºìÂ≠òÈîÆÔºåÂåÖÂê´ÂàÜÈ°µÂíåËøáÊª§Êù°‰ª∂
                        const cachedTemplates = loadFromCache(cacheKey, TEMPLATES_CACHE_EXPIRY);
                            if (cachedTemplates && cachedTemplates.templates) {
                            console.log('ÊàêÂäü‰ªéÁºìÂ≠òÂä†ËΩΩÊ®°ÊùøÂàóË°®');
                                imageTemplates.value = cachedTemplates.templates.images || [];
                                audioTemplates.value = cachedTemplates.templates.audios || [];
                                templatePagination.value = cachedTemplates.pagination || null;
                            return;
                            }
                        }

                        console.log('ÂºÄÂßãÂä†ËΩΩÂõæÁâáÈü≥‰πêÁ¥†ÊùêÂ∫ì...');
                        const response = await apiCall(`./api/v1/template/list?page=${templateCurrentPage.value}&page_size=${templatePageSize.value}`);
                        if (response.ok) {
                            const data = await response.json();
                            console.log('ÂõæÁâáÈü≥‰πêÁ¥†ÊùêÂ∫ìÊï∞ÊçÆ:', data);
                            const templatesData = {
                                images: data.templates.images || [],
                                audios: data.templates.audios || []
                            };
                            
                            imageTemplates.value = templatesData.images;
                            audioTemplates.value = templatesData.audios;
                            templatePagination.value = data.pagination || null;
                            
                            // ‰øùÂ≠òÂà∞ÁºìÂ≠ò
                            saveToCache(cacheKey, {
                                templates: templatesData,
                                pagination: templatePagination.value
                            });
                            console.log('ÂõæÁâáÈü≥‰πêÁ¥†ÊùêÂ∫ìÂ∑≤ÁºìÂ≠ò:', templatesData);
                            
                        } else {
                            console.warn('Âä†ËΩΩÁ¥†ÊùêÂ∫ìÂ§±Ë¥•');
                        }
                    } catch (error) {
                        console.warn('Âä†ËΩΩÁ¥†ÊùêÂ∫ìÂ§±Ë¥•:', error);
                    }
                };

                // Ëé∑ÂèñÁ¥†ÊùêÊñá‰ª∂ÁöÑÈÄöÁî®ÂáΩÊï∞ÔºàÂ∏¶ÁºìÂ≠òÔºâ
                const getTemplateFile = async (template) => {
                    const cacheKey = template.url;
                    
                    // ÂÖàÊ£ÄÊü•ÂÜÖÂ≠òÁºìÂ≠ò
                    if (templateFileCache.value.has(cacheKey)) {
                        console.log('‰ªéÂÜÖÂ≠òÁºìÂ≠òËé∑ÂèñÁ¥†ÊùêÊñá‰ª∂:', template.filename);
                        return templateFileCache.value.get(cacheKey);
                    }
                    
                    // Â¶ÇÊûúÁºìÂ≠ò‰∏≠Ê≤°ÊúâÔºåÂàô‰∏ãËΩΩÂπ∂ÁºìÂ≠ò
                    console.log('‰∏ãËΩΩÁ¥†ÊùêÊñá‰ª∂:', template.filename);
                    const response = await fetch(template.url, {
                        cache: 'force-cache' // Âº∫Âà∂‰ΩøÁî®ÊµèËßàÂô®ÁºìÂ≠ò
                    });
                    
                    if (response.ok) {
                        const blob = await response.blob();
                        const file = new File([blob], template.filename, { type: blob.type });
                        
                        // ÁºìÂ≠òÊñá‰ª∂ÂØπË±°
                        templateFileCache.value.set(cacheKey, file);
                        return file;
                    } else {
                        throw new Error('‰∏ãËΩΩÁ¥†ÊùêÊñá‰ª∂Â§±Ë¥•');
                    }
                };

                // ÈÄâÊã©ÂõæÁâáÁ¥†Êùê
                const selectImageTemplate = async (template) => {
                    try {
                        const file = await getTemplateFile(template);

                        if (selectedTaskId.value === 'i2v') {
                            i2vForm.value.imageFile = file;
                        } else if (selectedTaskId.value === 's2v') {
                            s2vForm.value.imageFile = file;
                        }

                        // ÂàõÂª∫È¢ÑËßà
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            setCurrentImagePreview(e.target.result);
                        };
                        reader.readAsDataURL(file);

                        showImageTemplates.value = false;
                        showAlert('ÂõæÁâáÁ¥†ÊùêÂ∑≤ÈÄâÊã©', 'success');
                    } catch (error) {
                        showAlert(`Âä†ËΩΩÂõæÁâáÁ¥†ÊùêÂ§±Ë¥•: ${error.message}`, 'danger');
                    }
                };

                // ÈÄâÊã©Èü≥È¢ëÁ¥†Êùê
                const selectAudioTemplate = async (template) => {
                    try {
                        const file = await getTemplateFile(template);

                        s2vForm.value.audioFile = file;

                        // ÂàõÂª∫È¢ÑËßà
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            setCurrentAudioPreview(e.target.result);
                        };
                        reader.readAsDataURL(file);

                        showAudioTemplates.value = false;
                        showAlert('Èü≥È¢ëÁ¥†ÊùêÂ∑≤ÈÄâÊã©', 'success');
                    } catch (error) {
                        showAlert(`Âä†ËΩΩÈü≥È¢ëÁ¥†ÊùêÂ§±Ë¥•: ${error.message}`, 'danger');
                    }
                };

                // È¢ÑËßàÈü≥È¢ëÁ¥†Êùê
                const previewAudioTemplate = (template) => {
                    const audio = new Audio(template.url);
                    audio.play().catch(error => {
                        console.error('Èü≥È¢ëÊí≠ÊîæÂ§±Ë¥•:', error);
                        showAlert('Èü≥È¢ëÊí≠ÊîæÂ§±Ë¥•', 'danger');
                    });
                };

                const handleImageUpload = (event) => {
                    const file = event.target.files[0];
                    if (file) {
                        if (selectedTaskId.value === 'i2v') {
                            i2vForm.value.imageFile = file;
                        } else if (selectedTaskId.value === 's2v') {
                            s2vForm.value.imageFile = file;
                        }
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            setCurrentImagePreview(e.target.result);
                            updateUploadedContentStatus();
                        };
                        reader.readAsDataURL(file);
                    } else {
                        // Áî®Êà∑ÂèñÊ∂à‰∫ÜÈÄâÊã©Ôºå‰øùÊåÅÂéüÊúâÂõæÁâá‰∏çÂèò
                        // ‰∏çÂÅö‰ªª‰ΩïÊìç‰Ωú
                    }
                };

                const selectTask = (taskType) => {
                    selectedTaskId.value = taskType;

                    // Ê†πÊçÆ‰ªªÂä°Á±ªÂûãÊÅ¢Â§çÂØπÂ∫îÁöÑÈ¢ÑËßà
                    if (taskType === 'i2v' && i2vForm.value.imageFile) {
                        // ÊÅ¢Â§çÂõæÁâáÈ¢ÑËßà
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            setCurrentImagePreview(e.target.result);
                        };
                        reader.readAsDataURL(i2vForm.value.imageFile);
                    } else if (taskType === 's2v') {
                        // ÊÅ¢Â§çÊï∞Â≠ó‰∫∫‰ªªÂä°ÁöÑÂõæÁâáÂíåÈü≥È¢ëÈ¢ÑËßà
                        if (s2vForm.value.imageFile) {
                            const reader = new FileReader();
                            reader.onload = (e) => {
                                setCurrentImagePreview(e.target.result);
                            };
                            reader.readAsDataURL(s2vForm.value.imageFile);
                        }
                        if (s2vForm.value.audioFile) {
                            const reader = new FileReader();
                            reader.onload = (e) => {
                                setCurrentAudioPreview(e.target.result);
                            };
                            reader.readAsDataURL(s2vForm.value.audioFile);
                        }
                    }

                    // Â¶ÇÊûúÂΩìÂâçË°®ÂçïÊ≤°ÊúâÈÄâÊã©Ê®°ÂûãÔºåËá™Âä®ÈÄâÊã©Á¨¨‰∏Ä‰∏™ÂèØÁî®ÁöÑÊ®°Âûã
                    const currentForm = getCurrentForm();
                    if (!currentForm.model_cls) {
                    const availableModels = models.value.filter(m => m.task === taskType);
                    if (availableModels.length > 0) {
                        const firstModel = availableModels[0];
                            currentForm.model_cls = firstModel.model_cls;
                            currentForm.stage = firstModel.stage;
                        }
                    }
                };

                const selectModel = (model) => {
                    getCurrentForm().model_cls = model;
                };

                const triggerImageUpload = () => {
                    document.querySelector('input[type="file"][accept="image/*"]').click();
                };

                const triggerAudioUpload = () => {
                    document.querySelector('input[type="file"][accept="audio/*"]').click();
                };

                const removeImage = () => {
                    setCurrentImagePreview(null);
                    if (selectedTaskId.value === 'i2v') {
                        i2vForm.value.imageFile = null;
                    } else if (selectedTaskId.value === 's2v') {
                        s2vForm.value.imageFile = null;
                    }
                    updateUploadedContentStatus();
                    // ÈáçÁΩÆÊñá‰ª∂ËæìÂÖ•Ê°ÜÔºåÁ°Æ‰øùÂèØ‰ª•ÈáçÊñ∞ÈÄâÊã©Áõ∏ÂêåÊñá‰ª∂
                    const imageInput = document.querySelector('input[type="file"][accept="image/*"]');
                    if (imageInput) {
                        imageInput.value = '';
                    }
                };

                const removeAudio = () => {
                    setCurrentAudioPreview(null);
                    s2vForm.value.audioFile = null;
                    updateUploadedContentStatus();
                    console.log('Èü≥È¢ëÂ∑≤ÁßªÈô§');
                    // ÈáçÁΩÆÈü≥È¢ëÊñá‰ª∂ËæìÂÖ•Ê°ÜÔºåÁ°Æ‰øùÂèØ‰ª•ÈáçÊñ∞ÈÄâÊã©Áõ∏ÂêåÊñá‰ª∂
                    const audioInput = document.querySelector('input[type="file"][accept="audio/*"]');
                    if (audioInput) {
                        audioInput.value = '';
                    }
                };

                const getAudioMimeType = () => {
                    if (s2vForm.value.audioFile) {
                        return s2vForm.value.audioFile.type;
                    }
                    return 'audio/mpeg'; // ÈªòËÆ§Á±ªÂûã
                };

                const handleAudioUpload = (event) => {
                    const file = event.target.files[0];

                    if (file) {
                        s2vForm.value.audioFile = file;
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            setCurrentAudioPreview(e.target.result);
                            updateUploadedContentStatus();
                            console.log('Èü≥È¢ëÈ¢ÑËßàÂ∑≤ËÆæÁΩÆ:', e.target.result);
                        };
                        reader.readAsDataURL(file);
                    } else {
                        setCurrentAudioPreview(null);
                        updateUploadedContentStatus();
                    }
                };

                const submitTask = async () => {
                    try {
                        const currentForm = getCurrentForm();

                        // Ë°®ÂçïÈ™åËØÅ
                        if (!selectedTaskId.value) {
                            showAlert('ËØ∑ÈÄâÊã©‰ªªÂä°Á±ªÂûã', 'warning');
                            return;
                        }

                        if (!currentForm.model_cls) {
                            showAlert('ËØ∑ÈÄâÊã©Ê®°Âûã', 'warning');
                            return;
                        }

                        if (!currentForm.prompt || currentForm.prompt.trim().length === 0) {
                            showAlert('ËØ∑ËæìÂÖ•ÊèêÁ§∫ËØç', 'warning');
                            return;
                        }

                        if (currentForm.prompt.length > 500) {
                            showAlert('ÊèêÁ§∫ËØçÈïøÂ∫¶‰∏çËÉΩË∂ÖËøá500‰∏™Â≠óÁ¨¶', 'warning');
                            return;
                        }

                        if (selectedTaskId.value === 'i2v' && !currentForm.imageFile) {
                            showAlert('ÂõæÁîüËßÜÈ¢ë‰ªªÂä°ÈúÄË¶Å‰∏ä‰º†ÂèÇËÄÉÂõæÁâá', 'warning');
                            return;
                        }

                        if (selectedTaskId.value === 's2v' && !currentForm.imageFile) {
                            showAlert('Êï∞Â≠ó‰∫∫‰ªªÂä°ÈúÄË¶Å‰∏ä‰º†ÂèÇËÄÉÂõæÁâá', 'warning');
                            return;
                        }

                        if (selectedTaskId.value === 's2v' && !currentForm.audioFile) {
                            showAlert('Êï∞Â≠ó‰∫∫‰ªªÂä°ÈúÄË¶Å‰∏ä‰º†Èü≥È¢ëÊñá‰ª∂', 'warning');
                            return;
                        }
                        submitting.value = true;

                        // Á°ÆÂÆöÂÆûÈôÖÊèê‰∫§ÁöÑ‰ªªÂä°Á±ªÂûã
                        let actualTaskType = selectedTaskId.value;

                        var formData = {
                            task: actualTaskType,
                            model_cls: currentForm.model_cls,
                            stage: currentForm.stage,
                            prompt: currentForm.prompt.trim(),
                            seed: currentForm.seed || Math.floor(Math.random() * 1000000)
                        };

                        if (currentForm.model_cls.startsWith('wan2.1')) {
                            formData.negative_prompt = "ÈïúÂ§¥ÊôÉÂä®ÔºåËâ≤Ë∞ÉËâ≥‰∏ΩÔºåËøáÊõùÔºåÈùôÊÄÅÔºåÁªÜËäÇÊ®°Á≥ä‰∏çÊ∏ÖÔºåÂ≠óÂπïÔºåÈ£éÊ†ºÔºå‰ΩúÂìÅÔºåÁîª‰ΩúÔºåÁîªÈù¢ÔºåÈùôÊ≠¢ÔºåÊï¥‰ΩìÂèëÁÅ∞ÔºåÊúÄÂ∑ÆË¥®ÈáèÔºå‰ΩéË¥®ÈáèÔºåJPEGÂéãÁº©ÊÆãÁïôÔºå‰∏ëÈôãÁöÑÔºåÊÆãÁº∫ÁöÑÔºåÂ§ö‰ΩôÁöÑÊâãÊåáÔºåÁîªÂæó‰∏çÂ•ΩÁöÑÊâãÈÉ®ÔºåÁîªÂæó‰∏çÂ•ΩÁöÑËÑ∏ÈÉ®ÔºåÁï∏ÂΩ¢ÁöÑÔºåÊØÅÂÆπÁöÑÔºåÂΩ¢ÊÄÅÁï∏ÂΩ¢ÁöÑËÇ¢‰ΩìÔºåÊâãÊåáËûçÂêàÔºåÈùôÊ≠¢‰∏çÂä®ÁöÑÁîªÈù¢ÔºåÊùÇ‰π±ÁöÑËÉåÊôØÔºå‰∏âÊù°ËÖøÔºåËÉåÊôØ‰∫∫ÂæàÂ§öÔºåÂÄíÁùÄËµ∞"
                        }

                        if (selectedTaskId.value === 'i2v' && currentForm.imageFile) {
                            const base64 = await fileToBase64(currentForm.imageFile);
                            formData.input_image = {
                                type: 'base64',
                                data: base64
                            };
                        }

                        if (selectedTaskId.value === 's2v') {
                            if (currentForm.imageFile) {
                                const base64 = await fileToBase64(currentForm.imageFile);
                                formData.input_image = {
                                    type: 'base64',
                                    data: base64
                                };
                            }
                            if (currentForm.audioFile) {
                                const base64 = await fileToBase64(currentForm.audioFile);
                                formData.input_audio = {
                                    type: 'base64',
                                    data: base64
                                };
                                formData.negative_prompt = "Ëâ≤Ë∞ÉËâ≥‰∏ΩÔºåËøáÊõùÔºåÈùôÊÄÅÔºåÁªÜËäÇÊ®°Á≥ä‰∏çÊ∏ÖÔºåÂ≠óÂπïÔºåÈ£éÊ†ºÔºå‰ΩúÂìÅÔºåÁîª‰ΩúÔºåÁîªÈù¢ÔºåÈùôÊ≠¢ÔºåÊï¥‰ΩìÂèëÁÅ∞ÔºåÊúÄÂ∑ÆË¥®ÈáèÔºå‰ΩéË¥®ÈáèÔºåJPEGÂéãÁº©ÊÆãÁïôÔºå‰∏ëÈôãÁöÑÔºåÊÆãÁº∫ÁöÑÔºåÂ§ö‰ΩôÁöÑÊâãÊåáÔºåÁîªÂæó‰∏çÂ•ΩÁöÑÊâãÈÉ®ÔºåÁîªÂæó‰∏çÂ•ΩÁöÑËÑ∏ÈÉ®ÔºåÁï∏ÂΩ¢ÁöÑÔºåÊØÅÂÆπÁöÑÔºåÂΩ¢ÊÄÅÁï∏ÂΩ¢ÁöÑËÇ¢‰ΩìÔºåÊâãÊåáËûçÂêàÔºåÈùôÊ≠¢‰∏çÂä®ÁöÑÁîªÈù¢ÔºåÊùÇ‰π±ÁöÑËÉåÊôØÔºå‰∏âÊù°ËÖøÔºåËÉåÊôØ‰∫∫ÂæàÂ§öÔºåÂÄíÁùÄËµ∞"
                            }
                        }

                        const response = await apiRequest('./api/v1/task/submit', {
                            method: 'POST',
                            body: JSON.stringify(formData)
                        });

                        if (response && response.ok) {
                            const result = await response.json();
                            showAlert(t('taskSubmitSuccessAlert'), 'success');

                            // ‰øùÂ≠òÂÆåÊï¥ÁöÑ‰ªªÂä°ÂéÜÂè≤ÔºàÂåÖÊã¨ÊèêÁ§∫ËØç„ÄÅÂõæÁâáÂíåÈü≥È¢ëÔºâ
                            addTaskToHistory(selectedTaskId.value, currentForm);

                            refreshTasks(true); // Âº∫Âà∂Âà∑Êñ∞
                            
                            // ÂºÄÂßãËΩÆËØ¢Êñ∞Êèê‰∫§ÁöÑ‰ªªÂä°Áä∂ÊÄÅ
                            startPollingTask(result.task_id);
                            
                            await resetForm(selectedTaskId.value);
                            // ÈáçÁΩÆÂΩìÂâç‰ªªÂä°Á±ªÂûãÁöÑË°®ÂçïÔºà‰øùÁïôÊ®°ÂûãÈÄâÊã©ÔºåÊ∏ÖÁ©∫ÂõæÁâá„ÄÅÈü≥È¢ëÂíåÊèêÁ§∫ËØçÔºâ
                            selectedTaskId.value = selectedTaskId.value;
                            selectModel(currentForm.model_cls);
                            switchToProjectsView();

                        } else {
                            const error = await response.json();
                            showAlert(`${t('taskSubmitFailedAlert')}: ${error.message},${error.detail}`, 'danger');
                        }
                    } catch (error) {
                        showAlert(`${t('submitTaskFailedAlert')}: ${error.message}`, 'danger');
                    } finally {
                        submitting.value = false;
                    }
                };

                const fileToBase64 = (file) => {
                    return new Promise((resolve, reject) => {
                        const reader = new FileReader();
                        reader.readAsDataURL(file);
                        reader.onload = () => {
                            const base64 = reader.result.split(',')[1];
                            resolve(base64);
                        };
                        reader.onerror = error => reject(error);
                    });
                };

                const formatTime = (timestamp) => {
                    if (!timestamp) return '';
                    const date = new Date(timestamp * 1000);
                    return date.toLocaleString('zh-CN');
                };


                // ÈÄöÁî®ÁºìÂ≠òÁÆ°ÁêÜÂáΩÊï∞
                const loadFromCache = (cacheKey, expiryKey) => {
                    try {
                        const cached = localStorage.getItem(cacheKey);
                        if (cached) {
                            const data = JSON.parse(cached);
                            if (Date.now() - data.timestamp < expiryKey) {
                                console.log(`ÊàêÂäü‰ªéÁºìÂ≠òÂä†ËΩΩÊï∞ÊçÆ${cacheKey}:`, data.data);
                                return data.data;
                            } else {
                                // ÁºìÂ≠òËøáÊúüÔºåÊ∏ÖÈô§
                                localStorage.removeItem(cacheKey);
                                console.log(`ÁºìÂ≠òËøáÊúüÔºåÊ∏ÖÈô§ ${cacheKey}`);
                            }
                        }
                    } catch (error) {
                        console.warn(`Âä†ËΩΩÁºìÂ≠òÂ§±Ë¥• ${cacheKey}:`, error);
                        localStorage.removeItem(cacheKey);
                    }
                    return null;
                };

                const saveToCache = (cacheKey, data) => {
                    try {
                        const cacheData = {
                            data: data,
                            timestamp: Date.now()
                        };
                        console.log(`ÊàêÂäü‰øùÂ≠òÁºìÂ≠òÊï∞ÊçÆ ${cacheKey}:`, cacheData);
                        localStorage.setItem(cacheKey, JSON.stringify(cacheData));
                    } catch (error) {
                        console.warn(`‰øùÂ≠òÁºìÂ≠òÂ§±Ë¥• ${cacheKey}:`, error);
                    }
                };

                // Ê∏ÖÈô§ÊâÄÊúâÂ∫îÁî®ÁºìÂ≠ò
                const clearAllCache = () => {
                    try {
                        const cacheKeys = [
                            TASK_FILE_CACHE_KEY,
                            TEMPLATE_FILE_CACHE_KEY,
                            MODELS_CACHE_KEY,
                            TEMPLATES_CACHE_KEY
                        ];
                        
                        // Ê∏ÖÈô§ÊâÄÊúâ‰ªªÂä°ÁºìÂ≠òÔºà‰ΩøÁî®ÈÄöÈÖçÁ¨¶ÂåπÈÖçÔºâ
                        for (let i = 0; i < localStorage.length; i++) {
                            const key = localStorage.key(i);
                            if (key && key.startsWith(TASKS_CACHE_KEY)) {
                                localStorage.removeItem(key);
                            }
                        }
                        
                        // Ê∏ÖÈô§ÊâÄÊúâÊ®°ÊùøÁºìÂ≠òÔºà‰ΩøÁî®ÈÄöÈÖçÁ¨¶ÂåπÈÖçÔºâ
                        for (let i = 0; i < localStorage.length; i++) {
                            const key = localStorage.key(i);
                            if (key && key.startsWith(TEMPLATES_CACHE_KEY)) {
                                localStorage.removeItem(key);
                            }
                        }
                        // Ê∏ÖÈô§ÂÖ∂‰ªñÁºìÂ≠ò
                        cacheKeys.forEach(key => {
                            localStorage.removeItem(key);
                        });
                        
                        // Ê∏ÖÈô§ÂÜÖÂ≠ò‰∏≠ÁöÑ‰ªªÂä°Êñá‰ª∂ÁºìÂ≠ò
                        taskFileCache.value.clear();
                        taskFileCacheLoaded.value = false;
                        
                        // Ê∏ÖÈô§ÂÜÖÂ≠ò‰∏≠ÁöÑÊ®°ÊùøÊñá‰ª∂ÁºìÂ≠ò
                        templateFileCache.value.clear();
                        templateFileCacheLoaded.value = false;
                        
                        console.log('ÊâÄÊúâÁºìÂ≠òÂ∑≤Ê∏ÖÈô§');
                    } catch (error) {
                        console.warn('Ê∏ÖÈô§ÁºìÂ≠òÂ§±Ë¥•:', error);
                    }
                };

                // Ê®°ÊùøÊñá‰ª∂ÁºìÂ≠òÁÆ°ÁêÜÂáΩÊï∞
                const loadTemplateFilesFromCache = () => {
                    try {
                        const cached = localStorage.getItem(TEMPLATE_FILE_CACHE_KEY);
                        if (cached) {
                            const data = JSON.parse(cached);
                            if (data.files) {
                                for (const [cacheKey, fileData] of Object.entries(data.files)) {
                                    templateFileCache.value.set(cacheKey, fileData);
                                }
                                return true;
                            } else {
                                console.warn('Ê®°ÊùøÊñá‰ª∂ÁºìÂ≠òÊï∞ÊçÆÊ†ºÂºèÈîôËØØ');
                                return false;
                            }
                        }
                    } catch (error) {
                        console.warn('Âä†ËΩΩÊ®°ÊùøÊñá‰ª∂ÁºìÂ≠òÂ§±Ë¥•:', error);
                    }
                    return false;
                };

                const saveTemplateFilesToCache = () => {
                    try {
                        const files = {};
                        for (const [cacheKey, fileData] of templateFileCache.value.entries()) {
                            files[cacheKey] = fileData;
                        }
                        const data = {
                            files: files,
                            timestamp: Date.now()
                        };
                        localStorage.setItem(TEMPLATE_FILE_CACHE_KEY, JSON.stringify(data));
                    } catch (error) {
                        console.warn('‰øùÂ≠òÊ®°ÊùøÊñá‰ª∂ÁºìÂ≠òÂ§±Ë¥•:', error);
                    }
                };

                const getTemplateFileCacheKey = (templateId, fileKey) => {
                    return `template_${templateId}_${fileKey}`;
                };

                const getTemplateFileFromCache = (cacheKey) => {
                    return templateFileCache.value.get(cacheKey) || null;
                };

                const setTemplateFileToCache = (fileKey, fileData) => {
                    templateFileCache.value.set(fileKey, fileData);
                    // ÂºÇÊ≠•‰øùÂ≠òÂà∞localStorage
                    setTimeout(() => {
                        saveTemplateFilesToCache();
                    }, 100);
                };

                // Ëé∑ÂèñÊ®°ÊùøÊñá‰ª∂URLÔºà‰ºòÂÖà‰ªéÁºìÂ≠òÔºåÁºìÂ≠òÊ≤°ÊúâÂàôÁîüÊàêURLÔºâ- ÂêåÊ≠•ÁâàÊú¨
                const getTemplateFileUrl = (fileKey, fileType) => {
                    // ÂÖà‰ªéÁºìÂ≠òËé∑Âèñ
                    const cachedFile = getTemplateFileFromCache(fileKey);
                    if (cachedFile) {
                        console.log('‰ªéÁºìÂ≠òËé∑ÂèñÊ®°ÊùøÊñá‰ª∂url', { fileKey});
                        return cachedFile.url;
                    }

                    // ÁºìÂ≠ò‰∏≠Ê≤°ÊúâÔºåÁîüÊàêAPI URLÂπ∂ÁºìÂ≠ò
                    const token = localStorage.getItem('accessToken');
                    const url = token
                        ? `./api/v1/template/${fileType}/${fileKey}?token=${encodeURIComponent(token)}`
                        : `./api/v1/template/${fileType}/${fileKey}`;
                    const cachedUrl = getCachedUrl(`template_${fileType}_${fileKey}`, () => url);
                    // // ÁºìÂ≠òAPI URL
                    setTemplateFileToCache(fileKey, {
                        url: url,
                        timestamp: Date.now()
                    });
                    
                    console.log('getTemplateFileUrl: ÁîüÊàêÂπ∂ÁºìÂ≠òÊ®°ÊùøURL', { fileKey, fileType, cachedUrl });
                    return cachedUrl;
                };

                // Ëé∑ÂèñÊ®°ÊùøÊñá‰ª∂URLÔºàÂºÇÊ≠•ÁâàÊú¨ÔºåÁî®‰∫éÈ¢ÑÂä†ËΩΩÁ≠âÂú∫ÊôØÔºâ
                const getTemplateFileUrlAsync = async (fileKey, fileType) => {
                    // ÂÖà‰ªéÁºìÂ≠òËé∑Âèñ
                    const cachedFile = getTemplateFileFromCache(fileKey);
                    if (cachedFile) {
                        console.log('getTemplateFileUrlAsync: ‰ªéÁºìÂ≠òËé∑Âèñ', { fileKey, url: cachedFile.url });
                        return cachedFile.url;
                    }

                    // ÁºìÂ≠ò‰∏≠Ê≤°ÊúâÔºåÁîüÊàêAPI URLÂπ∂ÁºìÂ≠ò
                    const token = localStorage.getItem('accessToken');
                    const url = token
                        ? `./api/v1/template/${fileType}/${fileKey}?token=${encodeURIComponent(token)}`
                        : `./api/v1/template/${fileType}/${fileKey}`;
                    const cachedUrl = getCachedUrl(`template_${fileType}_${fileKey}`, () => url);
                    
                    console.log('getTemplateFileUrlAsync: ÁîüÊàêÂπ∂ÁºìÂ≠òÊ®°ÊùøURL', { fileKey, fileType, cachedUrl });
                    return cachedUrl;
                };

                // ‰ªªÂä°Êñá‰ª∂ÁºìÂ≠òÁÆ°ÁêÜÂáΩÊï∞
                const loadTaskFilesFromCache = () => {
                    try {
                        const cached = localStorage.getItem(TASK_FILE_CACHE_KEY);
                        if (cached) {
                            const data = JSON.parse(cached);
                            // Ê£ÄÊü•ÊòØÂê¶ËøáÊúü
                            if (Date.now() - data.timestamp < TASK_FILE_CACHE_EXPIRY) {
                                // Â∞ÜÁºìÂ≠òÊï∞ÊçÆÂä†ËΩΩÂà∞ÂÜÖÂ≠òÁºìÂ≠ò‰∏≠
                                for (const [cacheKey, fileData] of Object.entries(data.files)) {
                                    taskFileCache.value.set(cacheKey, fileData);
                                }
                                return true;
                            } else {
                                // ÁºìÂ≠òËøáÊúüÔºåÊ∏ÖÈô§
                                localStorage.removeItem(TASK_FILE_CACHE_KEY);
                            }
                        }
                    } catch (error) {
                        console.warn('Âä†ËΩΩ‰ªªÂä°Êñá‰ª∂ÁºìÂ≠òÂ§±Ë¥•:', error);
                        localStorage.removeItem(TASK_FILE_CACHE_KEY);
                    }
                    return false;
                };

                const saveTaskFilesToCache = () => {
                    try {
                        const files = {};
                        for (const [cacheKey, fileData] of taskFileCache.value.entries()) {
                            files[cacheKey] = fileData;
                        }
                        const data = {
                            files,
                            timestamp: Date.now()
                        };
                        localStorage.setItem(TASK_FILE_CACHE_KEY, JSON.stringify(data));
                    } catch (error) {
                        console.warn('‰øùÂ≠ò‰ªªÂä°Êñá‰ª∂ÁºìÂ≠òÂ§±Ë¥•:', error);
                    }
                };

                // ÁîüÊàêÁºìÂ≠òÈîÆ
                const getTaskFileCacheKey = (taskId, fileKey) => {
                    return `${taskId}_${fileKey}`;
                };

                // ‰ªéÁºìÂ≠òËé∑Âèñ‰ªªÂä°Êñá‰ª∂
                const getTaskFileFromCache = (taskId, fileKey) => {
                    const cacheKey = getTaskFileCacheKey(taskId, fileKey);
                    return taskFileCache.value.get(cacheKey) || null;
                };

                // ËÆæÁΩÆ‰ªªÂä°Êñá‰ª∂Âà∞ÁºìÂ≠ò
                const setTaskFileToCache = (taskId, fileKey, fileData) => {
                    const cacheKey = getTaskFileCacheKey(taskId, fileKey);
                    taskFileCache.value.set(cacheKey, fileData);
                    // ÂºÇÊ≠•‰øùÂ≠òÂà∞localStorage
                    setTimeout(() => {
                        saveTaskFilesToCache();
                    }, 100);
                };

                // Ëé∑Âèñ‰ªªÂä°Êñá‰ª∂URLÔºà‰ºòÂÖà‰ªéÁºìÂ≠òÔºåÁºìÂ≠òÊ≤°ÊúâÂàôË∞ÉÁî®ÂêéÁ´ØÔºâ
                const getTaskFileUrl = async (taskId, fileKey) => {
                    // ÂÖà‰ªéÁºìÂ≠òËé∑Âèñ
                    const cachedFile = getTaskFileFromCache(taskId, fileKey);
                    if (cachedFile) {
                        return cachedFile.url;
                    }

                    // ÁºìÂ≠ò‰∏≠Ê≤°ÊúâÔºåÁîüÊàêAPI URLÂπ∂ÁºìÂ≠ò
                    const token = localStorage.getItem('accessToken');
                    let apiUrl;
                    if (fileKey.includes('output')) {
                        apiUrl = token 
                            ? `./api/v1/task/result?task_id=${taskId}&name=${fileKey}&token=${encodeURIComponent(token)}`
                            : `./api/v1/task/result?task_id=${taskId}&name=${fileKey}`;
                    } else {
                        apiUrl = token 
                            ? `./api/v1/task/input?task_id=${taskId}&name=${fileKey}&token=${encodeURIComponent(token)}`
                            : `./api/v1/task/input?task_id=${taskId}&name=${fileKey}`;
                    }
                    
                    // ÁºìÂ≠òAPI URL
                    setTaskFileToCache(taskId, fileKey, {
                        url: apiUrl,
                        timestamp: Date.now()
                    });
                    
                    return apiUrl;
                };

                // Ëé∑Âèñ‰ªªÂä°ÁöÑÁ¨¨‰∏Ä‰∏™ÂõæÁâáÈîÆ
                const getFirstImageKey = (task) => {
                    if (!task || !task.inputs) return null;
                    
                    const imageInputs = Object.keys(task.inputs).filter(key =>
                        key.includes('image') ||
                        task.inputs[key].toString().toLowerCase().match(/\.(jpg|jpeg|png|gif|bmp|webp)$/)
                    );
                    
                    return imageInputs.length > 0 ? imageInputs[0] : null;
                };

                // ÂêåÊ≠•Ëé∑Âèñ‰ªªÂä°Êñá‰ª∂URLÔºà‰ªÖ‰ªéÁºìÂ≠òËé∑ÂèñÔºåÁî®‰∫éÊ®°ÊùøÊòæÁ§∫Ôºâ
                const getTaskFileUrlSync = (taskId, fileKey) => {
                    const cachedFile = getTaskFileFromCache(taskId, fileKey);
                    if (cachedFile) {
                        console.log('getTaskFileUrlSync: ‰ªéÁºìÂ≠òËé∑Âèñ', { taskId, fileKey, url: cachedFile.url, type: typeof cachedFile.url });
                        return cachedFile.url;
                    }
                    console.log('getTaskFileUrlSync: ÁºìÂ≠ò‰∏≠Ê≤°ÊúâÊâæÂà∞', { taskId, fileKey });
                    return null;
                };

                // È¢ÑÂä†ËΩΩ‰ªªÂä°Êñá‰ª∂
                const preloadTaskFilesUrl = async (tasks) => {
                    if (!tasks || tasks.length === 0) return;

                    // ÂÖàÂ∞ùËØï‰ªélocalStorageÂä†ËΩΩÁºìÂ≠ò
                    if (taskFileCache.value.size === 0) {
                        loadTaskFilesFromCache();
                    }

                    console.log(`ÂºÄÂßãËé∑Âèñ ${tasks.length} ‰∏™‰ªªÂä°ÁöÑÊñá‰ª∂url`);

                    // ÂàÜÊâπÈ¢ÑÂä†ËΩΩÔºåÈÅøÂÖçËøáÂ§öÂπ∂ÂèëËØ∑Ê±Ç
                    const batchSize = 5;
                    for (let i = 0; i < tasks.length; i += batchSize) {
                        const batch = tasks.slice(i, i + batchSize);
                        
                        const promises = batch.map(async (task) => {
                            if (!task.task_id) return;

                            // È¢ÑÂä†ËΩΩËæìÂÖ•ÂõæÁâá
                            if (task.inputs) {
                                const imageInputs = Object.keys(task.inputs).filter(key =>
                                    key.includes('image') ||
                                    task.inputs[key].toString().toLowerCase().match(/\.(jpg|jpeg|png|gif|bmp|webp)$/)
                                );
                                
                                for (const imageKey of imageInputs) {
                                    await getTaskFileUrl(task.task_id, imageKey);
                                }
                            }

                            // È¢ÑÂä†ËΩΩËæìÂá∫ËßÜÈ¢ë
                            if (task.outputs && task.outputs.output_video && task.status === 'SUCCEED') {
                                await getTaskFileUrl(task.task_id, 'output_video');
                            }
                        });

                        await Promise.all(promises);
                        
                        // ÊâπÊ¨°Èó¥Ê∑ªÂä†Âª∂Ëøü
                        if (i + batchSize < tasks.length) {
                            await new Promise(resolve => setTimeout(resolve, 200));
                        }
                    }

                    console.log('‰ªªÂä°Êñá‰ª∂urlÈ¢ÑÂä†ËΩΩÂÆåÊàê');
                };

                // È¢ÑÂä†ËΩΩÊ®°ÊùøÊñá‰ª∂
                const preloadTemplateFilesUrl = async (templates) => {
                    if (!templates || templates.length === 0) return;

                    // ÂÖàÂ∞ùËØï‰ªélocalStorageÂä†ËΩΩÁºìÂ≠ò
                    if (templateFileCache.value.size === 0) {
                        loadTemplateFilesFromCache();
                    }

                    console.log(`ÂºÄÂßãËé∑Âèñ ${templates.length} ‰∏™Ê®°ÊùøÁöÑÊñá‰ª∂url`);

                    // ÂàÜÊâπÈ¢ÑÂä†ËΩΩÔºåÈÅøÂÖçËøáÂ§öÂπ∂ÂèëËØ∑Ê±Ç
                    const batchSize = 5;
                    for (let i = 0; i < templates.length; i += batchSize) {
                        const batch = templates.slice(i, i + batchSize);
                        
                        const promises = batch.map(async (template) => {
                            if (!template.task_id) return;

                            // È¢ÑÂä†ËΩΩËßÜÈ¢ëÊñá‰ª∂
                            if (template.outputs?.output_video) {
                                await getTemplateFileUrlAsync(template.outputs.output_video, 'videos');
                            }

                            // È¢ÑÂä†ËΩΩÂõæÁâáÊñá‰ª∂
                            if (template.inputs?.input_image) {
                                await getTemplateFileUrlAsync(template.inputs.input_image, 'images');
                            }

                            // È¢ÑÂä†ËΩΩÈü≥È¢ëÊñá‰ª∂
                            if (template.inputs?.input_audio) {
                                await getTemplateFileUrlAsync(template.inputs.input_audio, 'audios');
                            }
                        });

                        await Promise.all(promises);
                        
                        // ÊâπÊ¨°Èó¥Ê∑ªÂä†Âª∂Ëøü
                        if (i + batchSize < templates.length) {
                            await new Promise(resolve => setTimeout(resolve, 200));
                        }
                    }

                    console.log('Ê®°ÊùøÊñá‰ª∂urlÈ¢ÑÂä†ËΩΩÂÆåÊàê');
                };


                const refreshTasks = async (forceRefresh = false) => {
                    try {
                        console.log('ÂºÄÂßãÂà∑Êñ∞‰ªªÂä°ÂàóË°®, forceRefresh:', forceRefresh, 'currentPage:', currentTaskPage.value);
                        
                        // ÊûÑÂª∫ÁºìÂ≠òÈîÆÔºåÂåÖÂê´ÂàÜÈ°µÂíåËøáÊª§Êù°‰ª∂
                        const cacheKey = `${TASKS_CACHE_KEY}_${currentTaskPage.value}_${taskPageSize.value}_${statusFilter.value}_${taskSearchQuery.value}`;
                        
                        // Â¶ÇÊûú‰∏çÊòØÂº∫Âà∂Âà∑Êñ∞ÔºåÂÖàÂ∞ùËØï‰ªéÁºìÂ≠òÂä†ËΩΩ
                        if (!forceRefresh) {
                            const cachedTasks = loadFromCache(cacheKey, TASKS_CACHE_EXPIRY);
                            if (cachedTasks) {
                                console.log('‰ªéÁºìÂ≠òÂä†ËΩΩ‰ªªÂä°ÂàóË°®');
                                tasks.value = cachedTasks.tasks || [];
                                pagination.value = cachedTasks.pagination || null;
                                // Âº∫Âà∂Ëß¶ÂèëÂìçÂ∫îÂºèÊõ¥Êñ∞
                                await nextTick();
                                // Âº∫Âà∂Âà∑Êñ∞ÂàÜÈ°µÁªÑ‰ª∂
                                paginationKey.value++;
                                // ‰ΩøÁî®Êñ∞ÁöÑ‰ªªÂä°Êñá‰ª∂È¢ÑÂä†ËΩΩÈÄªËæë
                                await preloadTaskFilesUrl(tasks.value);
                                return;
                            }
                        }

                        const params = new URLSearchParams({
                            page: currentTaskPage.value.toString(),
                            page_size: taskPageSize.value.toString()
                        });

                        if (statusFilter.value !== 'ALL') {
                            params.append('status', statusFilter.value);
                        }

                        console.log('ËØ∑Ê±Ç‰ªªÂä°ÂàóË°®API:', `./api/v1/task/list?${params.toString()}`);
                        const response = await apiRequest(`./api/v1/task/list?${params.toString()}`);
                        if (response && response.ok) {
                            const data = await response.json();
                            console.log('‰ªªÂä°ÂàóË°®APIÂìçÂ∫î:', data);
                            
                            // Âº∫Âà∂Ê∏ÖÁ©∫Âπ∂ÈáçÊñ∞ËµãÂÄºÔºåÁ°Æ‰øùVueÊ£ÄÊµãÂà∞ÂèòÂåñ
                            tasks.value = [];
                            pagination.value = null;
                            await nextTick();
                            
                            tasks.value = data.tasks || [];
                            pagination.value = data.pagination || null;
                            
                            // ÁºìÂ≠ò‰ªªÂä°Êï∞ÊçÆ
                            saveToCache(cacheKey, {
                                tasks: data.tasks || [],
                                pagination: data.pagination || null
                            });
                            console.log('ÁºìÂ≠ò‰ªªÂä°ÂàóË°®Êï∞ÊçÆÊàêÂäü');

                            // Âº∫Âà∂Ëß¶ÂèëÂìçÂ∫îÂºèÊõ¥Êñ∞
                            await nextTick();
                            
                            // Âº∫Âà∂Âà∑Êñ∞ÂàÜÈ°µÁªÑ‰ª∂
                            paginationKey.value++;
                            
                            // ‰ΩøÁî®Êñ∞ÁöÑ‰ªªÂä°Êñá‰ª∂È¢ÑÂä†ËΩΩÈÄªËæë
                            await preloadTaskFilesUrl(tasks.value);
                        } else if (response) {
                            showAlert('Âà∑Êñ∞‰ªªÂä°ÂàóË°®Â§±Ë¥•', 'danger');
                        }
                        // Â¶ÇÊûúresponse‰∏∫nullÔºåËØ¥ÊòéÊòØËÆ§ËØÅÈîôËØØÔºåapiRequestÂ∑≤ÁªèÂ§ÑÁêÜ‰∫Ü
                    } catch (error) {
                        console.error('Âà∑Êñ∞‰ªªÂä°ÂàóË°®Â§±Ë¥•:', error);
                        showAlert(`Âà∑Êñ∞‰ªªÂä°ÂàóË°®Â§±Ë¥•: ${error.message}`, 'danger');
                    }
                };

                // ÂàÜÈ°µÁõ∏ÂÖ≥ÂáΩÊï∞
                const goToPage = async (page) => {
                    if (page < 1 || page > pagination.value?.total_pages || page === currentTaskPage.value) {
                        return;
                    }
                    currentTaskPage.value = page;
                    taskPageInput.value = page; // ÂêåÊ≠•Êõ¥Êñ∞ËæìÂÖ•Ê°Ü
                    refreshTasks();
                };

                const jumpToPage = async () => {
                    const page = parseInt(taskPageInput.value);
                    if (page && page >= 1 && page <= pagination.value?.total_pages && page !== currentTaskPage.value) {
                        await goToPage(page);
                    } else {
                        // Â¶ÇÊûúËæìÂÖ•Êó†ÊïàÔºåÊÅ¢Â§çÂà∞ÂΩìÂâçÈ°µ
                        taskPageInput.value = currentTaskPage.value;
                    }
                };

                // TemplateÂàÜÈ°µÁõ∏ÂÖ≥ÂáΩÊï∞
                const goToTemplatePage = async (page) => {
                    if (page < 1 || page > templatePagination.value?.total_pages || page === templateCurrentPage.value) {
                        return;
                    }
                    templateCurrentPage.value = page;
                    templatePageInput.value = page; // ÂêåÊ≠•Êõ¥Êñ∞ËæìÂÖ•Ê°Ü
                    loadImageAudioTemplates(true);
                };

                const jumpToTemplatePage = async () => {
                    const page = parseInt(templatePageInput.value);
                    if (page && page >= 1 && page <= templatePagination.value?.total_pages && page !== templateCurrentPage.value) {
                        await goToTemplatePage(page);
                    } else {
                        // Â¶ÇÊûúËæìÂÖ•Êó†ÊïàÔºåÊÅ¢Â§çÂà∞ÂΩìÂâçÈ°µ
                        templatePageInput.value = templateCurrentPage.value;
                    }
                };

                const getVisiblePages = () => {
                    if (!pagination.value) return [];
                    
                    const totalPages = pagination.value.total_pages;
                    const current = currentTaskPage.value;
                    const pages = [];
                    
                    // ÊÄªÊòØÊòæÁ§∫Á¨¨‰∏ÄÈ°µ
                    pages.push(1);
                    
                    if (totalPages <= 5) {
                        // Â¶ÇÊûúÊÄªÈ°µÊï∞Â∞ë‰∫éÁ≠â‰∫é7È°µÔºåÊòæÁ§∫ÊâÄÊúâÈ°µÁ†Å
                        for (let i = 2; i <= totalPages - 1; i++) {
                            pages.push(i);
                        }
                    } else {
                        // Â¶ÇÊûúÊÄªÈ°µÊï∞Â§ß‰∫é7È°µÔºå‰ΩøÁî®ÁúÅÁï•Âè∑
                        if (current <= 3) {
                            // ÂΩìÂâçÈ°µÂú®Ââç4È°µ
                            for (let i = 2; i <= 3; i++) {
                                pages.push(i);
                            }
                            pages.push('...');
                        } else if (current >= totalPages - 2) {
                            // ÂΩìÂâçÈ°µÂú®Âêé4È°µ
                            pages.push('...');
                            for (let i = totalPages - 2; i <= totalPages - 1; i++) {
                                pages.push(i);
                            }
                        } else {
                            // ÂΩìÂâçÈ°µÂú®‰∏≠Èó¥
                            pages.push('...');
                            for (let i = current - 1; i <= current + 1; i++) {
                                pages.push(i);
                            }
                            pages.push('...');
                        }
                    }
                    
                    // ÊÄªÊòØÊòæÁ§∫ÊúÄÂêé‰∏ÄÈ°µÔºàÂ¶ÇÊûú‰∏çÊòØÁ¨¨‰∏ÄÈ°µÔºâ
                    if (totalPages > 1) {
                        pages.push(totalPages);
                    }
                    
                    return pages;
                };

                const getVisibleTemplatePages = () => {
                    if (!templatePagination.value) return [];

                    const totalPages = templatePagination.value.total_pages;
                    const current = templateCurrentPage.value;
                    const pages = [];

                    // ÊÄªÊòØÊòæÁ§∫Á¨¨‰∏ÄÈ°µ
                    pages.push(1);

                    if (totalPages <= 5) {
                        // Â¶ÇÊûúÊÄªÈ°µÊï∞Â∞ë‰∫éÁ≠â‰∫é7È°µÔºåÊòæÁ§∫ÊâÄÊúâÈ°µÁ†Å
                        for (let i = 2; i <= totalPages - 1; i++) {
                            pages.push(i);
                        }
                    } else {
                        // ÊòæÁ§∫ÂΩìÂâçÈ°µÈôÑËøëÁöÑÈ°µÁ†Å
                        const start = Math.max(2, current - 1);
                        const end = Math.min(totalPages - 1, current + 1);

                        if (start > 2) {
                            pages.push('...');
                        }

                        for (let i = start; i <= end; i++) {
                            if (i !== 1 && i !== totalPages) {
                                pages.push(i);
                            }
                        }

                        if (end < totalPages - 1) {
                            pages.push('...');
                        }
                    }

                    // ÊÄªÊòØÊòæÁ§∫ÊúÄÂêé‰∏ÄÈ°µ
                    if (totalPages > 1) {
                        pages.push(totalPages);
                    }

                    return pages;
                };

                // ÁÅµÊÑüÂπøÂú∫ÂàÜÈ°µÁõ∏ÂÖ≥ÂáΩÊï∞
                const goToInspirationPage = async (page) => {
                    if (page < 1 || page > inspirationPagination.value?.total_pages || page === inspirationCurrentPage.value) {
                        return;
                    }
                    inspirationCurrentPage.value = page;
                    inspirationPageInput.value = page; // ÂêåÊ≠•Êõ¥Êñ∞ËæìÂÖ•Ê°Ü
                    loadInspirationData();
                };

                const jumpToInspirationPage = async () => {
                    const page = parseInt(inspirationPageInput.value);
                    if (page && page >= 1 && page <= inspirationPagination.value?.total_pages && page !== inspirationCurrentPage.value) {
                        await goToInspirationPage(page);
                    } else {
                        // Â¶ÇÊûúËæìÂÖ•Êó†ÊïàÔºåÊÅ¢Â§çÂà∞ÂΩìÂâçÈ°µ
                        inspirationPageInput.value = inspirationCurrentPage.value;
                    }
                };

                const getVisibleInspirationPages = () => {
                    if (!inspirationPagination.value) return [];

                    const totalPages = inspirationPagination.value.total_pages;
                    const current = inspirationCurrentPage.value;
                    const pages = [];

                    // ÊÄªÊòØÊòæÁ§∫Á¨¨‰∏ÄÈ°µ
                    pages.push(1);

                    if (totalPages <= 5) {
                        // Â¶ÇÊûúÊÄªÈ°µÊï∞Â∞ë‰∫éÁ≠â‰∫é7È°µÔºåÊòæÁ§∫ÊâÄÊúâÈ°µÁ†Å
                        for (let i = 2; i <= totalPages - 1; i++) {
                            pages.push(i);
                        }
                    } else {
                        // ÊòæÁ§∫ÂΩìÂâçÈ°µÈôÑËøëÁöÑÈ°µÁ†Å
                        const start = Math.max(2, current - 1);
                        const end = Math.min(totalPages - 1, current + 1);

                        if (start > 2) {
                            pages.push('...');
                        }

                        for (let i = start; i <= end; i++) {
                            if (i !== 1 && i !== totalPages) {
                                pages.push(i);
                            }
                        }

                        if (end < totalPages - 1) {
                            pages.push('...');
                        }
                    }

                    // ÊÄªÊòØÊòæÁ§∫ÊúÄÂêé‰∏ÄÈ°µ
                    if (totalPages > 1) {
                        pages.push(totalPages);
                    }

                    return pages;
                };

                const getStatusBadgeClass = (status) => {
                    const statusMap = {
                        'SUCCEED': 'bg-success',
                        'FAILED': 'bg-danger',
                        'RUNNING': 'bg-warning',
                        'PENDING': 'bg-secondary',
                        'CREATED': 'bg-secondary'
                    };
                    return statusMap[status] || 'bg-secondary';
                };

                const downloadSingleResult = async (taskId, key, outputPath) => {
                    try {
                        downloadLoading.value = true;
                        const response = await apiCall(`./api/v1/task/result?task_id=${taskId}&name=${key}`);
                        if (response.ok) {
                            const blob = await response.blob();
                            const url = window.URL.createObjectURL(blob);
                            const a = document.createElement('a');
                            a.href = url;
                            // ‰ΩøÁî®ÂéüÂßãÊñá‰ª∂ÂêçÔºåÂ¶ÇÊûúÊ≤°ÊúâÂàô‰ΩøÁî®outputPath
                            const filename = key || outputPath || `result_${taskId}`;
                            a.download = filename;
                            document.body.appendChild(a);
                            a.click();
                            document.body.removeChild(a);
                            window.URL.revokeObjectURL(url);
                            showAlert(t('fileDownloadSuccessAlert'), 'success');
                        } else {
                            showAlert(t('getTaskResultFailedAlert'), 'danger');
                        }
                    } catch (error) {
                        showAlert(`${t('downloadTaskResultFailedAlert')}: ${error.message}`, 'danger');
                    } finally {
                        downloadLoading.value = false;
                    }
                };

                const viewSingleResult = async (taskId, key) => {
                    try {
                        downloadLoading.value = true;
                        const response = await apiCall(`./api/v1/task/result?task_id=${taskId}&name=${key}`);
                        if (response.ok) {
                            const blob = await response.blob();
                            const videoBlob = new Blob([blob], { type: 'video/mp4' });
                            const url = window.URL.createObjectURL(videoBlob);
                            window.open(url, '_blank');
                        } else {
                            showAlert(t('getTaskResultFailedAlert'), 'danger');
                        }
                    } catch (error) {
                        showAlert(`${t('viewTaskResultFailedAlert')}: ${error.message}`, 'danger');
                    } finally {
                        downloadLoading.value = false;
                    }
                };

                const cancelTask = async (taskId, fromDetailPage = false) => {
                    try {
                        // ÊòæÁ§∫Á°ÆËÆ§ÂØπËØùÊ°Ü
                        const confirmed = await showConfirmDialog({
                            title: t('cancelTaskConfirm'),
                            message: t('cancelTaskConfirmMessage'),
                            confirmText: t('confirmCancel'),
                        });
                        
                        if (!confirmed) {
                            return;
                        }

                        const response = await apiRequest(`./api/v1/task/cancel?task_id=${taskId}`);
                        if (response && response.ok) {
                            showAlert(t('taskCancelSuccessAlert'), 'success');
                            
                            // Â¶ÇÊûúÂΩìÂâçÂú®‰ªªÂä°ËØ¶ÊÉÖÁïåÈù¢ÔºåÂÖàÂà∑Êñ∞‰ªªÂä°ÂàóË°®ÔºåÁÑ∂ÂêéÈáçÊñ∞Ëé∑Âèñ‰ªªÂä°‰ø°ÊÅØ
                            if (fromDetailPage) {
                                refreshTasks(true); // Âº∫Âà∂Âà∑Êñ∞
                                const updatedTask = tasks.value.find(t => t.task_id === taskId);
                                if (updatedTask) {
                                    selectedTask.value = updatedTask;
                                }
                                await nextTick();
                            } else {
                                refreshTasks(true); // Âº∫Âà∂Âà∑Êñ∞
                            }
                                
                        } else if (response) {
                            const error = await response.json();
                            showAlert(`${t('cancelTaskFailedAlert')}: ${error.message}`, 'danger');
                        }
                        // Â¶ÇÊûúresponse‰∏∫nullÔºåËØ¥ÊòéÊòØËÆ§ËØÅÈîôËØØÔºåapiRequestÂ∑≤ÁªèÂ§ÑÁêÜ‰∫Ü
                    } catch (error) {
                        showAlert(`${t('cancelTaskFailedAlert')}: ${error.message}`, 'danger');
                    }
                };

                const resumeTask = async (taskId, fromDetailPage = false) => {
                    try {
                        const response = await apiRequest(`./api/v1/task/resume?task_id=${taskId}`);
                        if (response && response.ok) {
                            showAlert(t('taskRetrySuccessAlert'), 'success');
                            
                            // Â¶ÇÊûúÂΩìÂâçÂú®‰ªªÂä°ËØ¶ÊÉÖÁïåÈù¢ÔºåÂÖàÂà∑Êñ∞‰ªªÂä°ÂàóË°®ÔºåÁÑ∂ÂêéÈáçÊñ∞Ëé∑Âèñ‰ªªÂä°‰ø°ÊÅØ
                            if (fromDetailPage) {
                                refreshTasks(true); // Âº∫Âà∂Âà∑Êñ∞
                                const updatedTask = tasks.value.find(t => t.task_id === taskId);
                                if (updatedTask) {
                                    selectedTask.value = updatedTask;
                                }
                                startPollingTask(taskId);
                                await nextTick();
                            } else {
                                refreshTasks(true); // Âº∫Âà∂Âà∑Êñ∞
                                
                                // ÂºÄÂßãËΩÆËØ¢Êñ∞Êèê‰∫§ÁöÑ‰ªªÂä°Áä∂ÊÄÅ
                                startPollingTask(taskId);
                            }
                        } else if (response) {
                            const error = await response.json();
                            showAlert(`${t('retryTaskFailedAlert')}: ${error.message}`, 'danger');
                        }
                        // Â¶ÇÊûúresponse‰∏∫nullÔºåËØ¥ÊòéÊòØËÆ§ËØÅÈîôËØØÔºåapiRequestÂ∑≤ÁªèÂ§ÑÁêÜ‰∫Ü
                    } catch (error) {
                        showAlert(`${t('retryTaskFailedAlert')}: ${error.message}`, 'danger');
                    }
                };

                // ÂàáÊç¢‰ªªÂä°ËèúÂçïÊòæÁ§∫Áä∂ÊÄÅ
                const toggleTaskMenu = (taskId) => {
                    // ÂÖàÂÖ≥Èó≠ÊâÄÊúâÂÖ∂‰ªñËèúÂçï
                    closeAllTaskMenus();
                    // ÁÑ∂ÂêéÊâìÂºÄÂΩìÂâçËèúÂçï
                    taskMenuVisible.value[taskId] = true;
                };

                // ÂÖ≥Èó≠ÊâÄÊúâ‰ªªÂä°ËèúÂçï
                const closeAllTaskMenus = () => {
                    taskMenuVisible.value = {};
                };

                // ÁÇπÂáªÂ§ñÈÉ®ÂÖ≥Èó≠ËèúÂçï
                const handleClickOutside = (event) => {
                    if (!event.target.closest('.task-menu-container')) {
                        closeAllTaskMenus();
                    }
                    if (!event.target.closest('.language-switcher')) {
                        showLanguageMenu.value = false;
                    }
                    if (!event.target.closest('.task-type-dropdown')) {
                        showTaskTypeMenu.value = false;
                    }
                    if (!event.target.closest('.model-dropdown')) {
                        showModelMenu.value = false;
                    }
                };

                const deleteTask = async (taskId, fromDetailPage = false) => {
                    try {
                        // ÊòæÁ§∫Á°ÆËÆ§ÂØπËØùÊ°Ü
                        const confirmed = await showConfirmDialog({
                            title: t('deleteTaskConfirm'),
                            message: t('deleteTaskConfirmMessage'),
                            confirmText: t('confirmDelete')
                        });
                        
                        if (!confirmed) {
                            return;
                        }

                        // ÊòæÁ§∫Âà†Èô§‰∏≠ÁöÑÊèêÁ§∫
                        showAlert(t('deletingTaskAlert'), 'info');

                        const response = await apiRequest(`./api/v1/task/delete?task_id=${taskId}`, {
                            method: 'DELETE'
                        });
                        
                        if (response && response.ok) {
                            showAlert(t('taskDeletedSuccessAlert'), 'success');
                            refreshTasks(true); // Âº∫Âà∂Âà∑Êñ∞
                            
                            // Â¶ÇÊûúÊòØ‰ªé‰ªªÂä°ËØ¶ÊÉÖÈ°µÂà†Èô§ÔºåÂàôË∑≥ËΩ¨Âõû‰∏ªÈ°µ
                            if (fromDetailPage) {
                                if (!selectedTaskId.value) {
                                    if (availableTaskTypes.value.includes('s2v')) {
                                        selectTask('s2v');
                                    }
                                }
                            }
                        } else if (response) {
                            const error = await response.json();
                            showAlert(`${t('deleteTaskFailedAlert')}: ${error.message}`, 'danger');
                        }
                        // Â¶ÇÊûúresponse‰∏∫nullÔºåËØ¥ÊòéÊòØËÆ§ËØÅÈîôËØØÔºåapiRequestÂ∑≤ÁªèÂ§ÑÁêÜ‰∫Ü
                    } catch (error) {
                        showAlert(`${t('deleteTaskFailedAlert')}: ${error.message}`, 'danger');
                    }
                };



                const loadTaskFiles = async (taskId) => {
                    try {
                        loadingTaskFiles.value = true;

                        // ÈÄöËøáAPIËé∑Âèñ‰ªªÂä°ËØ¶ÊÉÖ
                        const response = await apiRequest(`./api/v1/task/query?task_id=${taskId}`);
                        if (!response || !response.ok) {
                            showAlert(t('getTaskDetailFailedAlert'), 'danger');
                            return;
                        }

                        const task = await response.json();
                        if (!task) {
                            showAlert(t('taskNotExistAlert'), 'danger');
                            return;
                        }

                        const files = { inputs: {}, outputs: {} };

                        // Ëé∑ÂèñËæìÂÖ•Êñá‰ª∂ÔºàÊâÄÊúâÁä∂ÊÄÅÁöÑ‰ªªÂä°ÈÉΩÈúÄË¶ÅÔºâ
                        if (task.inputs) {
                            for (const [key, inputPath] of Object.entries(task.inputs)) {
                                try {
                                    const response = await apiRequest(`./api/v1/task/input?task_id=${taskId}&name=${key}`);
                                    if (response && response.ok) {
                                        const blob = await response.blob();
                                        files.inputs[key] = {
                                            name: inputPath, // ‰ΩøÁî®ÂéüÂßãÊñá‰ª∂ÂêçËÄå‰∏çÊòØkey
                                            path: inputPath,
                                            blob: blob,
                                            url: URL.createObjectURL(blob)
                                        };
                                    }
                                } catch (error) {
                                    console.error(`Failed to load input ${key}:`, error);
                                    files.inputs[key] = {
                                        name: inputPath, // ‰ΩøÁî®ÂéüÂßãÊñá‰ª∂ÂêçËÄå‰∏çÊòØkey
                                        path: inputPath,
                                        error: true
                                    };
                                }
                            }
                        }

                        // Âè™ÂØπÊàêÂäüÂÆåÊàêÁöÑ‰ªªÂä°Ëé∑ÂèñËæìÂá∫Êñá‰ª∂
                        if (task.status === 'SUCCEED' && task.outputs) {
                            for (const [key, outputPath] of Object.entries(task.outputs)) {
                                try {
                                    const response = await apiRequest(`./api/v1/task/result?task_id=${taskId}&name=${key}`);
                                    if (response && response.ok) {
                                        const blob = await response.blob();
                                        files.outputs[key] = {
                                            name: outputPath, // ‰ΩøÁî®ÂéüÂßãÊñá‰ª∂ÂêçËÄå‰∏çÊòØkey
                                            path: outputPath,
                                            blob: blob,
                                            url: URL.createObjectURL(blob)
                                        };
                                    }
                                } catch (error) {
                                    console.error(`Failed to load output ${key}:`, error);
                                    files.outputs[key] = {
                                        name: outputPath, // ‰ΩøÁî®ÂéüÂßãÊñá‰ª∂ÂêçËÄå‰∏çÊòØkey
                                        path: outputPath,
                                        error: true
                                    };
                                }
                            }
                        }

                        selectedTaskFiles.value = files;

                    } catch (error) {
                        console.error('Failed to load task files:', error);
                        showAlert(t('loadTaskFilesFailedAlert'), 'danger');
                    } finally {
                        loadingTaskFiles.value = false;
                    }
                };

                const viewTaskDetail = async (task) => {
                    selectedTask.value = task;
                    selectedTaskId.value = task.task_type;

                    try {
                    const response = await apiRequest(`./api/v1/task/query?task_id=${task.task_id}`);
                        if (response && response.ok) {
                            const updatedTask = await response.json();
                            selectedTask.value = updatedTask;
                            console.log('updated task data:', updatedTask);
                            await nextTick();
                        }
                    } catch (error) {
                        console.warn('Failed to fetch updated task data:', error);
                    }
                    // Â¶ÇÊûú‰ªªÂä°ËøòÂú®ËøõË°å‰∏≠ÔºåÂºÄÂßãËΩÆËØ¢Áä∂ÊÄÅ
                    if (['CREATED', 'PENDING', 'RUNNING'].includes(task.status)) {

                        startPollingTask(task.task_id);
                    }

                    // ‰∏ÄÊ¨°ÊÄßÂä†ËΩΩÊâÄÊúâ‰ªªÂä°Êñá‰ª∂
                    await loadTaskFiles(task.task_id);
                };

                const reuseTask = async (task) => {
                    try {
                        // Ë∑≥ËΩ¨Âà∞‰ªªÂä°ÂàõÂª∫ÁïåÈù¢
                        isCreationAreaExpanded.value=true
                        switchToCreateView();
                        
                        // ËÆæÁΩÆ‰ªªÂä°Á±ªÂûã
                        selectedTaskId.value = task.task_type;
                        console.log('selectedTaskId.value', selectedTaskId.value);
                        
                        // Ëé∑ÂèñÂΩìÂâçË°®Âçï
                        const currentForm = getCurrentForm();
                        
                        // ËÆæÁΩÆÊ®°Âûã
                        if (task.params && task.params.model_cls) {
                            currentForm.model_cls = task.params.model_cls;
                        }
                        
                        // ËÆæÁΩÆprompt
                        if (task.params && task.params.prompt) {
                            currentForm.prompt = task.params.prompt;
                        }
                        
                        // Â∞ùËØï‰ªélocalStorageËé∑Âèñ‰ªªÂä°ÂéÜÂè≤Êï∞ÊçÆ
                        const taskHistory = JSON.parse(localStorage.getItem('taskHistory') || '[]');
                        const historyItem = taskHistory.find(item => item.task_id === task.task_id);
                        
                        if (historyItem) {
                            // ‰ªélocalStorageÊÅ¢Â§çÂõæÁâáÂíåÈü≥È¢ë
                            if (historyItem.imageFile && historyItem.imageFile.blob) {
                                // ÈáçÊñ∞ÂàõÂª∫FileÂØπË±°
                                const imageFile = new File([historyItem.imageFile.blob], historyItem.imageFile.name, { type: historyItem.imageFile.type });
                                currentForm.imageFile = imageFile;
                                setCurrentImagePreview(URL.createObjectURL(imageFile));
                            }
                            
                            if (historyItem.audioFile && historyItem.audioFile.blob) {
                                // ÈáçÊñ∞ÂàõÂª∫FileÂØπË±°
                                let mimeType = historyItem.audioFile.type;
                                if (!mimeType || mimeType === 'application/octet-stream') {
                                    const filename = historyItem.audioFile.name || 'audio.wav';
                                    const ext = filename.toLowerCase().split('.').pop();
                                    const mimeTypes = {
                                        'mp3': 'audio/mpeg',
                                        'wav': 'audio/wav',
                                        'mp4': 'audio/mp4',
                                        'aac': 'audio/aac',
                                        'ogg': 'audio/ogg',
                                        'm4a': 'audio/mp4'
                                    };
                                    mimeType = mimeTypes[ext] || 'audio/mpeg';
                                }
                                const audioFile = new File([historyItem.audioFile.blob], historyItem.audioFile.name, { type: mimeType });
                                currentForm.audioFile = audioFile;
                                console.log('Â§çÁî®‰ªªÂä° - ‰ªélocalStorageÊÅ¢Â§çÈü≥È¢ëÊñá‰ª∂:', {
                                    name: audioFile.name,
                                    type: audioFile.type,
                                    size: audioFile.size
                                });
                                // ‰ΩøÁî®FileReaderÁîüÊàêdata URLÔºå‰∏éÊ≠£Â∏∏‰∏ä‰º†‰øùÊåÅ‰∏ÄËá¥
                                const reader = new FileReader();
                                reader.onload = (e) => {
                                    setCurrentAudioPreview(e.target.result);
                                    console.log('Â§çÁî®‰ªªÂä° - Èü≥È¢ëÈ¢ÑËßàÂ∑≤ËÆæÁΩÆ:', e.target.result.substring(0, 50) + '...');
                                };
                                reader.readAsDataURL(audioFile);
                            }
                        } else {
                            // Â¶ÇÊûúlocalStorage‰∏≠Ê≤°ÊúâÔºåÂ∞ùËØï‰ªéÂêéÁ´ØËé∑Âèñ‰ªªÂä°Êñá‰ª∂
                            try {
                                // ‰ΩøÁî®Áé∞ÊúâÁöÑÂáΩÊï∞Ëé∑ÂèñÂõæÁâáÂíåÈü≥È¢ëURL
                                const imageUrl = await getTaskInputImage(task);
                                const audioUrl = await getTaskInputAudio(task);
                                
                                // Âä†ËΩΩÂõæÁâáÊñá‰ª∂
                                if (imageUrl) {
                                    try {
                                        const imageResponse = await apiRequest(imageUrl);
                                        if (imageResponse && imageResponse.ok) {
                                            const blob = await imageResponse.blob();
                                            const filename = task.inputs[Object.keys(task.inputs).find(key => 
                                                key.includes('image') || 
                                                task.inputs[key].toString().toLowerCase().match(/\.(jpg|jpeg|png|gif|bmp|webp)$/)
                                            )] || 'image.jpg';
                                            const file = new File([blob], filename, { type: blob.type });
                                            currentForm.imageFile = file;
                                            setCurrentImagePreview(URL.createObjectURL(file));
                                        }
                                    } catch (error) {
                                        console.warn('Failed to load image file:', error);
                                    }
                                }
                                
                                // Âä†ËΩΩÈü≥È¢ëÊñá‰ª∂
                                if (audioUrl) {
                                    try {
                                        const audioResponse = await apiRequest(audioUrl);
                                        if (audioResponse && audioResponse.ok) {
                                            const blob = await audioResponse.blob();
                                            const filename = task.inputs[Object.keys(task.inputs).find(key => 
                                                key.includes('audio') || 
                                                task.inputs[key].toString().toLowerCase().match(/\.(mp3|wav|mp4|aac|ogg|m4a)$/)
                                            )] || 'audio.wav';
                                            
                                            // Ê†πÊçÆÊñá‰ª∂Êâ©Â±ïÂêçÁ°ÆÂÆöÊ≠£Á°ÆÁöÑMIMEÁ±ªÂûã
                                            let mimeType = blob.type;
                                            if (!mimeType || mimeType === 'application/octet-stream') {
                                                const ext = filename.toLowerCase().split('.').pop();
                                                const mimeTypes = {
                                                    'mp3': 'audio/mpeg',
                                                    'wav': 'audio/wav',
                                                    'mp4': 'audio/mp4',
                                                    'aac': 'audio/aac',
                                                    'ogg': 'audio/ogg',
                                                    'm4a': 'audio/mp4'
                                                };
                                                mimeType = mimeTypes[ext] || 'audio/mpeg';
                                            }
                                            
                                            const file = new File([blob], filename, { type: mimeType });
                                            currentForm.audioFile = file;
                                            console.log('Â§çÁî®‰ªªÂä° - ‰ªéÂêéÁ´ØÂä†ËΩΩÈü≥È¢ëÊñá‰ª∂:', {
                                                name: file.name,
                                                type: file.type,
                                                size: file.size,
                                                originalBlobType: blob.type
                                            });
                                            // ‰ΩøÁî®FileReaderÁîüÊàêdata URLÔºå‰∏éÊ≠£Â∏∏‰∏ä‰º†‰øùÊåÅ‰∏ÄËá¥
                                            const reader = new FileReader();
                                            reader.onload = (e) => {
                                                setCurrentAudioPreview(e.target.result);
                                                console.log('Â§çÁî®‰ªªÂä° - Èü≥È¢ëÈ¢ÑËßàÂ∑≤ËÆæÁΩÆ:', e.target.result.substring(0, 50) + '...');
                                            };
                                            reader.readAsDataURL(file);
                                        }
                                        
                                    } catch (error) {
                                        console.warn('Failed to load audio file:', error);
                                    }
                                }
                            } catch (error) {
                                console.warn('Failed to load task data from backend:', error);
                            }
                        }
                        
                        showAlert(t('taskMaterialReuseSuccessAlert'), 'success');
                        
                    } catch (error) {
                        console.error('Failed to reuse task:', error);
                        showAlert(t('loadTaskDataFailedAlert'), 'danger');
                    }
                };

                const downloadFile = (fileInfo) => {
                    if (!fileInfo || !fileInfo.blob) {
                        showAlert(t('fileUnavailableAlert'), 'danger');
                        return;
                    }

                    try {
                        const url = URL.createObjectURL(fileInfo.blob);
                        const a = document.createElement('a');
                        a.href = url;
                        a.download = fileInfo.name || 'download';
                        document.body.appendChild(a);
                        a.click();
                        document.body.removeChild(a);
                        URL.revokeObjectURL(url);
                    } catch (error) {
                        console.error('Download failed:', error);
                        showAlert(t('downloadFailedAlert'), 'danger');
                    }
                };

                const viewFile = (fileInfo) => {
                    if (!fileInfo || !fileInfo.url) {
                        showAlert(t('fileUnavailableAlert'), 'danger');
                        return;
                    }

                    // Âú®Êñ∞Á™óÂè£‰∏≠ÊâìÂºÄÊñá‰ª∂
                    window.open(fileInfo.url, '_blank');
                };

                const clearTaskFiles = () => {
                    // Ê∏ÖÁêÜ URL ÂØπË±°ÔºåÈáäÊîæÂÜÖÂ≠ò
                    Object.values(selectedTaskFiles.value.inputs).forEach(file => {
                        if (file.url) {
                            URL.revokeObjectURL(file.url);
                        }
                    });
                    Object.values(selectedTaskFiles.value.outputs).forEach(file => {
                        if (file.url) {
                            URL.revokeObjectURL(file.url);
                        }
                    });
                    selectedTaskFiles.value = { inputs: {}, outputs: {} };
                };

                const showTaskCreator = () => {
                    selectedTask.value = null;
                    // clearTaskFiles(); // Ê∏ÖÁ©∫Êñá‰ª∂ÁºìÂ≠ò
                    selectedTaskId.value = 's2v'; // ÈªòËÆ§ÈÄâÊã©Êï∞Â≠ó‰∫∫‰ªªÂä°
                    
                    // ÂÅúÊ≠¢ÊâÄÊúâ‰ªªÂä°Áä∂ÊÄÅËΩÆËØ¢
                    pollingTasks.value.clear();
                    if (pollingInterval.value) {
                        clearInterval(pollingInterval.value);
                        pollingInterval.value = null;
                    }
                };

                const toggleSidebar = () => {
                    sidebarCollapsed.value = !sidebarCollapsed.value;
                    
                    if (sidebarCollapsed.value) {
                        // Êî∂Ëµ∑Êó∂ÔºåÂ∞ÜÂéÜÂè≤‰ªªÂä°Ê†èÈöêËóèÂà∞Â±èÂπïÂ∑¶‰æß
                        if (sidebar.value) {
                            sidebar.value.style.transform = 'translateX(-100%)';
                        }
                    } else {
                        // Â±ïÂºÄÊó∂ÔºåÊÅ¢Â§çÂéÜÂè≤‰ªªÂä°Ê†è‰ΩçÁΩÆ
                        if (sidebar.value) {
                            sidebar.value.style.transform = 'translateX(0)';
                        }
                    }
                    
                    // Êõ¥Êñ∞ÊÇ¨ÊµÆÊåâÈíÆ‰ΩçÁΩÆ
                    updateFloatingButtonPosition(sidebarWidth.value);
                };

                const clearPrompt = () => {
                    getCurrentForm().prompt = '';
                    updateUploadedContentStatus();
                };

                const getTaskItemClass = (status) => {
                    if (status === 'SUCCEED') return 'bg-laser-purple/15 border border-laser-purple/30';
                    if (status === 'RUNNING') return 'bg-laser-purple/15 border border-laser-purple/30';
                    if (status === 'FAILED') return 'bg-red-500/15 border border-red-500/30';
                    return 'bg-dark-light border border-gray-700';
                };

                const getStatusIndicatorClass = (status) => {
                const base = 'inline-block w-2 aspect-square rounded-full shrink-0 align-middle';
                    if (status === 'SUCCEED')
                        return `${base} bg-gradient-to-r from-emerald-200 to-green-300 shadow-md shadow-emerald-300/30`;
                    if (status === 'RUNNING')
                        return `${base} bg-gradient-to-r from-amber-200 to-yellow-300 shadow-md shadow-amber-300/30 animate-pulse`;
                    if (status === 'FAILED')
                        return `${base} bg-gradient-to-r from-red-200 to-pink-300 shadow-md shadow-red-300/30`;
                    return `${base} bg-gradient-to-r from-gray-200 to-gray-300 shadow-md shadow-gray-300/30`;
                    };


                const getTaskTypeBtnClass = (taskType) => {
                    if (selectedTaskId.value === taskType) {
                        return 'text-gradient-icon border-b-2 border-laser-purple';
                    }
                    return 'text-gray-400 hover:text-gradient-icon';
                };

                const getModelBtnClass = (model) => {
                    if (getCurrentForm().model_cls === model) {
                        return 'bg-laser-purple/20 border border-laser-purple/40 active shadow-laser';
                    }
                    return 'bg-dark-light border border-gray-700 hover:bg-laser-purple/15 hover:border-laser-purple/40 transition-all hover:shadow-laser';
                };

                const getTaskTypeIcon = (taskType) => {
                    const iconMap = {
                        't2v': 'fas fa-font',
                        'i2v': 'fas fa-image',
                        's2v': 'fas fa-user'
                    };
                    return iconMap[taskType] || 'fas fa-video';
                };

                const getTaskTypeName = (task) => {
                    // Â¶ÇÊûú‰º†ÂÖ•ÁöÑÊòØÂ≠óÁ¨¶‰∏≤ÔºåÁõ¥Êé•ËøîÂõûÊò†Â∞Ñ
                    if (typeof task === 'string') {
                        return nameMap.value[task] || task;
                    }

                    // Â¶ÇÊûú‰º†ÂÖ•ÁöÑÊòØ‰ªªÂä°ÂØπË±°ÔºåÊ†πÊçÆÊ®°ÂûãÁ±ªÂûãÂà§Êñ≠
                    if (task && task.model_cls) {
                        const modelCls = task.model_cls.toLowerCase();

                        return nameMap.value[task.task_type] || task.task_type;
                    }

                    // ÈªòËÆ§ËøîÂõûtask_type
                    return task.task_type || 'Êú™Áü•';
                };

                const getPromptPlaceholder = () => {
                    if (selectedTaskId.value === 't2v') {
                        return t('pleaseEnterThePromptForVideoGeneration') + 'Ôºå'+ t('describeTheContentStyleSceneOfTheVideo');
                    } else if (selectedTaskId.value === 'i2v') {
                        return t('pleaseEnterThePromptForVideoGeneration') + 'Ôºå'+ t('describeTheContentActionRequirementsBasedOnTheImage');
                    } else if (selectedTaskId.value === 's2v') {
                        return t('pleaseEnterThePromptForVideoGeneration') + 'Ôºå'+ t('describeTheDigitalHumanImageBackgroundStyleActionRequirements');
                    }
                    return t('pleaseEnterThePromptForVideoGeneration') + '...';
                };

                const getStatusTextClass = (status) => {
                    if (status === 'SUCCEED') return 'text-emerald-400';
                    if (status === 'CREATED') return 'text-blue-400';
                    if (status === 'PENDING') return 'text-yellow-400';
                    if (status === 'RUNNING') return 'text-amber-400';
                    if (status === 'FAILED') return 'text-red-400';
                    if (status === 'CANCEL') return 'text-gray-400';
                    return 'text-gray-400';
                };



                const getImagePreview = (base64Data) => {
                    if (!base64Data) return '';
                    return `data:image/jpeg;base64,${base64Data}`;
                };

                const getTaskInputUrl = async (taskId, key) => {
                    // ‰ºòÂÖà‰ªéÁºìÂ≠òËé∑Âèñ
                    const cachedUrl = getTaskFileUrlSync(taskId, key);
                    if (cachedUrl) {
                        console.log('getTaskInputUrl: ‰ªéÁºìÂ≠òËé∑Âèñ', { taskId, key, url: cachedUrl });
                        return cachedUrl;
                    }
                    // ÁºìÂ≠òÊ≤°ÊúâÂàôÁîüÊàêURLÂπ∂ÁºìÂ≠ò
                    const token = localStorage.getItem('accessToken');
                    const url = token 
                        ? `./api/v1/task/input?task_id=${taskId}&name=${key}&token=${encodeURIComponent(token)}`
                        : `./api/v1/task/input?task_id=${taskId}&name=${key}`;
                    
                    // ÁºìÂ≠òAPI URL
                    setTaskFileToCache(taskId, key, {
                        url: url,
                        timestamp: Date.now()
                    });
                    
                    console.log('getTaskInputUrl: ÁîüÊàêÂπ∂ÁºìÂ≠òËæìÂÖ•URL', { taskId, key, url });
                    return url;
                };

                const getTaskInputImage = async (task) => {
                    
                    if (!task || !task.inputs) {
                        console.log('getTaskInputImage: ‰ªªÂä°ÊàñËæìÂÖ•‰∏∫Á©∫', { task: task?.task_id, inputs: task?.inputs });
                        return null;
                    }
                    
                    const imageInputs = Object.keys(task.inputs).filter(key =>
                        key.includes('image') ||
                        task.inputs[key].toString().toLowerCase().match(/\.(jpg|jpeg|png|gif|bmp|webp)$/)
                    );


                    if (imageInputs.length > 0) {
                        const firstImageKey = imageInputs[0];
                        // ‰ºòÂÖà‰ªéÁºìÂ≠òËé∑Âèñ
                        const cachedUrl = getTaskFileUrlSync(task.task_id, firstImageKey);
                        if (cachedUrl) {
                            console.log('getTaskInputImage: ‰ªéÁºìÂ≠òËé∑Âèñ', { taskId: task.task_id, key: firstImageKey, url: cachedUrl });
                            return cachedUrl;
                        }
                        // ÁºìÂ≠òÊ≤°ÊúâÂàôÁîüÊàêURL
                        const url = await getTaskInputUrl(task.task_id, firstImageKey);
                        console.log('getTaskInputImage: ÁîüÊàêURL', { taskId: task.task_id, key: firstImageKey, url });
                        return url;
                    }

                    console.log('getTaskInputImage: Ê≤°ÊúâÊâæÂà∞ÂõæÁâáËæìÂÖ•');
                    return null;
                };

                const getTaskInputAudio = async (task) => {
                    if (!task || !task.inputs) return null;
                    const audioInputs = Object.keys(task.inputs).filter(key =>
                        key.includes('audio') ||
                        task.inputs[key].toString().toLowerCase().match(/\.(mp3|wav|mp4|aac|ogg|m4a)$/)
                    );

                    if (audioInputs.length > 0) {
                        const firstAudioKey = audioInputs[0];
                        return await getTaskInputUrl(task.task_id, firstAudioKey);
                    }

                    return null;
                };


                const handleThumbnailError = (event) => {
                    // ÂΩìËæìÂÖ•ÂõæÁâáÂä†ËΩΩÂ§±Ë¥•Êó∂ÔºåÊòæÁ§∫ÈªòËÆ§ÂõæÊ†á
                    const img = event.target;
                    const parent = img.parentElement;
                    parent.innerHTML = '<div class="w-full h-full bg-laser-purple/20 flex items-center justify-center"><i class="fas fa-video text-gradient-icon text-xl"></i></div>';
                };

                const handleImageError = (event) => {
                    // ÂΩìÂõæÁâáÂä†ËΩΩÂ§±Ë¥•Êó∂ÔºåÈöêËóèÂõæÁâáÔºåÊòæÁ§∫Êñá‰ª∂Âêç
                    const img = event.target;
                    img.style.display = 'none';
                    // Êñá‰ª∂ÂêçÂ∑≤ÁªèÊòæÁ§∫Ôºå‰∏çÈúÄË¶ÅÈ¢ùÂ§ñÂ§ÑÁêÜ
                };

                const handleImageLoad = (event) => {
                    // ÂΩìÂõæÁâáÂä†ËΩΩÊàêÂäüÊó∂ÔºåÊòæÁ§∫ÂõæÁâáÂíå‰∏ãËΩΩÊåâÈíÆÔºåÈöêËóèÊñá‰ª∂Âêç
                    const img = event.target;
                    img.style.display = 'block';
                    // ÊòæÁ§∫‰∏ãËΩΩÊåâÈíÆ
                    const downloadBtn = img.parentElement.querySelector('button');
                    if (downloadBtn) {
                        downloadBtn.style.display = 'block';
                    }
                    // ÈöêËóèÊñá‰ª∂Âêçspan
                    const span = img.parentElement.parentElement.querySelector('span');
                    if (span) {
                        span.style.display = 'none';
                    }
                };

                const handleAudioError = (event) => {
                    // ÂΩìÈü≥È¢ëÂä†ËΩΩÂ§±Ë¥•Êó∂ÔºåÈöêËóèÈü≥È¢ëÊéß‰ª∂Âíå‰∏ãËΩΩÊåâÈíÆÔºåÊòæÁ§∫Êñá‰ª∂Âêç
                    const audio = event.target;
                    audio.style.display = 'none';
                    // ÈöêËóè‰∏ãËΩΩÊåâÈíÆ
                    const downloadBtn = audio.parentElement.querySelector('button');
                    if (downloadBtn) {
                        downloadBtn.style.display = 'none';
                    }
                    // Êñá‰ª∂ÂêçÂ∑≤ÁªèÊòæÁ§∫Ôºå‰∏çÈúÄË¶ÅÈ¢ùÂ§ñÂ§ÑÁêÜ
                };

                const handleAudioLoad = (event) => {
                    // ÂΩìÈü≥È¢ëÂä†ËΩΩÊàêÂäüÊó∂ÔºåÊòæÁ§∫Èü≥È¢ëÊéß‰ª∂Âíå‰∏ãËΩΩÊåâÈíÆÔºåÈöêËóèÊñá‰ª∂Âêç
                    const audio = event.target;
                    audio.style.display = 'block';
                    // ÊòæÁ§∫‰∏ãËΩΩÊåâÈíÆ
                    const downloadBtn = audio.parentElement.querySelector('button');
                    if (downloadBtn) {
                        downloadBtn.style.display = 'block';
                    }
                    // ÈöêËóèÊñá‰ª∂Âêçspan
                    const span = audio.parentElement.parentElement.querySelector('span');
                    if (span) {
                        span.style.display = 'none';
                    }
                };


                const downloadTaskInput = async (taskId, inputName, fileName) => {
                    try {
                        const url = await getTaskInputUrl(taskId, inputName);
                        const response = await apiRequest(url);

                        if (!response || !response.ok) {
                            throw new Error(`‰∏ãËΩΩÂ§±Ë¥•: ${response ? response.status : 'ËÆ§ËØÅÂ§±Ë¥•'}`);
                        }

                        const blob = await response.blob();
                        const downloadUrl = window.URL.createObjectURL(blob);

                        // ÂàõÂª∫‰∏ãËΩΩÈìæÊé•
                        const link = document.createElement('a');
                        link.href = downloadUrl;
                        // ‰ΩøÁî®ÂéüÂßãÊñá‰ª∂ÂêçÔºåÂ¶ÇÊûúÊ≤°ÊúâÂàô‰ΩøÁî®inputName
                        const filename = inputName || fileName || `input_${taskId}`;
                        link.download = filename;
                        document.body.appendChild(link);
                        link.click();

                        // Ê∏ÖÁêÜ
                        document.body.removeChild(link);
                        window.URL.revokeObjectURL(downloadUrl);

                        showAlert(t('fileDownloadSuccessAlert'), 'success');
                    } catch (error) {
                        console.error(t('downloadFailedAlert'), error);
                        showAlert(`${t('downloadFailedAlert')}: ${error.message}`, 'danger');
                    }
                };

                // ÁõëÂê¨currentPageÂèòÂåñÔºåÂêåÊ≠•Êõ¥Êñ∞pageInput
                watch(currentTaskPage, (newPage) => {
                    taskPageInput.value = newPage;
                });

                // ÁõëÂê¨paginationÂèòÂåñÔºåÁ°Æ‰øùÂàÜÈ°µÁªÑ‰ª∂Êõ¥Êñ∞
                watch(pagination, (newPagination) => {
                    console.log('paginationÂèòÂåñ:', newPagination);
                    if (newPagination && newPagination.total_pages) {
                        // Á°Æ‰øùÂΩìÂâçÈ°µ‰∏çË∂ÖËøáÊÄªÈ°µÊï∞
                        if (currentTaskPage.value > newPagination.total_pages) {
                            currentTaskPage.value = newPagination.total_pages;
                        }
                    }
                }, { deep: true });

                // ÁõëÂê¨templateCurrentPageÂèòÂåñÔºåÂêåÊ≠•Êõ¥Êñ∞templatePageInput
                watch(templateCurrentPage, (newPage) => {
                    templatePageInput.value = newPage;
                });

                // ÁõëÂê¨templatePaginationÂèòÂåñÔºåÁ°Æ‰øùÂàÜÈ°µÁªÑ‰ª∂Êõ¥Êñ∞
                watch(templatePagination, (newPagination) => {
                    console.log('templatePaginationÂèòÂåñ:', newPagination);
                    if (newPagination && newPagination.total_pages) {
                        // Á°Æ‰øùÂΩìÂâçÈ°µ‰∏çË∂ÖËøáÊÄªÈ°µÊï∞
                        if (templateCurrentPage.value > newPagination.total_pages) {
                            templateCurrentPage.value = newPagination.total_pages;
                        }
                    }
                }, { deep: true });

                // ÁõëÂê¨inspirationCurrentPageÂèòÂåñÔºåÂêåÊ≠•Êõ¥Êñ∞inspirationPageInput
                watch(inspirationCurrentPage, (newPage) => {
                    inspirationPageInput.value = newPage;
                });

                // ÁõëÂê¨inspirationPaginationÂèòÂåñÔºåÁ°Æ‰øùÂàÜÈ°µÁªÑ‰ª∂Êõ¥Êñ∞
                watch(inspirationPagination, (newPagination) => {
                    console.log('inspirationPaginationÂèòÂåñ:', newPagination);
                    if (newPagination && newPagination.total_pages) {
                        // Á°Æ‰øùÂΩìÂâçÈ°µ‰∏çË∂ÖËøáÊÄªÈ°µÊï∞
                        if (inspirationCurrentPage.value > newPagination.total_pages) {
                            inspirationCurrentPage.value = newPagination.total_pages;
                        }
                    }
                }, { deep: true });

                // Áªü‰∏ÄÁöÑÂàùÂßãÂåñÂáΩÊï∞
                const init = async () => {
                    try {
                        // 1. Âä†ËΩΩÊ®°ÂûãÂíå‰ªªÂä°Êï∞ÊçÆ
                        await loadModels();
                        
                        // 3. ÈÄâÊã©‰ªªÂä°Á±ªÂûãÔºà‰ºòÂÖàÈÄâÊã©Êï∞Â≠ó‰∫∫‰ªªÂä°Ôºâ
                        let selectedTaskType = null;
                        if (availableTaskTypes.value.includes('s2v')) {
                            selectedTaskType = 's2v';
                        } else if (availableTaskTypes.value.length > 0) {
                            selectedTaskType = availableTaskTypes.value[0];
                        }
                        
                        if (selectedTaskType) {
                            selectTask(selectedTaskType);
                            
                            // 4. ‰∏∫ÈÄâ‰∏≠ÁöÑ‰ªªÂä°Á±ªÂûãÈÄâÊã©Á¨¨‰∏Ä‰∏™Ê®°Âûã
                            const currentForm = getCurrentForm();
                            if (!currentForm.model_cls && availableModelClasses.value.length > 0) {
                                selectModel(availableModelClasses.value[0]);
                            }
                        }

                        // 2. Âä†ËΩΩÂéÜÂè≤ËÆ∞ÂΩïÂíåÁ¥†ÊùêÂ∫ì
                        refreshTasks(true);
                        loadInspirationData(true);
                        
                        // 3. Âä†ËΩΩÂéÜÂè≤ËÆ∞ÂΩïÂíåÁ¥†ÊùêÂ∫ìÊñá‰ª∂
                        getPromptHistory();
                        loadTaskFilesFromCache();
                        loadTemplateFilesFromCache();
                        loadImageAudioTemplates(true);
                        
                        console.log('ÂàùÂßãÂåñÂÆåÊàê:', {
                            currentUser: currentUser.value,
                            availableModels: models.value,
                            tasks: tasks.value,
                            inspirationItems: inspirationItems.value,
                            selectedTaskType: selectedTaskType,
                            selectedModel: getCurrentForm().model_cls
                        });
                        
                    } catch (error) {
                        console.error('ÂàùÂßãÂåñÂ§±Ë¥•:', error);
                        showAlert('ÂàùÂßãÂåñÂ§±Ë¥•ÔºåËØ∑Âà∑Êñ∞È°µÈù¢ÈáçËØï', 'danger');
                    }
                };

                // ÈáçÁΩÆË°®ÂçïÂáΩÊï∞Ôºà‰øùÁïôÊ®°ÂûãÈÄâÊã©ÔºåÊ∏ÖÁ©∫ÂõæÁâá„ÄÅÈü≥È¢ëÂíåÊèêÁ§∫ËØçÔºâ
                const resetForm = async (taskType) => {
                    const currentForm = getCurrentForm();
                    const currentModel = currentForm.model_cls;
                    const currentStage = currentForm.stage;
                    
                    // ÈáçÁΩÆË°®Âçï‰ΩÜ‰øùÁïôÊ®°ÂûãÂíåÈò∂ÊÆµ
                    switch (taskType) {
                        case 't2v':
                            t2vForm.value = {
                                task: 't2v',
                                model_cls: currentModel || '',
                                stage: currentStage || 'single_stage',
                                prompt: '',
                                seed: Math.floor(Math.random() * 1000000)
                            };
                            break;
                        case 'i2v':
                            i2vForm.value = {
                                task: 'i2v',
                                model_cls: currentModel || '',
                                stage: currentStage || 'multi_stage',
                                imageFile: null,
                                prompt: '',
                                seed: Math.floor(Math.random() * 1000000)
                            };
                            // Áõ¥Êé•Ê∏ÖÁ©∫i2vÂõæÁâáÈ¢ÑËßà
                            i2vImagePreview.value = null;
                            // Ê∏ÖÁêÜÂõæÁâáÊñá‰ª∂ËæìÂÖ•Ê°Ü
                            const imageInput = document.querySelector('input[type="file"][accept="image/*"]');
                            if (imageInput) {
                                imageInput.value = '';
                            }
                            break;
                        case 's2v':
                            s2vForm.value = {
                                task: 's2v',
                                model_cls: currentModel || '',
                                stage: currentStage || 'single_stage',
                                imageFile: null,
                                audioFile: null,
                                prompt: '',
                                seed: Math.floor(Math.random() * 1000000)
                            };
                            break;
                    }
                    
                    // Âº∫Âà∂Ëß¶ÂèëVueÂìçÂ∫îÂºèÊõ¥Êñ∞
                    setCurrentImagePreview(null);
                    setCurrentAudioPreview(null);
                    await nextTick();
                };

                // ÂºÄÂßãËΩÆËØ¢‰ªªÂä°Áä∂ÊÄÅ
                const startPollingTask = (taskId) => {
                    if (!pollingTasks.value.has(taskId)) {
                        pollingTasks.value.add(taskId);
                        console.log(`ÂºÄÂßãËΩÆËØ¢‰ªªÂä°Áä∂ÊÄÅ: ${taskId}`);
                        
                        // Â¶ÇÊûúËøòÊ≤°ÊúâËΩÆËØ¢ÂÆöÊó∂Âô®ÔºåÂêØÂä®‰∏Ä‰∏™
                        if (!pollingInterval.value) {
                            pollingInterval.value = setInterval(async () => {
                                await pollTaskStatuses();
                            }, 1000); // ÊØè1ÁßíËΩÆËØ¢‰∏ÄÊ¨°
                        }
                    }
                };

                // ÂÅúÊ≠¢ËΩÆËØ¢‰ªªÂä°Áä∂ÊÄÅ
                const stopPollingTask = (taskId) => {
                    pollingTasks.value.delete(taskId);
                    console.log(`ÂÅúÊ≠¢ËΩÆËØ¢‰ªªÂä°Áä∂ÊÄÅ: ${taskId}`);
                    
                    // Â¶ÇÊûúÊ≤°Êúâ‰ªªÂä°ÈúÄË¶ÅËΩÆËØ¢‰∫ÜÔºåÊ∏ÖÈô§ÂÆöÊó∂Âô®
                    if (pollingTasks.value.size === 0 && pollingInterval.value) {
                        clearInterval(pollingInterval.value);
                        pollingInterval.value = null;
                        console.log('ÂÅúÊ≠¢ÊâÄÊúâ‰ªªÂä°Áä∂ÊÄÅËΩÆËØ¢');
                    }
                };

                // ËΩÆËØ¢‰ªªÂä°Áä∂ÊÄÅ
                const pollTaskStatuses = async () => {
                    if (pollingTasks.value.size === 0) return;
                    
                    try {
                        const taskIds = Array.from(pollingTasks.value);
                        const response = await apiRequest(`./api/v1/task/query?task_ids=${taskIds.join(',')}`);
                        
                        if (response && response.ok) {
                            const tasksData = await response.json();
                            const updatedTasks = tasksData.tasks || [];
                            
                            // Êõ¥Êñ∞‰ªªÂä°ÂàóË°®‰∏≠ÁöÑ‰ªªÂä°Áä∂ÊÄÅ
                            let hasUpdates = false;
                            updatedTasks.forEach(updatedTask => {
                                const existingTaskIndex = tasks.value.findIndex(t => t.task_id === updatedTask.task_id);
                                if (existingTaskIndex !== -1) {
                                    const oldTask = tasks.value[existingTaskIndex];
                                    tasks.value[existingTaskIndex] = updatedTask;
                                    console.log('updatedTask', updatedTask);
                                    console.log('oldTask', oldTask);
                                    
                                    // Â¶ÇÊûúÁä∂ÊÄÅÂèëÁîüÂèòÂåñÔºåËÆ∞ÂΩïÊó•Âøó
                                    if (oldTask !== updatedTask) {
                                        hasUpdates = true; // ËøôÈáåÂü∫Êú¨ÈÉΩ‰ºöÂèòÔºåÂõ†‰∏∫‰ªªÂä°ÊúâËøõÂ∫¶Êù°
                                        
                                        // Â¶ÇÊûúÂΩìÂâçÂú®Êü•ÁúãËøô‰∏™‰ªªÂä°ÁöÑËØ¶ÊÉÖÔºåÊõ¥Êñ∞selectedTask
                                        if (modalTask.value && modalTask.value.task_id === updatedTask.task_id) {
                                            modalTask.value = updatedTask;
                                        }

                                        // Â¶ÇÊûúÂΩìÂâçÂú®projectsÈ°µÈù¢‰∏îÂèòÂåñÁöÑÊòØÁä∂ÊÄÅÔºåÊõ¥Êñ∞tasks
                                        if (currentView.value === 'projects' && oldTask.status !== updatedTask.status) {
                                            refreshTasks(true);
                                        }
                                        
                                        // Â¶ÇÊûú‰ªªÂä°ÂÆåÊàêÊàñÂ§±Ë¥•ÔºåÂÅúÊ≠¢ËΩÆËØ¢Âπ∂ÊòæÁ§∫ÊèêÁ§∫
                                        if (['SUCCEED', 'FAILED', 'CANCEL'].includes(updatedTask.status)) {
                                            stopPollingTask(updatedTask.task_id);
                                            refreshTasks(true);
                                            
                                            // ÊòæÁ§∫‰ªªÂä°ÂÆåÊàêÊèêÁ§∫
                                            if (updatedTask.status === 'SUCCEED') {
                                                showAlert('ËßÜÈ¢ëÁîüÊàêÂÆåÊàêÔºÅ', 'success');
                                            } else if (updatedTask.status === 'FAILED') {
                                                showAlert('ËßÜÈ¢ëÁîüÊàêÂ§±Ë¥•ÔºåËØ∑Êü•ÁúãËØ¶ÊÉÖ', 'danger');
                                            } else if (updatedTask.status === 'CANCEL') {
                                                showAlert('‰ªªÂä°Â∑≤ÂèñÊ∂à', 'warning');
                                            }
                                        }
                                    }
                                }
                            });
                            
                            // Â¶ÇÊûúÊúâÊõ¥Êñ∞ÔºåËß¶ÂèëÁïåÈù¢Âà∑Êñ∞
                            if (hasUpdates) {
                                await nextTick();
                            }
                        }
                    } catch (error) {
                        console.error('ËΩÆËØ¢‰ªªÂä°Áä∂ÊÄÅÂ§±Ë¥•:', error);
                    }
                };

                // ‰ªªÂä°Áä∂ÊÄÅÁÆ°ÁêÜ
                const getTaskStatusDisplay = (status) => {
                    const statusMap = {
                        'CREATED': t('created'),
                        'PENDING': t('pending'),
                        'RUNNING': t('running'),
                        'SUCCEED': t('succeed'),
                        'FAILED': t('failed'),
                        'CANCEL': t('cancelled')
                    };
                    return statusMap[status] || status;
                };

                const getTaskStatusColor = (status) => {
                    const colorMap = {
                        'CREATED': 'text-blue-400',
                        'PENDING': 'text-yellow-400',
                        'RUNNING': 'text-amber-400',
                        'SUCCEED': 'text-emerald-400',
                        'FAILED': 'text-red-400',
                        'CANCEL': 'text-gray-400'
                    };
                    return colorMap[status] || 'text-gray-400';
                };

                const getTaskStatusIcon = (status) => {
                    const iconMap = {
                        'CREATED': 'fas fa-clock',
                        'PENDING': 'fas fa-hourglass-half',
                        'RUNNING': 'fas fa-spinner fa-spin',
                        'SUCCEED': 'fas fa-check-circle',
                        'FAILED': 'fas fa-exclamation-triangle',
                        'CANCEL': 'fas fa-ban'
                    };
                    return iconMap[status] || 'fas fa-question-circle';
                };


                // ‰ªªÂä°Êó∂Èó¥Ê†ºÂºèÂåñ
                const getTaskDuration = (startTime, endTime) => {
                    if (!startTime || !endTime) return 'Êú™Áü•';
                    const start = new Date(startTime * 1000);
                    const end = new Date(endTime * 1000);
                    const diff = end - start;
                    const minutes = Math.floor(diff / 60000);
                    const seconds = Math.floor((diff % 60000) / 1000);
                    return `${minutes}ÂàÜ${seconds}Áßí`;
                };

                // Áõ∏ÂØπÊó∂Èó¥Ê†ºÂºèÂåñ
                const getRelativeTime = (timestamp) => {
                    if (!timestamp) return 'Êú™Áü•';
                    const now = new Date();
                    const time = new Date(timestamp * 1000);
                    const diff = now - time;

                    const minutes = Math.floor(diff / 60000);
                    const hours = Math.floor(diff / 3600000);
                    const days = Math.floor(diff / 86400000);
                    const months = Math.floor(diff / 2592000000); // 30Â§©
                    const years = Math.floor(diff / 31536000000);

                    if (years > 0) {
                        return years === 1 ? t('oneYearAgo') : `${years}t('yearsAgo')`;
                    } else if (months > 0) {
                        return months === 1 ? t('oneMonthAgo') : `${months}${t('monthsAgo')}`;
                    } else if (days > 0) {
                        return days === 1 ? t('oneDayAgo') : `${days}${t('daysAgo')}`;
                    } else if (hours > 0) {
                        return hours === 1 ? t('oneHourAgo') : `${hours}${t('hoursAgo')}`;
                    } else if (minutes > 0) {
                        return minutes === 1 ? t('oneMinuteAgo') : `${minutes}${t('minutesAgo')}`;
                    } else {
                        return t('justNow');
                    }
                };

                // ‰ªªÂä°ÂéÜÂè≤ËÆ∞ÂΩïÁÆ°ÁêÜ
                const getTaskHistory = () => {
                    return tasks.value.filter(task =>
                        ['SUCCEED', 'FAILED', 'CANCEL'].includes(task.status)
                    );
                };

                // Â≠ê‰ªªÂä°ËøõÂ∫¶Áõ∏ÂÖ≥ÂáΩÊï∞
                const getOverallProgress = (subtasks) => {
                    if (!subtasks || subtasks.length === 0) return 0;
                    
                    let completedCount = 0;
                    subtasks.forEach(subtask => {
                        if (subtask.status === 'SUCCEED') {
                            completedCount++;
                        }
                    });
                    
                    return Math.round((completedCount / subtasks.length) * 100);
                };

                // Ëé∑ÂèñËøõÂ∫¶Êù°Ê†áÈ¢ò
                const getProgressTitle = (subtasks) => {
                    if (!subtasks || subtasks.length === 0) return t('overallProgress');
                    
                    const pendingSubtasks = subtasks.filter(subtask => subtask.status === 'PENDING');
                    const runningSubtasks = subtasks.filter(subtask => subtask.status === 'RUNNING');
                    
                    if (pendingSubtasks.length > 0) {
                        return t('queueStatus');
                    } else if (runningSubtasks.length > 0) {
                        return t('running');
                    } else {
                        return t('overallProgress');
                    }
                };

                // Ëé∑ÂèñËøõÂ∫¶‰ø°ÊÅØ
                const getProgressInfo = (subtasks) => {
                    if (!subtasks || subtasks.length === 0) return '0%';
                    
                    const pendingSubtasks = subtasks.filter(subtask => subtask.status === 'PENDING');
                    const runningSubtasks = subtasks.filter(subtask => subtask.status === 'RUNNING');
                    
                    if (pendingSubtasks.length > 0) {
                        // ÊòæÁ§∫ÊéíÈòü‰ø°ÊÅØ
                        const firstPending = pendingSubtasks[0];
                        const queuePosition = firstPending.estimated_pending_order;
                        const estimatedTime = firstPending.estimated_pending_secs;
                        
                        let info = t('queueing');
                        if (queuePosition !== null && queuePosition !== undefined) {
                            info += ` (t('position')}: ${queuePosition})`;
                        }
                        if (estimatedTime !== null && estimatedTime !== undefined) {
                            info += ` - ${formatDuration(estimatedTime)}`;
                        }
                        return info;
                    } else if (runningSubtasks.length > 0) {
                        // ÊòæÁ§∫ËøêË°å‰ø°ÊÅØ
                        const firstRunning = runningSubtasks[0];
                        const workerName = firstRunning.worker_name || t('unknown');
                        const estimatedTime = firstRunning.estimated_running_secs;
                        
                        let info = `${t('subtask')} ${workerName}`;
                        if (estimatedTime !== null && estimatedTime !== undefined) {
                            const elapses = firstRunning.elapses || {};
                            const runningTime = elapses['RUNNING-'] || 0;
                            const remaining = Math.max(0, estimatedTime - runningTime);
                            info += ` - t('remaining') ${formatDuration(remaining)}`;
                        }
                        return info;
                    } else {
                        // ÊòæÁ§∫ÊÄª‰ΩìËøõÂ∫¶
                        return getOverallProgress(subtasks) + '%';
                    }
                };

                const getSubtaskProgress = (subtask) => {
                    if (subtask.status === 'SUCCEED') return 100;
                    if (subtask.status === 'FAILED' || subtask.status === 'CANCEL') return 0;
                    
                    // ÂØπ‰∫éPENDINGÂíåRUNNINGÁä∂ÊÄÅÔºåÂü∫‰∫éÊó∂Èó¥‰º∞ÁÆóËøõÂ∫¶
                    if (subtask.status === 'PENDING') {
                        // ÊéíÈòü‰∏≠ÁöÑ‰ªªÂä°ÔºåËøõÂ∫¶‰∏∫0
                        return 0;
                    }
                    
                    if (subtask.status === 'RUNNING') {
                        // ËøêË°å‰∏≠ÁöÑ‰ªªÂä°ÔºåÂü∫‰∫éÂ∑≤ËøêË°åÊó∂Èó¥‰º∞ÁÆóËøõÂ∫¶
                        const elapses = subtask.elapses || {};
                        const runningTime = elapses['RUNNING-'] || 0;
                        const estimatedTotal = subtask.estimated_running_secs || 0;
                        
                        if (estimatedTotal > 0) {
                            const progress = Math.min((runningTime / estimatedTotal) * 100, 95); // ÊúÄÂ§ö95%ÔºåÈÅøÂÖçÊòæÁ§∫100%‰ΩÜÊú™ÂÆåÊàê
                            return Math.round(progress);
                        }
                    }
                    
                    return 0;
                };

                const getSubtaskStatusText = (status) => {
                    const statusMap = {
                        'PENDING': t('queueing'),
                        'RUNNING': t('running'),
                        'SUCCEED': t('completed'),
                        'FAILED': t('failed'),
                        'CANCEL': t('cancelled')
                    };
                    return statusMap[status] || status;
                };

                const formatEstimatedTime = (subtask) => {
                    if (subtask.status === 'PENDING') {
                        const pendingSecs = subtask.estimated_pending_secs;
                        const queuePosition = subtask.estimated_pending_order;
                        
                        if (pendingSecs !== null && pendingSecs !== undefined) {
                            let info = formatDuration(pendingSecs);
                            if (queuePosition !== null && queuePosition !== undefined) {
                                info += ` (t('position')}: ${queuePosition})`;
                            }
                            return info;
                        }
                        return t('calculating');
                    }
                    
                    if (subtask.status === 'RUNNING') {
                        const elapses = subtask.elapses || {};
                        const runningTime = elapses['RUNNING-'] || 0;
                        const estimatedTotal = subtask.estimated_running_secs || 0;
                        
                        if (estimatedTotal > 0) {
                            const remaining = Math.max(0, estimatedTotal - runningTime);
                            return `${t('remaining')} ${formatDuration(remaining)}`;
                        }
                        return t('calculating');
                    }
                    
                    return t('completed');
                };

                const formatDuration = (seconds) => {
                    if (seconds < 60) {
                        return `${Math.round(seconds)}${t('seconds')}`;
                    } else if (seconds < 3600) {
                        const minutes = Math.round(seconds / 60);
                        return `${minutes}${t('minutes')}`;
                    } else {
                        const hours = Math.floor(seconds / 3600);
                        const minutes = Math.round((seconds % 3600) / 60);
                        return `${hours}${t('hours')}${minutes}${t('minutes')}`;
                    }
                };

                const getTaskFailureInfo = (task) => {
                    if (!task) return null;
                    
                    // Ê£ÄÊü•‰ªªÂä°Á∫ßÂà´ÁöÑÂ§±Ë¥•‰ø°ÊÅØ
                    if (task.fail_msg) {
                        return task.fail_msg;
                    }
                    
                    // Ê£ÄÊü•Â≠ê‰ªªÂä°ÁöÑÂ§±Ë¥•‰ø°ÊÅØ
                    if (task.subtasks && task.subtasks.length > 0) {
                        const failedSubtasks = task.subtasks.filter(subtask => 
                            (subtask.extra_info && subtask.extra_info.fail_msg) || subtask.fail_msg
                        );
                        if (failedSubtasks.length > 0) {
                            const msg = failedSubtasks.map(subtask => 
                                (subtask.extra_info && subtask.extra_info.fail_msg) || subtask.fail_msg
                            ).join('\n');
                            return msg;
                        }
                    }
                    
                    return null;
                };

                const getActiveTasks = () => {
                    return tasks.value.filter(task =>
                        ['CREATED', 'PENDING', 'RUNNING'].includes(task.status)
                    );
                };

                // ‰ªªÂä°ÊêúÁ¥¢ÂíåËøáÊª§Â¢ûÂº∫
                const searchTasks = (query) => {
                    if (!query) return tasks.value;
                    return tasks.value.filter(task => {
                        const searchText = [
                            task.task_id,
                            task.task_type,
                            task.model_cls,
                            task.params?.prompt || '',
                            getTaskStatusDisplay(task.status)
                        ].join(' ').toLowerCase();
                        return searchText.includes(query.toLowerCase());
                    });
                };

                const filterTasksByStatus = (status) => {
                    if (status === 'ALL') return tasks.value;
                    return tasks.value.filter(task => task.status === status);
                };

                const filterTasksByType = (type) => {
                    if (!type) return tasks.value;
                    return tasks.value.filter(task => task.task_type === type);
                };

                // ÊèêÁ§∫Ê∂àÊÅØÊ†∑ÂºèÁÆ°ÁêÜ
                const getAlertClass = (type) => {
                    const classMap = {
                        'success': 'animate-slide-down',
                        'warning': 'animate-slide-down',
                        'danger': 'animate-slide-down',
                        'info': 'animate-slide-down'
                    };
                    return classMap[type] || 'animate-slide-down';
                };

                const getAlertBorderClass = (type) => {
                    const borderMap = {
                        'success': 'border-green-500',
                        'warning': 'border-yellow-500',
                        'danger': 'border-red-500',
                        'info': 'border-blue-500'
                    };
                    return borderMap[type] || 'border-gray-500';
                };

                const getAlertTextClass = (type) => {
                    // Áªü‰∏Ä‰ΩøÁî®ÁôΩËâ≤ÊñáÂ≠ó
                    return 'text-white';
                };

                const getAlertIcon = (type) => {
                    const iconMap = {
                        'success': 'fas fa-check text-white',
                        'warning': 'fas fa-exclamation text-white',
                        'danger': 'fas fa-times text-white',
                        'info': 'fas fa-info text-white'
                    };
                    return iconMap[type] || 'fas fa-info text-white';
                };

                const getAlertIconBgClass = (type) => {
                    const bgMap = {
                        'success': 'bg-green-500/30',
                        'warning': 'bg-yellow-500/30',
                        'danger': 'bg-red-500/30',
                        'info': 'bg-laser-purple/30'
                    };
                    return bgMap[type] || 'bg-laser-purple/30';
                };

                // ÁõëÂê¨Âô® - ÁõëÂê¨‰ªªÂä°Á±ªÂûãÂèòÂåñ
                watch(() => selectedTaskId.value, () => {
                    const currentForm = getCurrentForm();

                    // Âè™ÊúâÂΩìÂΩìÂâçË°®ÂçïÊ≤°ÊúâÈÄâÊã©Ê®°ÂûãÊó∂ÔºåÊâçËá™Âä®ÈÄâÊã©Á¨¨‰∏Ä‰∏™ÂèØÁî®ÁöÑÊ®°Âûã
                    if (!currentForm.model_cls) {
                        let availableModels;

                        availableModels = models.value.filter(m => m.task === selectedTaskId.value);

                        if (availableModels.length > 0) {
                            const firstModel = availableModels[0];
                            currentForm.model_cls = firstModel.model_cls;
                            currentForm.stage = firstModel.stage;
                        }
                    }

                    // Ê≥®ÊÑèÔºöËøôÈáå‰∏çÈúÄË¶ÅÈáçÁΩÆÈ¢ÑËßàÔºåÂõ†‰∏∫Êàë‰ª¨Ë¶Å‰øùÊåÅÊØè‰∏™‰ªªÂä°ÁöÑÁã¨Á´ãÊÄß
                    // È¢ÑËßà‰ºöÂú® selectTask ÂáΩÊï∞‰∏≠Ê†πÊçÆÊñá‰ª∂Áä∂ÊÄÅÊÅ¢Â§ç
                });

                watch(() => getCurrentForm().model_cls, () => {
                    const currentForm = getCurrentForm();

                    // Âè™ÊúâÂΩìÂΩìÂâçË°®ÂçïÊ≤°ÊúâÈÄâÊã©Èò∂ÊÆµÊó∂ÔºåÊâçËá™Âä®ÈÄâÊã©Á¨¨‰∏Ä‰∏™ÂèØÁî®ÁöÑÈò∂ÊÆµ
                    if (!currentForm.stage) {
                        let availableStages;

                        availableStages = models.value
                                .filter(m => m.task === selectedTaskId.value && m.model_cls === currentForm.model_cls)
                                .map(m => m.stage);

                        if (availableStages.length > 0) {
                            currentForm.stage = availableStages[0];
                        }
                    }
                });

                // ÁîüÂëΩÂë®Êúü
                onMounted(async () => {
                    // ÂøÖÈ°ªÂÖàÂàùÂßãÂåñËØ≠Ë®Ä
                    await initLanguage();
                    console.log('initLanguage');
                    // ËÆæÁΩÆÂàùÂßãÂåñloadingÁä∂ÊÄÅ
                    initLoading.value = true;
                    console.log('initLoading');
                    // ÂêØÂä®ÊèêÁ§∫ÊªöÂä®
                    startHintRotation();
                    // Ê∑ªÂä†ÂÖ®Â±ÄÁÇπÂáª‰∫ã‰ª∂ÁõëÂê¨Âô®
                    document.addEventListener('click', handleClickOutside);

                    try {
                        // Ê£ÄÊü•ÊòØÂê¶Â∑≤ÁôªÂΩï
                        const savedToken = localStorage.getItem('accessToken');
                        const savedUser = localStorage.getItem('currentUser');

                        if (savedToken && savedUser) {
                            currentUser.value = JSON.parse(savedUser);
                            isLoggedIn.value = true;
                            await init();
                        } else {
                            // Ê£ÄÊü•ÊòØÂê¶ÊòØGitHubÂõûË∞É
                            const urlParams = new URLSearchParams(window.location.search);
                            const code = urlParams.get('code');
                            if (code) {
                                await handleGitHubCallback(code);
                                // handleGitHubCallbackÂÜÖÈÉ®‰ºöËÆæÁΩÆisLoggedIn.value = true
                            } else {
                                // Ê≤°Êúâtoken‰∏î‰∏çÊòØÂõûË∞ÉÔºåÊòæÁ§∫ÁôªÂΩïÈ°µÈù¢
                                isLoggedIn.value = false;
                            }
                        }
                    } catch (error) {
                        console.error(t('initializationFailed'), error);
                        showAlert(t('initializationFailed'), 'danger');
                        // Âá∫ÈîôÊó∂ÊòæÁ§∫ÁôªÂΩïÈ°µÈù¢
                        isLoggedIn.value = false;
                    } finally {
                        loginLoading.value = false;
                        initLoading.value = false;
                    }
                });

                // È°µÈù¢Âç∏ËΩΩÊó∂Ê∏ÖÁêÜËΩÆËØ¢
                onUnmounted(() => {
                    if (pollingInterval.value) {
                        clearInterval(pollingInterval.value);
                        pollingInterval.value = null;
                    }
                    pollingTasks.value.clear();
                    
                    // Ê∏ÖÁêÜÊèêÁ§∫ÊªöÂä®
                    stopHintRotation();
                });

                // ÊèêÁ§∫ËØçÊ®°ÊùøÁÆ°ÁêÜ
                const promptTemplates = {
                    's2v': [
                        {
                            id: 's2v_1',
                            title: 'ÂïÜÂä°ÊºîËÆ≤',
                            prompt: 'Êï∞Â≠ó‰∫∫ËøõË°åÂïÜÂä°ÊºîËÆ≤ÔºåË°®ÊÉÖËá™ÁÑ∂ÔºåÊâãÂäøÂæó‰ΩìÔºåËÉåÊôØ‰∏∫Áé∞‰ª£ÂåñÁöÑ‰ºöËÆÆÂÆ§ÔºåÊï¥‰ΩìÈ£éÊ†º‰∏ì‰∏öÂïÜÂä°„ÄÇ'
                        },
                        {
                            id: 's2v_2',
                            title: '‰∫ßÂìÅ‰ªãÁªç',
                            prompt: 'Êï∞Â≠ó‰∫∫‰ªãÁªç‰∫ßÂìÅÁâπÁÇπÔºåËØ≠Ê∞î‰∫≤ÂàáÔºåÂä®‰ΩúËá™ÁÑ∂ÔºåËÉåÊôØ‰∏∫‰∫ßÂìÅÂ±ïÁ§∫Âå∫ÔºåÁ™ÅÂá∫‰∫ßÂìÅÁöÑÁßëÊäÄÊÑüÂíåÂÆûÁî®ÊÄß„ÄÇ'
                        }
                    ],
                    't2v': [
                        {
                            id: 't2v_1',
                            title: 'Ëá™ÁÑ∂È£éÊôØ',
                            prompt: '‰∏Ä‰∏™ÂÆÅÈùôÁöÑÂ±±Ë∞∑ÔºåÈò≥ÂÖâÈÄèËøá‰∫ëÂ±ÇÊ¥íÂú®ÁªøËâ≤ÁöÑËçâÂú∞‰∏äÔºåËøúÂ§ÑÊúâÈõ™Â±±ÔºåËøëÂ§ÑÊúâÊ∏ÖÊæàÁöÑÊ∫™ÊµÅÔºåÁîªÈù¢Ê∏©ÊöñËá™ÁÑ∂ÔºåÂÖÖÊª°ÁîüÊú∫„ÄÇ'
                        },
                        {
                            id: 't2v_2',
                            title: 'ÂüéÂ∏ÇÂ§úÊôØ',
                            prompt: 'ÁπÅÂçéÁöÑÂüéÂ∏ÇÂ§úÊôØÔºåÈúìËôπÁÅØÈó™ÁÉÅÔºåÈ´òÊ•ºÂ§ßÂé¶ÊûóÁ´ãÔºåËΩ¶ÊµÅÂ¶ÇÁªáÔºåÂ§©Á©∫‰∏≠ÊúâÊòüÊòüÁÇπÁºÄÔºåËê•ÈÄ†Âá∫ÈÉΩÂ∏ÇÁöÑÁπÅÂçéÊ∞õÂõ¥„ÄÇ'
                        },
                        {
                            id: 't2v_3',
                            title: 'ÁßëÊäÄÊú™Êù•',
                            prompt: 'Êú™Êù•ÁßëÊäÄÂüéÂ∏ÇÔºåÈ£ûË°åÊ±ΩËΩ¶Á©øÊ¢≠ÔºåÂÖ®ÊÅØÊäïÂΩ±ÈöèÂ§ÑÂèØËßÅÔºåÂª∫Á≠ëÂÖ∑ÊúâÊµÅÁ∫øÂûãËÆæËÆ°ÔºåÂÖÖÊª°ÁßëÊäÄÊÑüÂíåÊú™Êù•ÊÑü„ÄÇ'
                        }
                    ],
                    'i2v': [
                        {
                            id: 'i2v_1',
                            title: '‰∫∫Áâ©Âä®‰Ωú',
                            prompt: 'Âü∫‰∫éÂèÇËÄÉÂõæÁâáÔºåËÆ©ËßíËâ≤ÂÅöÂá∫Ëá™ÁÑ∂ÁöÑË°åËµ∞Âä®‰ΩúÔºå‰øùÊåÅÂéüÊúâÁöÑÊúçË£ÖÂíåÈ£éÊ†ºÔºåËÉåÊôØÂèØ‰ª•ÈÄÇÂΩìÂèòÂåñ„ÄÇ'
                        },
                        {
                            id: 'i2v_2',
                            title: 'Âú∫ÊôØËΩ¨Êç¢',
                            prompt: '‰øùÊåÅÂèÇËÄÉÂõæÁâá‰∏≠ÁöÑ‰∫∫Áâ©ÂΩ¢Ë±°ÔºåÂ∞ÜËÉåÊôØËΩ¨Êç¢‰∏∫‰∏çÂêåÁöÑÂ≠£ËäÇÊàñÁéØÂ¢ÉÔºåÂ¶Ç‰ªéÂÆ§ÂÜÖÂà∞Êà∑Â§ñÔºå‰ªéÁôΩÂ§©Âà∞Â§úÊôö„ÄÇ'
                        }
                    ]
                };

                const getPromptTemplates = (taskType) => {
                    return promptTemplates[taskType] || [];
                };


                const selectPromptTemplate = (template) => {
                    getCurrentForm().prompt = template.prompt;
                    showPromptModal.value = false;
                    showAlert(`${t('templateApplied')} ${template.title}`, 'success');
                };

                // ÊèêÁ§∫ËØçÂéÜÂè≤ËÆ∞ÂΩïÁÆ°ÁêÜ - Áé∞Âú®Áõ¥Êé•‰ªétaskHistory‰∏≠Ëé∑Âèñ
                const promptHistory = ref([]);

                const getPromptHistory = async () => {
                    try {
                        // ‰ªétaskHistory‰∏≠Ëé∑ÂèñpromptÂéÜÂè≤ÔºåÂéªÈáçÂπ∂ÊåâÊó∂Èó¥ÊéíÂ∫è
                        const taskHistory = await getLocalTaskHistory();
                        const uniquePrompts = [];
                        const seenPrompts = new Set();
                        
                        // ÈÅçÂéÜtaskHistoryÔºåÊèêÂèñÂîØ‰∏ÄÁöÑprompt
                        for (const task of taskHistory) {
                            if (task.prompt && task.prompt.trim() && !seenPrompts.has(task.prompt.trim())) {
                                uniquePrompts.push(task.prompt.trim());
                                seenPrompts.add(task.prompt.trim());
                            }
                        }
                        
                        const result = uniquePrompts.slice(0, 10); // Âè™ÊòæÁ§∫ÊúÄËøë10Êù°
                        promptHistory.value = result; // Êõ¥Êñ∞ÂìçÂ∫îÂºèÊï∞ÊçÆ
                        return result;
                    } catch (error) {
                        console.error(t('getPromptHistoryFailed'), error);
                        promptHistory.value = []; // Êõ¥Êñ∞ÂìçÂ∫îÂºèÊï∞ÊçÆ
                        return [];
                    }
                };

                // addPromptToHistoryÂáΩÊï∞Â∑≤Âà†Èô§ÔºåÁé∞Âú®promptÂéÜÂè≤Áõ¥Êé•‰ªétaskHistory‰∏≠Ëé∑Âèñ

                // ‰øùÂ≠òÂÆåÊï¥ÁöÑ‰ªªÂä°ÂéÜÂè≤ÔºàÂåÖÊã¨ÊèêÁ§∫ËØç„ÄÅÂõæÁâá„ÄÅÈü≥È¢ëÔºâ
                const addTaskToHistory = (taskType, formData) => {
                    const historyItem = {
                        id: Date.now(),
                        timestamp: new Date().toISOString(),
                        taskType: taskType,
                        prompt: formData.prompt || '',
                        imageFile: null,
                        audioFile: null
                    };

                    // ‰øùÂ≠òÂõæÁâáÊñá‰ª∂
                    if (formData.imageFile) {
                        const reader = new FileReader();
                        reader.onload = function (e) {
                            historyItem.imageFile = {
                                name: formData.imageFile.name,
                                type: formData.imageFile.type,
                                size: formData.imageFile.size,
                                data: e.target.result
                            };
                            saveTaskHistoryItem(historyItem);
                        };
                        reader.readAsDataURL(formData.imageFile);
                    } else {
                        // Ê≤°ÊúâÂõæÁâáÊñá‰ª∂ÔºåÁõ¥Êé•‰øùÂ≠ò
                        saveTaskHistoryItem(historyItem);
                    }

                    // ‰øùÂ≠òÈü≥È¢ëÊñá‰ª∂
                    if (formData.audioFile) {
                        const reader = new FileReader();
                        reader.onload = function (e) {
                            historyItem.audioFile = {
                                name: formData.audioFile.name,
                                type: formData.audioFile.type,
                                size: formData.audioFile.size,
                                data: e.target.result
                            };
                            saveTaskHistoryItem(historyItem);
                        };
                        reader.readAsDataURL(formData.audioFile);
                    }
                };

                // ‰øùÂ≠ò‰ªªÂä°ÂéÜÂè≤È°πÂà∞localStorage
                const saveTaskHistoryItem = (historyItem) => {
                    try {
                        const existingHistory = JSON.parse(localStorage.getItem('taskHistory') || '[]');
                        
                        // ÈÅøÂÖçÈáçÂ§çÊ∑ªÂä†ÔºàÂü∫‰∫éÊèêÁ§∫ËØçÂíå‰ªªÂä°Á±ªÂûãÔºâ
                        const isDuplicate = existingHistory.some(item => 
                            item.prompt === historyItem.prompt && 
                            item.taskType === historyItem.taskType
                        );
                        
                        if (!isDuplicate) {
                            // ÊåâÊó∂Èó¥Êà≥ÊéíÂ∫èÔºåÁ°Æ‰øùÊúÄÊñ∞ÁöÑËÆ∞ÂΩïÂú®ÊúÄÂêé
                            existingHistory.push(historyItem);
                            existingHistory.sort((a, b) => new Date(a.timestamp) - new Date(b.timestamp));
                            
                            // ÈôêÂà∂ÂéÜÂè≤ËÆ∞ÂΩïÊï∞ÈáèÔºåÂà†Èô§ÊúÄÊóßÁöÑËÆ∞ÂΩïÔºàÊúÄÊôöÁöÑËÆ∞ÂΩïÔºâ
                            if (existingHistory.length > 20) {
                                // Âà†Èô§ÊúÄÂâçÈù¢ÁöÑËÆ∞ÂΩïÔºàÊúÄÊóßÁöÑÔºâ
                                existingHistory.splice(0, existingHistory.length - 20);
                            }
                            
                            localStorage.setItem('taskHistory', JSON.stringify(existingHistory));
                            console.log(t('taskHistorySaved'), historyItem);
                        }
                    } catch (error) {
                        console.error(t('saveTaskHistoryFailed'), error);
                    }
                };

                // Ëé∑ÂèñÊú¨Âú∞Â≠òÂÇ®ÁöÑ‰ªªÂä°ÂéÜÂè≤
                const getLocalTaskHistory = async () => {
                    try {
                        // ‰ΩøÁî®PromiseÊ®°ÊãüÂºÇÊ≠•Êìç‰ΩúÔºåÈÅøÂÖçÈòªÂ°ûUI
                        return await new Promise((resolve) => {
                            setTimeout(() => {
                                try {
                                    const history = JSON.parse(localStorage.getItem('taskHistory') || '[]');
                                    // ÊåâÊó∂Èó¥Êà≥ÊéíÂ∫èÔºåÊúÄÊñ∞ÁöÑËÆ∞ÂΩïÂú®Ââç
                                    const sortedHistory = history.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
                                    resolve(sortedHistory);
                                } catch (error) {
                                    console.error(t('parseTaskHistoryFailed'), error);
                                    resolve([]);
                                }
                            }, 0);
                        });
                    } catch (error) {
                        console.error(t('getTaskHistoryFailed'), error);
                        return [];
                    }
                };

                const selectPromptHistory = (prompt) => {
                    getCurrentForm().prompt = prompt;
                    showPromptModal.value = false;
                    showAlert(t('promptHistoryApplied'), 'success');
                };

                const clearPromptHistory = () => {
                    // Ê∏ÖÁ©∫taskHistory‰∏≠ÁöÑpromptÁõ∏ÂÖ≥Êï∞ÊçÆ
                    localStorage.removeItem('taskHistory');
                    showAlert(t('promptHistoryCleared'), 'info');
                };

                // ÂõæÁâáÂéÜÂè≤ËÆ∞ÂΩïÁÆ°ÁêÜ
                const getImageHistory = async () => {
                    try {
                        const taskHistory = await getLocalTaskHistory();
                        const uniqueImages = [];
                        const seenImages = new Set();
                        
                        // ÈÅçÂéÜtaskHistoryÔºåÊèêÂèñÂîØ‰∏ÄÁöÑÂõæÁâá
                        for (const task of taskHistory) {
                            if (task.imageFile && task.imageFile.name && !seenImages.has(task.imageFile.name)) {
                                uniqueImages.push({
                                    filename: task.imageFile.name,
                                    thumbnail: task.imageFile.data,
                                    data: task.imageFile.data,
                                    timestamp: task.timestamp
                                });
                                seenImages.add(task.imageFile.name);
                            }
                        }
                        
                        const result = uniqueImages.slice(0, 20); // Âè™ÊòæÁ§∫ÊúÄËøë20Êù°
                        imageHistory.value = result;
                        return result;
                    } catch (error) {
                        console.error(t('getImageHistoryFailed'), error);
                        imageHistory.value = [];
                        return [];
                    }
                };

                // Èü≥È¢ëÂéÜÂè≤ËÆ∞ÂΩïÁÆ°ÁêÜ
                const getAudioHistory = async () => {
                    try {
                        const taskHistory = await getLocalTaskHistory();
                        const uniqueAudios = [];
                        const seenAudios = new Set();
                        
                        // ÈÅçÂéÜtaskHistoryÔºåÊèêÂèñÂîØ‰∏ÄÁöÑÈü≥È¢ë
                        for (const task of taskHistory) {
                            if (task.audioFile && task.audioFile.name && !seenAudios.has(task.audioFile.name)) {
                                uniqueAudios.push({
                                    filename: task.audioFile.name,
                                    data: task.audioFile.data,
                                    timestamp: task.timestamp
                                });
                                seenAudios.add(task.audioFile.name);
                            }
                        }
                        
                        const result = uniqueAudios.slice(0, 20); // Âè™ÊòæÁ§∫ÊúÄËøë20Êù°
                        audioHistory.value = result;
                        return result;
                    } catch (error) {
                        console.error('Ëé∑ÂèñÈü≥È¢ëÂéÜÂè≤Â§±Ë¥•:', error);
                        audioHistory.value = [];
                        return [];
                    }
                };

                // ÈÄâÊã©ÂõæÁâáÂéÜÂè≤ËÆ∞ÂΩï
                const selectImageHistory = (history) => {
                    // ÂàõÂª∫FileÂØπË±°
                    const byteCharacters = atob(history.data.split(',')[1]);
                    const byteNumbers = new Array(byteCharacters.length);
                    for (let i = 0; i < byteCharacters.length; i++) {
                        byteNumbers[i] = byteCharacters.charCodeAt(i);
                    }
                    const byteArray = new Uint8Array(byteNumbers);
                    const file = new File([byteArray], history.filename, { type: 'image/jpeg' });
                    
                    // ËÆæÁΩÆÂõæÁâáÈ¢ÑËßà
                    setCurrentImagePreview(history.data);
                    
                    // Êõ¥Êñ∞Ë°®Âçï
                    const currentForm = getCurrentForm();
                    currentForm.imageFile = file;
                    
                    showImageTemplates.value = false;
                    showAlert('Â∑≤Â∫îÁî®ÂéÜÂè≤ÂõæÁâá', 'success');
                };

                // ÈÄâÊã©Èü≥È¢ëÂéÜÂè≤ËÆ∞ÂΩï
                const selectAudioHistory = (history) => {
                    // ÂàõÂª∫FileÂØπË±°
                    const byteCharacters = atob(history.data.split(',')[1]);
                    const byteNumbers = new Array(byteCharacters.length);
                    for (let i = 0; i < byteCharacters.length; i++) {
                        byteNumbers[i] = byteCharacters.charCodeAt(i);
                    }
                    const byteArray = new Uint8Array(byteNumbers);
                    const file = new File([byteArray], history.filename, { type: 'audio/mpeg' });
                    
                    // ËÆæÁΩÆÈü≥È¢ëÈ¢ÑËßà
                    setCurrentAudioPreview(history.data);
                    
                    // Êõ¥Êñ∞Ë°®Âçï
                    const currentForm = getCurrentForm();
                    currentForm.audioFile = file;
                    
                    showAudioTemplates.value = false;
                    showAlert('Â∑≤Â∫îÁî®ÂéÜÂè≤Èü≥È¢ë', 'success');
                };

                // È¢ÑËßàÈü≥È¢ëÂéÜÂè≤ËÆ∞ÂΩï
                const previewAudioHistory = (history) => {
                    const audio = new Audio(history.data);
                    audio.play().catch(error => {
                        console.error('Èü≥È¢ëÊí≠ÊîæÂ§±Ë¥•:', error);
                        showAlert('Èü≥È¢ëÊí≠ÊîæÂ§±Ë¥•', 'danger');
                    });
                };

                // Ê∏ÖÁ©∫ÂõæÁâáÂéÜÂè≤ËÆ∞ÂΩï
                const clearImageHistory = () => {
                    imageHistory.value = [];
                    showAlert('ÂõæÁâáÂéÜÂè≤Â∑≤Ê∏ÖÁ©∫', 'info');
                };

                // Ê∏ÖÁ©∫Èü≥È¢ëÂéÜÂè≤ËÆ∞ÂΩï
                const clearAudioHistory = () => {
                    audioHistory.value = [];
                    showAlert('Èü≥È¢ëÂéÜÂè≤Â∑≤Ê∏ÖÁ©∫', 'info');
                };

                const getAuthHeaders = () => {
                    const headers = {
                        'Content-Type': 'application/json'
                    };

                    const token = localStorage.getItem('accessToken');
                    if (token) {
                        headers['Authorization'] = `Bearer ${token}`;
                        console.log('‰ΩøÁî®TokenËøõË°åËÆ§ËØÅ:', token.substring(0, 20) + '...');
                    } else {
                        console.warn('Ê≤°ÊúâÊâæÂà∞accessToken');
                    }
                    return headers;
                };

                // È™åËØÅtokenÊòØÂê¶ÊúâÊïà
                const validateToken = async (token) => {
                    try {
                        const response = await fetch('./api/v1/model/list', {
                            method: 'GET',
                            headers: {
                                'Authorization': `Bearer ${token}`,
                                'Content-Type': 'application/json'
                            }
                        });
                        await new Promise(resolve => setTimeout(resolve, 100));
                        return response.ok;
                    } catch (error) {
                        console.error('Token validation failed:', error);
                        return false;
                    }
                };

                // Â¢ûÂº∫ÁöÑAPIËØ∑Ê±ÇÂáΩÊï∞ÔºåËá™Âä®Â§ÑÁêÜËÆ§ËØÅÈîôËØØ
                const apiRequest = async (url, options = {}) => {
                    const headers = getAuthHeaders();

                    try {
                        const response = await fetch(url, {
                            ...options,
                            headers: {
                                ...headers,
                                ...options.headers
                            }
                        });
                        await new Promise(resolve => setTimeout(resolve, 100));
                        // Ê£ÄÊü•ÊòØÂê¶ÊòØËÆ§ËØÅÈîôËØØ
                        if (response.status === 401 || response.status === 403) {
                            // TokenÊó†ÊïàÔºåÊ∏ÖÈô§Êú¨Âú∞Â≠òÂÇ®Âπ∂Ë∑≥ËΩ¨Âà∞ÁôªÂΩïÈ°µ
                            logout();
                            showAlert('ÁôªÂΩïÂ∑≤ËøáÊúüÔºåËØ∑ÈáçÊñ∞ÁôªÂΩï', 'warning');
                            return null;
                        }
                        return response;
                    } catch (error) {
                        console.error('API request failed:', error);
                        showAlert('ÁΩëÁªúËØ∑Ê±ÇÂ§±Ë¥•', 'danger');
                        return null;
                    }
                };

                // ‰æßËæπÊ†èÊãñÊãΩË∞ÉÊï¥ÂäüËÉΩ
                const sidebar = ref(null);
                const sidebarWidth = ref(256); // ÈªòËÆ§ÂÆΩÂ∫¶ 256px (w-64)
                let isResizing = false;
                let startX = 0;
                let startWidth = 0;

                // Êõ¥Êñ∞ÊÇ¨ÊµÆÊåâÈíÆ‰ΩçÁΩÆ
                const updateFloatingButtonPosition = (width) => {
                    const floatingBtn = document.querySelector('.floating-toggle-btn');
                    if (floatingBtn) {
                        if (sidebarCollapsed.value) {
                            // Êî∂Ëµ∑Áä∂ÊÄÅÊó∂ÔºåÊåâÈíÆ‰Ωç‰∫éÂ±èÂπïÂ∑¶‰æß
                            floatingBtn.style.left = '0px';
                            floatingBtn.style.right = 'auto';
                        } else {
                            // Â±ïÂºÄÁä∂ÊÄÅÊó∂ÔºåÊåâÈíÆ‰Ωç‰∫éÂéÜÂè≤‰ªªÂä°Ê†èÂè≥‰æß
                            floatingBtn.style.left = width + 'px';
                            floatingBtn.style.right = 'auto';
                        }
                    }
                };

                const startResize = (e) => {
                    e.preventDefault();
                    console.log('startResize called');

                    isResizing = true;
                    startX = e.clientX;
                    startWidth = sidebar.value.offsetWidth;
                    console.log('Resize started, width:', startWidth);

                    document.body.classList.add('resizing');
                    document.addEventListener('mousemove', handleResize);
                    document.addEventListener('mouseup', stopResize);
                };

                const handleResize = (e) => {
                    if (!isResizing) return;

                    const deltaX = e.clientX - startX;
                    const newWidth = startWidth + deltaX;
                    const minWidth = 200;
                    const maxWidth = 500;

                    if (newWidth >= minWidth && newWidth <= maxWidth) {
                        // Á´ãÂç≥Êõ¥Êñ∞ÊÇ¨ÊµÆÊåâÈíÆ‰ΩçÁΩÆÔºå‰∏çÁ≠âÂæÖÂÖ∂‰ªñÊõ¥Êñ∞
                        const floatingBtn = document.querySelector('.floating-toggle-btn');
                        if (floatingBtn && !sidebarCollapsed.value) {
                            floatingBtn.style.left = newWidth + 'px';
                        }
                        
                        sidebarWidth.value = newWidth; // Êõ¥Êñ∞ÂìçÂ∫îÂºèÂèòÈáè
                        sidebar.value.style.setProperty('width', newWidth + 'px', 'important');
                        
                        // ÂêåÊó∂Ë∞ÉÊï¥‰∏ªÂÜÖÂÆπÂå∫ÂüüÂÆΩÂ∫¶
                        const mainContent = document.querySelector('.main-container main');
                        if (mainContent) {
                            mainContent.style.setProperty('width', `calc(100% - ${newWidth}px)`, 'important');
                        } else {
                            const altMain = document.querySelector('main');
                            if (altMain) {
                                altMain.style.setProperty('width', `calc(100% - ${newWidth}px)`, 'important');
                            }
                        }
                    } else {
                        console.log('Width out of range:', newWidth);
                    }
                };

                const stopResize = () => {
                    isResizing = false;
                    document.body.classList.remove('resizing');
                    document.removeEventListener('mousemove', handleResize);
                    document.removeEventListener('mouseup', stopResize);

                    // ‰øùÂ≠òÂΩìÂâçÂÆΩÂ∫¶Âà∞localStorage
                    if (sidebar.value) {
                        localStorage.setItem('sidebarWidth', sidebar.value.offsetWidth);
                    }
                };

                // Â∫îÁî®ÂìçÂ∫îÂºè‰æßËæπÊ†èÂÆΩÂ∫¶
                const applyResponsiveWidth = () => {
                    if (!sidebar.value) return;

                    const windowWidth = window.innerWidth;
                    let sidebarWidthPx;

                    if (windowWidth <= 768) {
                        sidebarWidthPx = 200;
                    } else if (windowWidth <= 1200) {
                        sidebarWidthPx = 250;
                    } else {
                        // Â§ßÂ±èÂπïÊó∂‰ΩøÁî®‰øùÂ≠òÁöÑÂÆΩÂ∫¶ÊàñÈªòËÆ§ÂÆΩÂ∫¶
                        const savedWidth = localStorage.getItem('sidebarWidth');
                        if (savedWidth) {
                            const width = parseInt(savedWidth);
                            if (width >= 200 && width <= 500) {
                                sidebarWidthPx = width;
                            } else {
                                sidebarWidthPx = 256; // ÈªòËÆ§ w-64
                            }
                        } else {
                            sidebarWidthPx = 256; // ÈªòËÆ§ w-64
                        }
                    }

                    sidebarWidth.value = sidebarWidthPx; // Êõ¥Êñ∞ÂìçÂ∫îÂºèÂèòÈáè
                    sidebar.value.style.width = sidebarWidthPx + 'px';
                    
                    // Êõ¥Êñ∞ÊÇ¨ÊµÆÊåâÈíÆ‰ΩçÁΩÆ
                    updateFloatingButtonPosition(sidebarWidthPx);
                    
                    const mainContent = document.querySelector('main');
                    if (mainContent) {
                        mainContent.style.width = `calc(100% - ${sidebarWidthPx}px)`;
                    }
                };

                // Êñ∞Â¢ûÔºöËßÜÂõæÂàáÊç¢ÊñπÊ≥ï
                const switchToCreateView = () => {
                    currentView.value = 'create';
                    // Â¶ÇÊûú‰πãÂâçÊúâÂ±ïÂºÄËøáÂàõ‰ΩúÂå∫ÂüüÔºå‰øùÊåÅÂ±ïÂºÄÁä∂ÊÄÅ
                    if (isCreationAreaExpanded.value) {
                        // Âª∂Ëøü‰∏ÄÁÇπÊó∂Èó¥Á°Æ‰øùDOMÊõ¥Êñ∞ÂÆåÊàê
                        setTimeout(() => {
                            const creationArea = document.querySelector('.creation-area');
                            if (creationArea) {
                                creationArea.classList.add('show');
                            }
                        }, 50);
                    }
                };

                const switchToProjectsView = () => {
                    currentView.value = 'projects';
                    // Âà∑Êñ∞‰ªªÂä°ÂàóË°®
                    refreshTasks();
                };

                const switchToInspirationView = () => {
                    currentView.value = 'inspiration';
                    // Âä†ËΩΩÁÅµÊÑüÊï∞ÊçÆ
                    loadInspirationData();
                };

                // Êó•ÊúüÊ†ºÂºèÂåñÂáΩÊï∞
                const formatDate = (date) => {
                    if (!date) return '';
                    const d = new Date(date);
                    return d.toLocaleDateString('zh-CN', {
                        year: 'numeric',
                        month: '2-digit',
                        day: '2-digit'
                    });
                };

                // ÁÅµÊÑüÂπøÂú∫Áõ∏ÂÖ≥ÊñπÊ≥ï
                const loadInspirationData = async (forceRefresh = false) => {
                    try {
                        // Â¶ÇÊûú‰∏çÊòØÂº∫Âà∂Âà∑Êñ∞ÔºåÂÖàÂ∞ùËØï‰ªéÁºìÂ≠òÂä†ËΩΩ
                        // ÊûÑÂª∫ÁºìÂ≠òÈîÆÔºåÂåÖÂê´ÂàÜÈ°µÂíåËøáÊª§Êù°‰ª∂
                        const cacheKey = `${TEMPLATES_CACHE_KEY}_${inspirationCurrentPage.value}_${inspirationPageSize.value}_${selectedInspirationCategory.value}_${inspirationSearchQuery.value}`;
                        
                        if (!forceRefresh) {
                        const cachedData = loadFromCache(cacheKey, TEMPLATES_CACHE_EXPIRY);
                        if (cachedData && cachedData.templates) {
                            console.log(`ÊàêÂäü‰ªéÁºìÂ≠òÂä†ËΩΩÁÅµÊÑüÊ®°ÊùøÊï∞ÊçÆ${cacheKey}:`, cachedData.templates);
                            inspirationItems.value = cachedData.templates;
                                // Â¶ÇÊûúÊúâÂàÜÈ°µ‰ø°ÊÅØ‰πüÂä†ËΩΩ
                                if (cachedData.pagination) {
                                    inspirationPagination.value = cachedData.pagination;
                                }
                            preloadTemplateFilesUrl(inspirationItems.value);
                            return;
                            }
                        }

                        // ÁºìÂ≠ò‰∏≠Ê≤°ÊúâÊàñÂº∫Âà∂Âà∑Êñ∞Ôºå‰ªéAPIÂä†ËΩΩ
                        const response = await apiCall(`./api/v1/template/tasks?category=${selectedInspirationCategory.value}&search=${inspirationSearchQuery.value}&page=${inspirationCurrentPage.value}&page_size=${inspirationPageSize.value}`);
                        if (response.ok) {
                            const data = await response.json();
                            const templates = data.templates || [];
                            
                            inspirationItems.value = data.templates || [];
                            inspirationPagination.value = data.pagination || null;
                            
                            // ÁºìÂ≠òÊ®°ÊùøÊï∞ÊçÆ
                            saveToCache(cacheKey, {
                                templates: inspirationItems.value,
                                pagination: inspirationPagination.value,
                                category: selectedInspirationCategory.value,
                            });
                            
                            console.log('ÁºìÂ≠òÁÅµÊÑüÊ®°ÊùøÊï∞ÊçÆÊàêÂäü:', inspirationItems.value.length, '‰∏™Ê®°Êùø');
                            // Âº∫Âà∂Ëß¶ÂèëÂìçÂ∫îÂºèÊõ¥Êñ∞
                            await nextTick();
                            
                            // Âº∫Âà∂Âà∑Êñ∞ÂàÜÈ°µÁªÑ‰ª∂
                            inspirationPaginationKey.value++;
                            
                            // ‰ΩøÁî®Êñ∞ÁöÑÊ®°ÊùøÊñá‰ª∂È¢ÑÂä†ËΩΩÈÄªËæë
                            preloadTemplateFilesUrl(inspirationItems.value);
                        } else {
                            console.warn('Âä†ËΩΩÊ®°ÊùøÊï∞ÊçÆÂ§±Ë¥•');
                        }
                    } catch (error) {
                        console.warn('Âä†ËΩΩÊ®°ÊùøÊï∞ÊçÆÂ§±Ë¥•:', error);
                    }
                };
                // Á≠õÈÄâÁÅµÊÑüÂÜÖÂÆπ - Áé∞Âú®Êï∞ÊçÆÁõ¥Êé•‰ªéÂêéÁ´ØËé∑ÂèñÔºå‰∏çÈúÄË¶ÅÂâçÁ´ØÁ≠õÈÄâ
                const filteredInspirationItems = computed(() => {
                    // Áõ¥Êé•ËøîÂõû‰ªéÂêéÁ´ØËé∑ÂèñÁöÑÊï∞ÊçÆÔºåÂêéÁ´ØÂ∑≤ÁªèÊ†πÊçÆÂàÜÁ±ªÂíåÊêúÁ¥¢Êù°‰ª∂ËøõË°å‰∫ÜÁ≠õÈÄâ
                    return inspirationItems.value || [];
                });

                // ÈÄâÊã©ÂàÜÁ±ª
                const selectInspirationCategory = async (categoryId) => {
                    // Â¶ÇÊûúÁÇπÂáªÁöÑÊòØÂΩìÂâçÂàÜÁ±ªÔºå‰∏çÈáçÂ§çËØ∑Ê±Ç
                    if (selectedInspirationCategory.value === categoryId) {
                        return;
                    }
                    
                    // Êõ¥Êñ∞ÂàÜÁ±ª
                    selectedInspirationCategory.value = categoryId;
                    
                    // ÈáçÁΩÆÈ°µÁ†Å‰∏∫1
                    inspirationCurrentPage.value = 1;
                    inspirationPageInput.value = 1;
                    
                    // Ê∏ÖÁ©∫ÂΩìÂâçÊï∞ÊçÆÔºåÊòæÁ§∫Âä†ËΩΩÁä∂ÊÄÅ
                    inspirationItems.value = [];
                    inspirationPagination.value = null;
                    
                    // ÈáçÊñ∞Âä†ËΩΩÊï∞ÊçÆ
                    await loadInspirationData(); // Âº∫Âà∂Âà∑Êñ∞Ôºå‰∏ç‰ΩøÁî®ÁºìÂ≠ò
                };

                // ÊêúÁ¥¢Èò≤ÊäñÂÆöÊó∂Âô®
                let searchTimeout = null;

                // Â§ÑÁêÜÊêúÁ¥¢
                const handleInspirationSearch = async () => {
                    // Ê∏ÖÈô§‰πãÂâçÁöÑÂÆöÊó∂Âô®
                    if (searchTimeout) {
                        clearTimeout(searchTimeout);
                    }
                    
                    // ËÆæÁΩÆÈò≤ÊäñÂª∂Ëøü
                    searchTimeout = setTimeout(async () => {
                        // ÈáçÁΩÆÈ°µÁ†Å‰∏∫1
                        inspirationCurrentPage.value = 1;
                        inspirationPageInput.value = 1;
                        
                        // Ê∏ÖÁ©∫ÂΩìÂâçÊï∞ÊçÆÔºåÊòæÁ§∫Âä†ËΩΩÁä∂ÊÄÅ
                        inspirationItems.value = [];
                        inspirationPagination.value = null;
                        
                        // ÈáçÊñ∞Âä†ËΩΩÊï∞ÊçÆ
                        await loadInspirationData(); // Âº∫Âà∂Âà∑Êñ∞Ôºå‰∏ç‰ΩøÁî®ÁºìÂ≠ò
                    }, 500); // 500ms Èò≤ÊäñÂª∂Ëøü
                };

                // ËßÜÈ¢ëÊí≠ÊîæÊéßÂà∂
                const playVideo = (event) => {
                    const video = event.target;
                    if (video.readyState >= 2) { // HAVE_CURRENT_DATA
                        video.currentTime = 0; // ‰ªéÂ§¥ÂºÄÂßãÊí≠Êîæ
                        video.play().catch(e => {
                            console.log('ËßÜÈ¢ëÊí≠ÊîæÂ§±Ë¥•:', e);
                            // Â¶ÇÊûúËá™Âä®Êí≠ÊîæÂ§±Ë¥•ÔºåÂèØ‰ª•Â∞ùËØïÁî®Êà∑‰∫§‰∫íÂêéÊí≠Êîæ
                        });
                    } else {
                        // Â¶ÇÊûúËßÜÈ¢ëËøòÊ≤°Âä†ËΩΩÂÆåÊàêÔºåÁ≠âÂæÖÂä†ËΩΩÂÆåÊàêÂêéÂÜçÊí≠Êîæ
                        video.addEventListener('loadeddata', () => {
                            video.currentTime = 0;
                            video.play().catch(e => console.log('ËßÜÈ¢ëÊí≠ÊîæÂ§±Ë¥•:', e));
                        }, { once: true });
                    }
                };

                const pauseVideo = (event) => {
                    const video = event.target;
                    video.pause();
                    video.currentTime = 0; // ÈáçÁΩÆÂà∞ÂºÄÂ§¥
                };

                const onVideoLoaded = (event) => {
                    const video = event.target;
                    // ËßÜÈ¢ëÂä†ËΩΩÂÆåÊàêÔºåÂáÜÂ§áÊí≠Êîæ
                    console.log('ËßÜÈ¢ëÂä†ËΩΩÂÆåÊàê:', video.src);
                };

                const onVideoError = (event) => {
                    const video = event.target;
                    console.error('ËßÜÈ¢ëÂä†ËΩΩÂ§±Ë¥•:', video.src, event);
                    // ÂèØ‰ª•Âú®ËøôÈáåÊòæÁ§∫ÈîôËØØÁä∂ÊÄÅÊàñÂõûÈÄÄÂà∞ÂõæÁâá
                };

                // È¢ÑËßàÊ®°ÊùøËØ¶ÊÉÖ
                const previewTemplateDetail = (item) => {
                    selectedTemplate.value = item;
                    showTemplateDetailModal.value = true;
                };

                // ÂÖ≥Èó≠Ê®°ÊùøËØ¶ÊÉÖÂºπÁ™ó
                const closeTemplateDetailModal = () => {
                    showTemplateDetailModal.value = false;
                    selectedTemplate.value = null;
                };

                // ‰ΩøÁî®Ê®°Êùø
                const useTemplate = async (item) => {
                    if (!item) {
                        showAlert('Ê®°ÊùøÊï∞ÊçÆ‰∏çÂÆåÊï¥', 'danger');
                        return;
                    }
                    console.log('‰ΩøÁî®Ê®°Êùø:', item);

                    try {
                        // ÂÖàËÆæÁΩÆ‰ªªÂä°Á±ªÂûã
                        selectedTaskId.value = item.task_type;

                        // Ëé∑ÂèñÂΩìÂâçË°®Âçï
                        const currentForm = getCurrentForm();

                        // ËÆæÁΩÆË°®ÂçïÊï∞ÊçÆ
                        currentForm.prompt = item.params?.prompt || '';
                        currentForm.negative_prompt = item.params?.negative_prompt || '';
                        currentForm.seed = item.params?.seed || 42;
                        currentForm.model_cls = item.model_cls || '';
                        currentForm.stage = item.stage || 'single_stage';

                        // Â¶ÇÊûúÊúâËæìÂÖ•ÂõæÁâáÔºåÂÖàËÆæÁΩÆURLÔºåÂª∂ËøüÂä†ËΩΩÊñá‰ª∂
                        if (item.inputs && item.inputs.input_image) {
                            getTemplateFileUrl(item.inputs.input_image,'images')
                            imageUrl = getTemplateFileUrl(item.inputs.input_image,'images')
                            currentForm.imageUrl = imageUrl;
                            setCurrentImagePreview(imageUrl); // Áõ¥Êé•‰ΩøÁî®URL‰Ωú‰∏∫È¢ÑËßà
                            console.log('Ê®°ÊùøËæìÂÖ•ÂõæÁâá:', imageUrl);
                            
                            // ÂºÇÊ≠•Âä†ËΩΩÂõæÁâáÊñá‰ª∂Ôºà‰∏çÈòªÂ°ûUIÔºâ
                            setTimeout(async () => {
                                try {
                                    const imageResponse = await fetch(imageUrl);
                                    if (imageResponse.ok) {
                                        const blob = await imageResponse.blob();
                                        const filename = item.inputs.input_image;
                                        const file = new File([blob], filename, { type: blob.type });
                                        currentForm.imageFile = file;
                                        console.log('Ê®°ÊùøÂõæÁâáÊñá‰ª∂Â∑≤Âä†ËΩΩ');
                                    }
                                } catch (error) {
                                    console.warn('Failed to load template image file:', error);
                                }
                            }, 100);
                        }

                        // Â¶ÇÊûúÊúâËæìÂÖ•Èü≥È¢ëÔºåÂÖàËÆæÁΩÆURLÔºåÂª∂ËøüÂä†ËΩΩÊñá‰ª∂
                        if (item.inputs && item.inputs.input_audio) {
                            getTemplateFileUrl(item.inputs.input_audio,'audios')
                            audioUrl = getTemplateFileUrl(item.inputs.input_audio,'audios')
                            currentForm.audioUrl = audioUrl;
                            setCurrentAudioPreview(audioUrl); // Áõ¥Êé•‰ΩøÁî®URL‰Ωú‰∏∫È¢ÑËßà
                            console.log('Ê®°ÊùøËæìÂÖ•Èü≥È¢ë:', audioUrl);
                            
                            // ÂºÇÊ≠•Âä†ËΩΩÈü≥È¢ëÊñá‰ª∂Ôºà‰∏çÈòªÂ°ûUIÔºâ
                            setTimeout(async () => {
                                try {
                                    const audioResponse = await fetch(audioUrl);
                                    if (audioResponse.ok) {
                                        const blob = await audioResponse.blob();
                                        const filename = item.inputs.input_audio;
                                        
                                        // Ê†πÊçÆÊñá‰ª∂Êâ©Â±ïÂêçÁ°ÆÂÆöÊ≠£Á°ÆÁöÑMIMEÁ±ªÂûã
                                        let mimeType = blob.type;
                                        if (!mimeType || mimeType === 'application/octet-stream') {
                                            const ext = filename.toLowerCase().split('.').pop();
                                            const mimeTypes = {
                                                'mp3': 'audio/mpeg',
                                                'wav': 'audio/wav',
                                                'mp4': 'audio/mp4',
                                                'aac': 'audio/aac',
                                                'ogg': 'audio/ogg',
                                                'm4a': 'audio/mp4'
                                            };
                                            mimeType = mimeTypes[ext] || 'audio/mpeg';
                                        }
                                        
                                        const file = new File([blob], filename, { type: mimeType });
                                        currentForm.audioFile = file;
                                        console.log('Ê®°ÊùøÈü≥È¢ëÊñá‰ª∂Â∑≤Âä†ËΩΩ');
                                        // ‰ΩøÁî®FileReaderÁîüÊàêdata URLÔºå‰∏éÊ≠£Â∏∏‰∏ä‰º†‰øùÊåÅ‰∏ÄËá¥
                                        const reader = new FileReader();
                                        reader.onload = (e) => {
                                            setCurrentAudioPreview(e.target.result);
                                            console.log('Ê®°ÊùøÈü≥È¢ëÈ¢ÑËßàÂ∑≤ËÆæÁΩÆ:', e.target.result.substring(0, 50) + '...');
                                        };
                                        reader.readAsDataURL(file);
                                    }
                                } catch (error) {
                                    console.warn('Failed to load template audio file:', error);
                                }
                            }, 100);
                        }

                        // ÂÖ≥Èó≠Ê®°ÊùøËØ¶ÊÉÖÂºπÁ™ó
                        closeTemplateDetailModal();

                        // ÂàáÊç¢Âà∞ÂàõÂª∫ËßÜÂõæ
                        isCreationAreaExpanded.value=true;
                        switchToCreateView();

                        showAlert(`Â∑≤Â∫îÁî®Ê®°Êùø`, 'success');
                    } catch (error) {
                        console.error('Â∫îÁî®Ê®°ÊùøÂ§±Ë¥•:', error);
                        showAlert(`Â∫îÁî®Ê®°ÊùøÂ§±Ë¥•: ${error.message}`, 'danger');
                    }
                };

                // Âä†ËΩΩÊõ¥Â§öÁÅµÊÑü
                const loadMoreInspiration = () => {
                    showAlert('Âä†ËΩΩÊõ¥Â§öÁÅµÊÑüÂäüËÉΩÂºÄÂèë‰∏≠...', 'info');
                };

                // Êñ∞Â¢ûÔºö‰ªªÂä°ËØ¶ÊÉÖÂºπÁ™óÊñπÊ≥ï
                const openTaskDetailModal = (task) => {
                    modalTask.value = task;
                    showTaskDetailModal.value = true;
                    // Âä†ËΩΩ‰ªªÂä°ËØ¶ÊÉÖ
                    viewTaskDetail(task);
                };

                const closeTaskDetailModal = () => {
                    showTaskDetailModal.value = false;
                    modalTask.value = null;
                    selectedTask.value = null;
                };

                // ÊÅ¢Â§ç‰øùÂ≠òÁöÑ‰æßËæπÊ†èÂÆΩÂ∫¶
                onMounted(() => {
                    applyResponsiveWidth();

                    // ÁõëÂê¨Á™óÂè£Â§ßÂ∞èÂèòÂåñ
                    window.addEventListener('resize', applyResponsiveWidth);
                    
                    // Á°Æ‰øùÊÇ¨ÊµÆÊåâÈíÆÂàùÂßã‰ΩçÁΩÆÊ≠£Á°Æ
                    setTimeout(() => {
                        updateFloatingButtonPosition(sidebarWidth.value);
                    }, 100);
                });

                // ËØ≠Ë®ÄÂàáÊç¢ÂäüËÉΩ
                const switchLanguage = (langCode) => {
                    currentLanguage.value = langCode;
                    localStorage.setItem('preferredLanguage', langCode);

                    // Êõ¥Êñ∞È°µÈù¢Ê†áÈ¢ò
                    document.title = t('pageTitle');

                    // Êõ¥Êñ∞HTML langÂ±ûÊÄß
                    document.documentElement.lang = langCode === 'zh' ? 'zh-CN' : 'en';
                };

                // ÁÆÄÂçïËØ≠Ë®ÄÂàáÊç¢ÂäüËÉΩÔºà‰∏≠Ëã±ÊñáÂàáÊç¢Ôºâ
                const toggleLanguage = () => {
                    const newLang = currentLanguage.value === 'zh' ? 'en' : 'zh';
                    switchLanguage(newLang);
                };

                // ÂàùÂßãÂåñËØ≠Ë®ÄËÆæÁΩÆ
                const initLanguage = () => {
                    const savedLanguage = localStorage.getItem('preferredLanguage');
                    if (savedLanguage && ['zh', 'en'].includes(savedLanguage)) {
                        currentLanguage.value = savedLanguage;
                    } else {
                        // Ê†πÊçÆÊµèËßàÂô®ËØ≠Ë®ÄËá™Âä®ÈÄâÊã©
                        const browserLang = navigator.language || navigator.userLanguage;
                        if (browserLang.startsWith('zh')) {
                            currentLanguage.value = 'zh';
                        } else {
                            currentLanguage.value = 'en';
                        }
                    }

                    // Ê†áËÆ∞ËØ≠Ë®ÄÂ∑≤Âä†ËΩΩÂÆåÊàê
                    languageLoaded.value = true;

                    // Â∫îÁî®ËØ≠Ë®ÄËÆæÁΩÆ
                    document.title = t('pageTitle');
                    document.documentElement.lang = currentLanguage.value === 'zh' ? 'zh-CN' : 'en';
                };

                return {
                    // ËØ≠Ë®ÄÁõ∏ÂÖ≥
                    currentLanguage,
                    showLanguageMenu,
                    languageLoaded,
                    languageOptions,
                    translations,
                    t,
                    switchLanguage,
                    toggleLanguage,
                    initLanguage,
                    
                    // ‰ªªÂä°Á±ªÂûã‰∏ãÊãâËèúÂçï
                    showTaskTypeMenu,
                    showModelMenu,

                    isLoggedIn,
                    loading,
                    loginLoading,
                    initLoading,
                    downloadLoading,
                    loginWithGitHub,
                    submitting,
                    taskSearchQuery,
                    currentUser,
                    models,
                    tasks,
                    alert,
                    showErrorDetails,
                    showFailureDetails,
                    confirmDialog,
                    showConfirmDialog,
                    // Êñ∞Â¢ûÔºöËßÜÂõæÂàáÊç¢Áõ∏ÂÖ≥Áä∂ÊÄÅ
                    currentView,
                    showTaskDetailModal,
                    modalTask,
                    t2vForm,
                    i2vForm,
                    s2vForm,
                    getCurrentForm,
                    i2vImagePreview,
                    s2vImagePreview,
                    s2vAudioPreview,
                    getCurrentImagePreview,
                    getCurrentAudioPreview,
                    setCurrentImagePreview,
                    setCurrentAudioPreview,
                    updateUploadedContentStatus,
                    availableTaskTypes,
                    availableModelClasses,
                    currentTaskHints,
                    currentHintIndex,
                    startHintRotation,
                    stopHintRotation,
                    filteredTasks,
                    selectedTaskId,
                    selectedTask,
                    selectedTaskFiles,
                    loadingTaskFiles,
                    statusFilter,
                    pagination,
                    paginationInfo,
                    currentTaskPage,
                    taskPageSize,
                    taskPageInput,
                    paginationKey,
                    taskMenuVisible,
                    toggleTaskMenu,
                    closeAllTaskMenus,
                    handleClickOutside,
                    showAlert,
                    setLoading,
                    apiCall,
                    logout,
                    loadModels,
                    sidebarCollapsed,
                    sidebarWidth,
                    showExpandHint,
                    showGlow,
                    isDefaultStateHidden,
                    hideDefaultState,
                    showDefaultState,
                    isCreationAreaExpanded,
                    hasUploadedContent,
                    isContracting,
                    expandCreationArea,
                    contractCreationArea,
                    taskFileCache,
                    taskFileCacheLoaded,
                    templateFileCache,
                    templateFileCacheLoaded,
                    loadTaskFiles,
                    downloadFile,
                    viewFile,
                    handleImageUpload,
                    selectTask,
                    selectModel,
                    resetForm,
                    triggerImageUpload,
                    triggerAudioUpload,
                    removeImage,
                    removeAudio,
                    handleAudioUpload,
                    loadImageAudioTemplates,
                    selectImageTemplate,
                    selectAudioTemplate,
                    previewAudioTemplate,
                    getTemplateFile,
                    imageTemplates,
                    audioTemplates,
                    showImageTemplates,
                    showAudioTemplates,
                    mediaModalTab,
                    templatePagination,
                    templatePaginationInfo,
                    templateCurrentPage,
                    templatePageSize,
                    templatePageInput,
                    templatePaginationKey,
                    imageHistory,
                    audioHistory,
                    templateFileCache,
                    showTemplates,
                    showHistory,
                    showPromptModal,
                    promptModalTab,
                    submitTask,
                    fileToBase64,
                    formatTime,
                    refreshTasks,
                    goToPage,
                    jumpToPage,
                    getVisiblePages,
                    goToTemplatePage,
                    jumpToTemplatePage,
                    getVisibleTemplatePages,
                    goToInspirationPage,
                    jumpToInspirationPage,
                    getVisibleInspirationPages,
                    preloadTaskFilesUrl,
                    preloadTemplateFilesUrl,
                    loadTaskFilesFromCache,
                    saveTaskFilesToCache,
                    getTaskFileFromCache,
                    setTaskFileToCache,
                    getTaskFileUrl,
                    getTaskFileUrlSync,
                    getTemplateFileUrl,
                    getTemplateFileUrlAsync,
                    loadTemplateFilesFromCache,
                    saveTemplateFilesToCache,
                    getFirstImageKey,
                    loadFromCache,
                    saveToCache,
                    clearAllCache,
                    getStatusBadgeClass,
                    downloadSingleResult,
                    viewSingleResult,
                    cancelTask,
                    resumeTask,
                    deleteTask,
                    startPollingTask,
                    stopPollingTask,
                    viewTaskDetail,
                    reuseTask,
                    showTaskCreator,
                    toggleSidebar,
                    clearPrompt,
                    getTaskItemClass,
                    getStatusIndicatorClass,
                    getTaskTypeBtnClass,
                    getModelBtnClass,
                    getTaskTypeIcon,
                    getTaskTypeName,
                    getPromptPlaceholder,
                    getStatusTextClass,
                    getImagePreview,
                    getTaskInputUrl,
                    getTaskInputImage,
                    getTaskInputAudio,
                    getTaskImageUrl,
                    getTaskVideoUrl,
                    getHistoryImageUrl,
                    getUserAvatarUrl,
                    getCurrentImagePreviewUrl,
                    getCurrentAudioPreviewUrl,
                    handleThumbnailError,
                    handleImageError,
                    handleImageLoad,
                    handleAudioError,
                    handleAudioLoad,
                    downloadTaskInput,
                    getTaskStatusDisplay,
                    getTaskStatusColor,
                    getTaskStatusIcon,
                    getTaskDuration,
                    getRelativeTime,
                    getTaskHistory,
                    getActiveTasks,
                    getOverallProgress,
                    getProgressTitle,
                    getProgressInfo,
                    getSubtaskProgress,
                    getSubtaskStatusText,
                    formatEstimatedTime,
                    formatDuration,
                    getTaskFailureInfo,
                    searchTasks,
                    filterTasksByStatus,
                    filterTasksByType,
                    getAlertClass,
                    getAlertBorderClass,
                    getAlertTextClass,
                    getAlertIcon,
                    getAlertIconBgClass,
                    getPromptTemplates,
                    selectPromptTemplate,
                    promptHistory,
                    getPromptHistory,
                    addTaskToHistory,
                    getLocalTaskHistory,
                    selectPromptHistory,
                    clearPromptHistory,
                    getImageHistory,
                    getAudioHistory,
                    selectImageHistory,
                    selectAudioHistory,
                    previewAudioHistory,
                    clearImageHistory,
                    clearAudioHistory,
                    getAudioMimeType,
                    getAuthHeaders,
                    startResize,
                    sidebar,
                    switchToCreateView,
                    switchToProjectsView,
                    switchToInspirationView,
                    openTaskDetailModal,
                    closeTaskDetailModal,
                    // ÁÅµÊÑüÂπøÂú∫Áõ∏ÂÖ≥
                    inspirationSearchQuery,
                    selectedInspirationCategory,
                    inspirationItems,
                    dynamicInspirationCategories,
                    filteredInspirationItems,
                    loadInspirationData,
                    selectInspirationCategory,
                    handleInspirationSearch,
                    loadMoreInspiration,
                    inspirationPagination,
                    inspirationPaginationInfo,
                    inspirationCurrentPage,
                    inspirationPageSize,
                    inspirationPageInput,
                    inspirationPaginationKey,
                    // Â∑•ÂÖ∑ÂáΩÊï∞
                    formatDate,
                    // Ê®°ÊùøËØ¶ÊÉÖÂºπÁ™óÁõ∏ÂÖ≥
                    showTemplateDetailModal,
                    selectedTemplate,
                    previewTemplateDetail,
                    closeTemplateDetailModal,
                    useTemplate,
                    // ËßÜÈ¢ëÊí≠ÊîæÊéßÂà∂
                    playVideo,
                    pauseVideo,
                    onVideoLoaded,
                    onVideoError
                };
            }
        }).mount('#app');

    </script>
</body>

</html>